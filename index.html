<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Bike Manager v7.0</title>
  <meta name="description" content="Offline-first bike inventory manager with GitHub sync and analytics." />
  
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' https://cdn.jsdelivr.net;
    style-src 'self' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    connect-src 'self' https://api.github.com;
    img-src 'self' data: blob:;
    object-src 'none';
    frame-ancestors 'none';
  ">
  
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Bike Manager" />
  <meta name="theme-color" content="#071b2b" />
  <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192' fill='%2300D0FF'%3E%3Crect width='192' height='192' rx='32' fill='%23071b2b'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='central' text-anchor='middle' font-size='96' font-family='sans-serif' fill='white' font-weight='bold'%3EBM%3C/text%3E%3C/svg%3E" />
  <link rel="manifest" href="./manifest.json">
  
  <link rel="stylesheet" href="./assets/css/style.css">
  
  <!-- SVG Icon Definitions -->
  <svg width="0" height="0" style="position:absolute">
    <symbol id="icon-list" viewBox="0 0 24 24"><path fill="currentColor" d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></symbol>
    <symbol id="icon-chart" viewBox="0 0 24 24"><path fill="currentColor" d="M3 22v-9h4v9H3zm0-11V3h4v8H3zm6 11v-5h4v5H9zm0-7V3h4v12H9zm6 7v-9h4v9h-4zm0-11V3h4v8h-4z"/></symbol>
    <symbol id="icon-settings" viewBox="0 0 24 24"><path fill="currentColor" d="M19.4 12c0-.2.1-.4.1-.6c0-.2-.1-.4-.1-.6l1.7-1.3c.2-.1.2-.4 0-.6l-1.6-2.8c-.1-.2-.4-.3-.6-.2l-2 .8c-.4-.3-.8-.5-1.3-.7l-.3-2.1c0-.3-.2-.4-.5-.4h-3.2c-.3 0-.5.1-.5.4l-.3 2.1c-.5.2-.9.4-1.3.7l-2-.8c-.2-.1-.5 0-.6.2l-1.6 2.8c-.1.2-.1.5 0 .6l1.7 1.3c-.1.2-.1.4-.1.6c0 .2.1.4.1.6l-1.7 1.3c-.2.1-.2.4 0 .6l1.6 2.8c.1.2.4.3.6.2l2-.8c.4.3.8.5 1.3.7l.3 2.1c0 .3.2.4.5.4h3.2c.3 0 .5-.1.5-.4l.3-2.1c.5-.2.9-.4 1.3-.7l2 .8c.2.1.5 0 .6-.2l1.6-2.8c.1-.2.1-.5 0-.6l-1.7-1.3zm-7.4 2.5c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5z"/></symbol>
    <symbol id="icon-buy" viewBox="0 0 24 24"><path fill="currentColor" d="M11 9h2v8h-2V9zm-2 2h-2v6h2v-6zm8 0h-2v6h2v-6zm-4-4h-2V5h2v2zm7-3H4.01L4 21h16V4zm-2 15H6V6h12v13z"/></symbol>
    <symbol id="icon-close" viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41z"/></symbol>
    <symbol id="icon-search" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14z"/></symbol>
    <symbol id="icon-filter" viewBox="0 0 24 24"><path fill="currentColor" d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/></symbol>
    <symbol id="icon-save" viewBox="0 0 24 24"><path fill="currentColor" d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3s3 1.34 3 3s-1.34 3-3 3zm3-10H5V5h10v4z"/></symbol>
    <symbol id="icon-delete" viewBox="0 0 24 24"><path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></symbol>
    <symbol id="icon-sync" viewBox="0 0 24 24"><path fill="currentColor" d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6s-2.69 6-6 6s-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8s-3.58-8-8-8z"/></symbol>
    <symbol id="icon-download" viewBox="0 0 24 24"><path fill="currentColor" d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></symbol>
    <symbol id="icon-check" viewBox="0 0 24 24"><path fill="currentColor" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></symbol>
    <symbol id="icon-sort" viewBox="0 0 24 24"><path fill="currentColor" d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"/></symbol>
    <symbol id="icon-duplicate" viewBox="0 0 24 24"><path fill="currentColor" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></symbol>
    <symbol id="icon-share" viewBox="0 0 24 24"><path fill="currentColor" d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></symbol>
    <symbol id="icon-undo" viewBox="0 0 24 24"><path fill="currentColor" d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></symbol>
    <symbol id="icon-moon" viewBox="0 0 24 24"><path fill="currentColor" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></symbol>
    <symbol id="icon-sun" viewBox="0 0 24 24"><path fill="currentColor" d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/></symbol>
  </svg>
</head>
<body>

  <!-- App Loader -->
  <div class="app-loader" id="app-loader">
    <div class="spinner"></div>
    <h2 id="app-loader-title">Bike Manager</h2>
    <p class="text-secondary" id="app-loader-status">Loading application...</p>
  </div>

  <!-- Main App Container -->
  <div class="app-container" id="app-container">
    
    <!-- Bottom Navigation (Mobile) / Side Navigation (Desktop) -->
    <nav class="app-bottom-nav" id="app-nav" role="navigation" aria-label="Main navigation">
      <button class="nav-btn active" data-view="view-list" aria-label="Bikes list">
        <svg><use href="#icon-list"></use></svg>
        <span>Bikes</span>
      </button>
      <button class="nav-btn" data-view="view-stats" aria-label="Statistics and analytics">
        <svg><use href="#icon-chart"></use></svg>
        <span>Stats</span>
      </button>
      <button class="nav-btn" data-view="view-settings" aria-label="Settings">
        <svg><use href="#icon-settings"></use></svg>
        <span>Settings</span>
      </button>
    </nav>
    
    <div style="flex-grow: 1; display: flex; flex-direction: column;">
      
      <!-- App Header -->
      <header class="app-header">
        <h1 id="header-title">Bike Manager</h1>
        <div id="sync-status" class="sync-status" role="status" aria-live="polite">
          <div class="status-dot"></div>
          <span id="sync-status-text">Offline</span>
        </div>
        <button class="btn-icon btn-ghost" id="sync-now-btn" title="Sync Now" aria-label="Sync now">
          <svg><use href="#icon-sync"></use></svg>
        </button>
      </header>
      
      <main class="app-main" role="main">
        
        <!-- LIST VIEW -->
        <section id="view-list" class="view active">
          
          <!-- Quick Stats -->
          <div class="stats-grid mb-2">
            <div class="stat-card">
              <div class="stat-card-title">Total Profit (Sold)</div>
              <div class="stat-card-value"><span class="currency" id="currency-symbol-1">₹</span> <span id="stat-total-profit">0</span></div>
            </div>
            <div class="stat-card">
              <div class="stat-card-title">Unsold Investment</div>
              <div class="stat-card-value"><span class="currency" id="currency-symbol-2">₹</span> <span id="stat-unsold-value">0</span></div>
            </div>
            <div class="stat-card">
              <div class="stat-card-title">Sold</div>
              <div class="stat-card-value" id="stat-sold-count">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-card-title">Unsold</div>
              <div class="stat-card-value" id="stat-unsold-count">0</div>
            </div>
          </div>
          
          <!-- Search and Actions Bar -->
          <div class="filter-bar">
            <div class="search-wrapper">
              <input type="search" class="form-input" id="search-input" placeholder="Search plate or owner..." aria-label="Search bikes" />
              <button id="search-clear" class="btn-icon btn-ghost" title="Clear search" aria-label="Clear search">
                <svg><use href="#icon-close"></use></svg>
              </button>
              <div id="search-suggestions" class="search-suggestions hidden"></div>
            </div>
            
            <!-- Sort dropdown -->
            <div class="sort-dropdown">
              <button class="sort-btn" id="sort-btn" aria-label="Sort bikes" aria-haspopup="true">
                <svg width="20" height="20"><use href="#icon-sort"></use></svg>
                <span id="sort-label">Latest</span>
              </button>
              <div class="sort-menu" id="sort-menu" role="menu">
                <div class="sort-option active" data-sort="latest" role="menuitem">Latest First <svg width="16" height="16"><use href="#icon-check"></use></svg></div>
                <div class="sort-option" data-sort="oldest" role="menuitem">Oldest First</div>
                <div class="sort-option" data-sort="profit-high" role="menuitem">Highest Profit</div>
                <div class="sort-option" data-sort="profit-low" role="menuitem">Lowest Profit</div>
                <div class="sort-option" data-sort="plate" role="menuitem">Plate (A-Z)</div>
                <div class="sort-option" data-sort="owner" role="menuitem">Owner (A-Z)</div>
              </div>
            </div>
            
            <button class="btn btn-primary" id="buy-bike-desktop" style="display: none; margin-left: 8px;">
              <svg width="20" height="20"><use href="#icon-buy"></use></svg>
              <span>Buy Bike</span>
            </button>
          </div>
          
          <!-- Advanced Filters -->
          <div class="advanced-filters card hidden" id="advanced-filters">
            <div class="filter-group">
              <label for="filter-owner">Owner</label>
              <input type="text" class="form-input" id="filter-owner" placeholder="Filter by owner name..." />
            </div>
            <div class="filter-group">
              <label for="filter-profit-min">Min Profit</label>
              <input type="number" class="form-input" id="filter-profit-min" placeholder="0" step="0.01" />
            </div>
            <div class="filter-group">
              <label for="filter-profit-max">Max Profit</label>
              <input type="number" class="form-input" id="filter-profit-max" placeholder="0" step="0.01" />
            </div>
            <div class="filter-group">
              <label for="filter-date-from">From Date</label>
              <input type="date" class="form-input" id="filter-date-from" />
            </div>
            <div class="filter-group">
              <label for="filter-date-to">To Date</label>
              <input type="date" class="form-input" id="filter-date-to" />
            </div>
            <button class="btn btn-secondary btn-sm" id="apply-filters">Apply</button>
            <button class="btn btn-ghost btn-sm" id="clear-filters">Clear</button>
          </div>
          
          <!-- Status Filter Chips -->
          <div class="filter-chips">
            <button class="chip active" id="filter-all" data-filter="all">All</button>
            <button class="chip" id="filter-sold" data-filter="sold">Sold</button>
            <button class="chip" id="filter-unsold" data-filter="unsold">Unsold</button>
            <button class="chip" id="toggle-advanced-filters">
              <svg width="16" height="16"><use href="#icon-filter"></use></svg>
              <span>Advanced</span>
            </button>
          </div>

          <!-- Bike List -->
          <div class="bike-list" id="bike-list" role="list">
            <p id="bike-list-empty" class="text-secondary text-center mt-2">No bikes found. Try buying one!</p>
          </div>
          
          <!-- Pagination -->
          <div class="pagination hidden" id="pagination" role="navigation" aria-label="Pagination">
            <button id="prev-page" aria-label="Previous page">‹</button>
            <span id="page-info">Page 1 of 1</span>
            <button id="next-page" aria-label="Next page">›</button>
          </div>
          
        </section>
        
        <!-- STATS VIEW -->
        <section id="view-stats" class="view">
          <h2>Analytics Dashboard</h2>
          <p class="text-secondary mb-2">Live insights from your local data.</p>
          
          <!-- Date range filter for analytics -->
          <div class="card">
            <h3>Filters</h3>
            <div class="date-filter">
              <label for="stats-date-from">From:</label>
              <input type="date" id="stats-date-from" class="form-input" />
              <label for="stats-date-to">To:</label>
              <input type="date" id="stats-date-to" class="form-input" />
              <button class="btn btn-secondary btn-sm" id="apply-date-filter">Apply</button>
              <button class="btn btn-ghost btn-sm" id="reset-date-filter">Reset</button>
            </div>
          </div>
          
          <!-- Quick Insights -->
          <div class="card">
            <h3>Quick Insights</h3>
            <p id="auto-insight-text" class="text-secondary">Calculating insights...</p>
          </div>
          
          <!-- Monthly Profit Trend Chart -->
          <div class="chart-container card">
            <h3>
              <span>Monthly Profit & Moving Average</span>
              <div class="chart-controls">
                <button class="btn-icon btn-ghost" id="download-profit-chart" title="Download Chart" aria-label="Download profit chart as PNG">
                  <svg width="20" height="20"><use href="#icon-download"></use></svg>
                </button>
                <button class="btn-icon btn-ghost" id="export-profit-csv" title="Export Data" aria-label="Export profit data as CSV">
                  <svg width="20" height="20"><use href="#icon-save"></use></svg>
                </button>
              </div>
            </h3>
            <canvas id="chart-profit-trend" aria-label="Monthly profit trend chart"></canvas>
          </div>
          
          <!-- Profit Distribution Pie Chart -->
          <div class="chart-container card">
            <h3>
              <span>Profit Distribution (Sold Bikes)</span>
              <div class="chart-controls">
                <button class="btn-icon btn-ghost" id="download-pie-chart" title="Download Chart" aria-label="Download pie chart as PNG">
                  <svg width="20" height="20"><use href="#icon-download"></use></svg>
                </button>
              </div>
            </h3>
            <canvas id="chart-profit-pie" aria-label="Profit distribution pie chart"></canvas>
          </div>
          
          <!-- Top 5 Profitable Bikes -->
          <div class="chart-container card">
            <h3>
              <span>Top 5 Profitable Bikes (Sold)</span>
              <div class="chart-controls">
                <button class="btn-icon btn-ghost" id="download-top-chart" title="Download Chart" aria-label="Download top bikes chart as PNG">
                  <svg width="20" height="20"><use href="#icon-download"></use></svg>
                </button>
              </div>
            </h3>
            <canvas id="chart-top-bikes" aria-label="Top 5 profitable bikes bar chart"></canvas>
          </div>

          <!-- ROI and Performance Metrics -->
          <div class="card">
            <h3>Performance Metrics</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-card-title">Average ROI</div>
                <div class="stat-card-value" id="stat-avg-roi">0%</div>
              </div>
              <div class="stat-card">
                <div class="stat-card-title">Best Performer</div>
                <div class="stat-card-value text-success" id="stat-best-bike" style="font-size: 1.1rem;">-</div>
              </div>
              <div class="stat-card">
                <div class="stat-card-title">Worst Performer</div>
                <div class="stat-card-value text-error" id="stat-worst-bike" style="font-size: 1.1rem;">-</div>
              </div>
              <div class="stat-card">
                <div class="stat-card-title">Avg Days to Sell</div>
                <div class="stat-card-value" id="stat-avg-days">0</div>
              </div>
            </div>
          </div>

        </section>
        
        <!-- SETTINGS VIEW -->
        <section id="view-settings" class="view">
          <h2>Settings</h2>
          
          <!-- Theme Toggle -->
          <div class="settings-section">
            <h3>Appearance</h3>
            <div class="theme-toggle">
              <label for="theme-switch">Dark Mode</label>
              <div class="switch" id="theme-switch" role="switch" aria-checked="true" tabindex="0"></div>
            </div>
            <div class="form-group">
              <label for="list-density">List Density</label>
              <select class="form-select" id="list-density">
                <option value="comfortable">Comfortable</option>
                <option value="compact">Compact</option>
              </select>
            </div>
          </div>
          
          <!-- GitHub Gist Sync -->
          <div class="settings-section">
            <h3>GitHub Gist Sync</h3>
            <p>Syncs your data to a private GitHub Gist as a CSV backup. This is a manual sync, not real-time. Press "Sync Now" in the header to move data between devices.</p>
            
            <div class="form-group">
              <label for="setting-gist-id">Gist ID</label>
              <input type="text" class="form-input" id="setting-gist-id" placeholder="e.g., a1b2c3d4e5f6a7b8c9d0" />
            </div>
            <div class="form-group">
              <label for="setting-gist-filename">Gist Filename</label>
              <input type="text" class="form-input" id="setting-gist-filename" value="bikes_inventory.csv" />
            </div>
            <div class="form-group">
              <label for="setting-github-pat">GitHub Personal Access Token (PAT)</label>
              <input type="password" class="form-input" id="setting-github-pat" placeholder="ghp_... (stored in session)" autocomplete="password" />
              <p class="text-secondary" style="font-size: 0.8rem; margin-top: 6px;">
                Requires `gist` scope. Your browser will offer to save this token. It's stored <strong>only</strong> in sessionStorage (cleared when tab closes).
              </p>
            </div>
            <button class="btn btn-secondary" id="save-sync-settings">
              <svg width="20" height="20"><use href="#icon-save"></use></svg>
              <span>Save Sync Settings</span>
            </button>
          </div>
          
          <!-- Personalization -->
          <div class="settings-section">
            <h3>Personalization</h3>
            <div class="form-group">
              <label for="setting-business-name">Business Name</label>
              <input type="text" class="form-input" id="setting-business-name" placeholder="My Bike Shop" />
            </div>
            <div class="form-group">
              <label for="setting-currency">Currency Symbol</label>
              <input type="text" class="form-input" id="setting-currency" placeholder="₹" style="width: 100px;" />
            </div>
            <button class="btn btn-secondary" id="save-display-settings">Save Display Settings</button>
          </div>
          
          <!-- Data Management -->
          <div class="settings-section">
            <h3>Data Management</h3>
            <p>Manage your local and remote data.</p>
            <div class="form-grid" style="gap: 12px;">
              <button class="btn btn-secondary" id="export-csv">Export as CSV</button>
              <button class="btn btn-secondary" id="export-json">Export as JSON</button>
              <button class="btn btn-secondary" id="export-xlsx">Export as XLSX</button>
              <button class="btn btn-secondary" id="import-csv">Import CSV/JSON</button>
              <button class="btn btn-secondary" id="download-template">
                <svg width="18" height="18"><use href="#icon-download"></use></svg>
                <span>Download Template</span>
              </button>
              <button class="btn btn-secondary hidden" id="share-data">
                <svg width="18" height="18"><use href="#icon-share"></use></svg>
                <span>Share Data</span>
              </button>
            </div>
            <input type="file" id="import-file-input" class="hidden" accept=".csv,.json" />
            
            <h4 class="mt-2">Keyboard Shortcuts</h4>
            <p class="text-secondary">
              <span class="kbd">Ctrl</span> + <span class="kbd">N</span> New bike &nbsp;•&nbsp;
              <span class="kbd">Ctrl</span> + <span class="kbd">S</span> Save &nbsp;•&nbsp;
              <span class="kbd">Esc</span> Close modal &nbsp;•&nbsp;
              <span class="kbd">Ctrl</span> + <span class="kbd">Z</span> Undo
            </p>
            
            <h4 class="mt-2">Danger Zone</h4>
            <button class="btn btn-danger" id="wipe-data-btn">
              <svg width="20" height="20"><use href="#icon-delete"></use></svg>
              <span>Wipe All Local Data</span>
            </button>
          </div>

        </section>
        
      </main>
    </div>
  </div>

  <!-- FAB (Floating Action Button) -->
  <button class="fab" id="fab-buy" title="Buy New Bike" aria-label="Buy new bike">
    <svg><use href="#icon-buy"></use></svg>
  </button>
  
  <!-- Bulk Action Toolbar -->
  <div class="bulk-action-bar" id="bulk-action-bar" role="toolbar" aria-label="Bulk actions">
    <span class="count"><span id="selected-count">0</span> selected</span>
    <button class="btn btn-secondary btn-sm" id="bulk-mark-sold">Mark Sold</button>
    <button class="btn btn-secondary btn-sm" id="bulk-export">Export</button>
    <button class="btn btn-ghost btn-sm" id="bulk-deselect">Clear</button>
  </div>
  
  <!-- Form Modal (Buy/Sell/Edit) -->
  <div class="modal-overlay" id="form-modal" role="dialog" aria-labelledby="form-title" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="form-title">Buy New Bike</h2>
        <button class="btn-icon btn-ghost" id="close-form-modal" aria-label="Close">
          <svg><use href="#icon-close"></use></svg>
        </button>
      </div>
      <div class="modal-body">
        <form id="bike-form">
          <input type="hidden" id="form-bike-id" />
          
          <div id="form-section-buy">
            <h3 class="form-section-title">Purchase Details</h3>
            <div class="form-group">
              <label for="form-no">Bike Number (Plate) *</label>
              <input type="text" class="form-input" id="form-no" placeholder="GJ05AB1234" required aria-required="true" />
            </div>
            <div class="form-group">
              <label for="form-owner">Owner Name *</label>
              <input type="text" class="form-input" id="form-owner" required aria-required="true" />
            </div>
            <div class="form-grid">
              <div class="form-group">
                <label for="form-datePurchase">Purchase Date</label>
                <input type="date" class="form-input" id="form-datePurchase" />
              </div>
              <div class="form-group">
                <label for="form-purchasePrice">Purchase Price</label>
                <input type="number" class="form-input" id="form-purchasePrice" placeholder="0" step="0.01" />
              </div>
            </div>
            <div class="form-group">
              <label for="form-repairCost">Repair Cost</label>
              <input type="number" class="form-input" id="form-repairCost" placeholder="0" step="0.01" />
            </div>
          </div>
          
          <div id="form-section-sell" class="hidden">
            <div class="form-section-divider"></div>
            <h3 class="form-section-title">Selling Details</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="form-dateSelling">Selling Date</label>
                <input type="date" class="form-input" id="form-dateSelling" />
              </div>
              <div class="form-group">
                <label for="form-sellingPrice">Selling Price</label>
                <input type="number" class="form-input" id="form-sellingPrice" placeholder="0" step="0.01" />
              </div>
            </div>
            <div class="form-group">
              <label for="form-netProfit">Net Profit (Auto)</label>
              <input type="number" class="form-input" id="form-netProfit" readonly aria-readonly="true" />
            </div>
          </div>
          
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-danger" id="delete-bike-btn" style="margin-right: auto;">
          <svg width="20" height="20"><use href="#icon-delete"></use></svg>
          <span>Delete</span>
        </button>
        <button class="btn btn-secondary hidden" id="duplicate-bike-btn">
          <svg width="20" height="20"><use href="#icon-duplicate"></use></svg>
          <span>Duplicate</span>
        </button>
        <button class="btn btn-secondary" id="cancel-form-btn">Cancel</button>
        <button class="btn btn-primary" id="save-form-btn">
          <svg width="20" height="20"><use href="#icon-save"></use></svg>
          <span id="save-form-btn-text">Save Purchase</span>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Update Modal -->
  <div class="modal-overlay" id="update-modal" role="dialog" aria-labelledby="update-title" aria-modal="true">
    <div class="modal-content text-center">
      <h2 id="update-title">Update Available</h2>
      <p class="text-secondary mb-2">A new version of Bike Manager is ready. Refresh to get the latest features.</p>
      <button class="btn btn-primary" id="update-refresh-btn">Refresh Now</button>
    </div>
  </div>

  <!-- PAT Re-entry Modal -->
  <div class="modal-overlay" id="pat-modal" role="dialog" aria-labelledby="pat-title" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="pat-title">GitHub PAT Required</h2>
      </div>
      <div class="modal-body">
        <p class="text-secondary mb-2">Your GitHub Personal Access Token was cleared when you closed your last session. Please re-enter it to enable sync.</p>
        <div class="form-group">
          <label for="pat-reenter">GitHub PAT</label>
          <input type="password" class="form-input" id="pat-reenter" placeholder="ghp_..." autocomplete="password" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="pat-skip">Skip</button>
        <button class="btn btn-primary" id="pat-submit">Submit</button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container" role="region" aria-live="polite" aria-label="Notifications"></div>
  
  <!-- Confetti Canvas -->
  <canvas id="confetti-canvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9998;" aria-hidden="true"></canvas>

  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/dexie@4.0.1/dist/dexie.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  
  <!-- Application Modules -->
  <script type="module" src="./assets/js/db.js"></script>
  <script type="module" src="./assets/js/ui.js"></script>
  <script type="module" src="./assets/js/charts.js"></script>
  <script type="module" src="./assets/js/sync.js"></script>
  <script type="module" src="./assets/js/app.js"></script>
</body>
</html>

