<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="Content-Security-Policy" content="default-src 'self'; base-uri 'self'; form-action 'self'; object-src 'none'; frame-ancestors 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; media-src 'self' blob:; connect-src 'self'; font-src 'self' data:; worker-src 'self' blob:; manifest-src 'self'; child-src 'self'; upgrade-insecure-requests">
    <title>Bike Manager</title>
    <meta name="theme-color" content="#2563eb">
    <link rel="manifest" href="./manifest.webmanifest">
    <link rel="icon" href="./icons/icon-192.png" sizes="192x192" type="image/png">
    <link rel="apple-touch-icon" href="./icons/icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
      <style>
        @font-face {
            font-family: 'Inter';
            font-style: normal;
            font-weight: 100 900;
            font-display: swap;
            src: url('data:font/woff2;base64,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') format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122;
        }

        /*! tailwindcss v3.4.4 | MIT License | https://tailwindcss.com*/*,:after,:before{box-sizing:border-box;border:0 solid #e5e7eb}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:initial}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:initial;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:initial}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::backdrop,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.pointer-events-none{pointer-events:none}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0}.inset-x-0{left:0;right:0}.bottom-0{bottom:0}.bottom-24{bottom:6rem}.left-0{left:0}.left-1\/2{left:50%}.right-0{right:0}.top-0{top:0}.top-5{top:1.25rem}.z-10{z-index:10}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.z-\[100\]{z-index:100}.z-\[110\]{z-index:110}.z-\[60\]{z-index:60}.z-\[70\]{z-index:70}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mb-5{margin-bottom:1.25rem}.ml-2{margin-left:.5rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-16{height:4rem}.h-2{height:.5rem}.h-4{height:1rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-\[75dvh\]{height:75dvh}.h-full{height:100%}.max-h-40{max-height:10rem}.max-h-60{max-height:15rem}.min-h-screen{min-height:100vh}.\!w-auto{width:auto!important}.w-1\/3{width:33.333333%}.w-4{width:1rem}.w-7{width:1.75rem}.w-8{width:2rem}.w-full{width:100%}.max-w-2xl{max-width:42rem}.max-w-6xl{max-width:72rem}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.-translate-x-1\/2{--tw-translate-x:-50%}.-translate-x-1\/2,.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes spin{to{transform:rotate(1turn)}}.animate-spin{animation:spin 1s linear infinite}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem*var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem*var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.75rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem*var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem*var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.\!rounded-lg{border-radius:.5rem!important}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-xl{border-radius:.75rem}.rounded-t-2xl{border-top-left-radius:1rem;border-top-right-radius:1rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-none{border-style:none}.border-amber-200{--tw-border-opacity:1;border-color:rgb(253 230 138/var(--tw-border-opacity))}.border-amber-300{--tw-border-opacity:1;border-color:rgb(252 211 77/var(--tw-border-opacity))}.border-amber-500{--tw-border-opacity:1;border-color:rgb(245 158 11/var(--tw-border-opacity))}.border-blue-100{--tw-border-opacity:1;border-color:rgb(219 234 254/var(--tw-border-opacity))}.border-blue-200{--tw-border-opacity:1;border-color:rgb(191 219 254/var(--tw-border-opacity))}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246/var(--tw-border-opacity))}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity))}.\!bg-gray-200{--tw-bg-opacity:1!important;background-color:rgb(229 231 235/var(--tw-bg-opacity))!important}.bg-amber-100{--tw-bg-opacity:1;background-color:rgb(254 243 199/var(--tw-bg-opacity))}.bg-amber-100\/70{background-color:#fef3c7b3}.bg-amber-500{--tw-bg-opacity:1;background-color:rgb(245 158 11/var(--tw-bg-opacity))}.bg-black\/40{background-color:#0006}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254/var(--tw-bg-opacity))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255/var(--tw-bg-opacity))}.bg-blue-50\/60{background-color:#eff6ff99}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.bg-emerald-50{--tw-bg-opacity:1;background-color:rgb(236 253 245/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity))}.bg-green-50{--tw-bg-opacity:1;background-color:rgb(240 253 244/var(--tw-bg-opacity))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94/var(--tw-bg-opacity))}.bg-indigo-100{--tw-bg-opacity:1;background-color:rgb(224 231 255/var(--tw-bg-opacity))}.bg-orange-100{--tw-bg-opacity:1;background-color:rgb(255 237 213/var(--tw-bg-opacity))}.bg-orange-50{--tw-bg-opacity:1;background-color:rgb(255 247 237/var(--tw-bg-opacity))}.bg-purple-100{--tw-bg-opacity:1;background-color:rgb(243 232 255/var(--tw-bg-opacity))}.bg-purple-50{--tw-bg-opacity:1;background-color:rgb(250 245 255/var(--tw-bg-opacity))}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226/var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-white\/20{background-color:#fff3}.bg-white\/70{background-color:#ffffffb3}.bg-white\/90{background-color:#ffffffe6}.bg-yellow-100{--tw-bg-opacity:1;background-color:rgb(254 249 195/var(--tw-bg-opacity))}.\!p-2{padding:.5rem!important}.p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.\!px-2{padding-left:.5rem!important;padding-right:.5rem!important}.\!py-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0{padding-top:0;padding-bottom:0}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pb-28{padding-bottom:7rem}.pr-2{padding-right:.5rem}.pt-2{padding-top:.5rem}.pt-24{padding-top:6rem}.pt-3{padding-top:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.\!text-sm{font-size:.875rem!important;line-height:1.25rem!important}.text-2xl{font-size:1.5rem;line-height:2rem}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.tracking-wide{letter-spacing:.025em}.tracking-widest{letter-spacing:.1em}.text-amber-500{--tw-text-opacity:1;color:rgb(245 158 11/var(--tw-text-opacity))}.text-amber-600{--tw-text-opacity:1;color:rgb(217 119 6/var(--tw-text-opacity))}.text-amber-700{--tw-text-opacity:1;color:rgb(180 83 9/var(--tw-text-opacity))}.text-amber-800{--tw-text-opacity:1;color:rgb(146 64 14/var(--tw-text-opacity))}.text-amber-900{--tw-text-opacity:1;color:rgb(120 53 15/var(--tw-text-opacity))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246/var(--tw-text-opacity))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235/var(--tw-text-opacity))}.text-blue-700{--tw-text-opacity:1;color:rgb(29 78 216/var(--tw-text-opacity))}.text-blue-800{--tw-text-opacity:1;color:rgb(30 64 175/var(--tw-text-opacity))}.text-blue-900{--tw-text-opacity:1;color:rgb(30 58 138/var(--tw-text-opacity))}.text-emerald-600{--tw-text-opacity:1;color:rgb(5 150 105/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74/var(--tw-text-opacity))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61/var(--tw-text-opacity))}.text-green-900{--tw-text-opacity:1;color:rgb(20 83 45/var(--tw-text-opacity))}.text-indigo-700{--tw-text-opacity:1;color:rgb(67 56 202/var(--tw-text-opacity))}.text-orange-800{--tw-text-opacity:1;color:rgb(154 52 18/var(--tw-text-opacity))}.text-purple-600{--tw-text-opacity:1;color:rgb(147 51 234/var(--tw-text-opacity))}.text-purple-700{--tw-text-opacity:1;color:rgb(126 34 206/var(--tw-text-opacity))}.text-purple-800{--tw-text-opacity:1;color:rgb(107 33 168/var(--tw-text-opacity))}.text-purple-900{--tw-text-opacity:1;color:rgb(88 28 135/var(--tw-text-opacity))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68/var(--tw-text-opacity))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38/var(--tw-text-opacity))}.text-red-700{--tw-text-opacity:1;color:rgb(185 28 28/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-yellow-700{--tw-text-opacity:1;color:rgb(161 98 7/var(--tw-text-opacity))}.text-yellow-800{--tw-text-opacity:1;color:rgb(133 77 14/var(--tw-text-opacity))}.opacity-60{opacity:.6}.shadow-lg{--tw-shadow:0 10px 15px -3px #0000001a,0 4px 6px -4px #0000001a;--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.shadow-lg,.shadow-md{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px #0000001a,0 2px 4px -2px #0000001a;--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.shadow-sm{--tw-shadow:0 1px 2px 0 #0000000d;--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color)}.shadow-sm,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px #0000001a,0 8px 10px -6px #0000001a;--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.outline{outline-style:solid}.ring-2{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.ring-blue-400{--tw-ring-opacity:1;--tw-ring-color:rgb(96 165 250/var(--tw-ring-opacity))}.ring-offset-1{--tw-ring-offset-width:1px}.blur{--tw-blur:blur(8px)}.blur,.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-150,.transition{transition-duration:.15s}.last\:border-0:last-child{border-width:0}.last\:border-b-0:last-child{border-bottom-width:0}.hover\:bg-amber-100:hover{--tw-bg-opacity:1;background-color:rgb(254 243 199/var(--tw-bg-opacity))}.hover\:bg-amber-500\/90:hover{background-color:#f59e0be6}.hover\:bg-amber-600:hover{--tw-bg-opacity:1;background-color:rgb(217 119 6/var(--tw-bg-opacity))}.hover\:bg-blue-100:hover{--tw-bg-opacity:1;background-color:rgb(219 234 254/var(--tw-bg-opacity))}.hover\:bg-blue-50:hover{--tw-bg-opacity:1;background-color:rgb(239 246 255/var(--tw-bg-opacity))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.hover\:bg-emerald-100:hover{--tw-bg-opacity:1;background-color:rgb(209 250 229/var(--tw-bg-opacity))}.hover\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219/var(--tw-bg-opacity))}.hover\:bg-green-100:hover{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity))}.hover\:bg-green-600:hover{--tw-bg-opacity:1;background-color:rgb(22 163 74/var(--tw-bg-opacity))}.hover\:bg-red-200:hover{--tw-bg-opacity:1;background-color:rgb(254 202 202/var(--tw-bg-opacity))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38/var(--tw-bg-opacity))}.hover\:bg-white\/30:hover{background-color:#ffffff4d}.focus\:border-none:focus{border-style:none}.focus\:ring-0:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(var(--tw-ring-offset-width)) var(--tw-ring-color)}.focus\:ring-0:focus,.focus\:ring-2:focus{box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color)}.focus\:ring-amber-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(245 158 11/var(--tw-ring-opacity))}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246/var(--tw-ring-opacity))}@media (min-width:640px){.sm\:max-w-md{max-width:28rem}.sm\:max-w-xl{max-width:36rem}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\:flex-row{flex-direction:row}.sm\:px-4{padding-left:1rem;padding-right:1rem}.sm\:text-sm{font-size:.875rem;line-height:1.25rem}}@media (min-width:1024px){.lg\:flex{display:flex}.lg\:max-w-3xl{max-width:48rem}.lg\:max-w-lg{max-width:32rem}.lg\:items-center{align-items:center}.lg\:justify-center{justify-content:center}.lg\:rounded-3xl{border-radius:1.5rem}.lg\:p-6{padding:1.5rem}.lg\:px-8{padding-left:2rem;padding-right:2rem}.lg\:text-2xl{font-size:1.5rem;line-height:2rem}.lg\:text-sm{font-size:.875rem;line-height:1.25rem}}@media (min-width:1280px){.xl\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.xl\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}}

        /* Base styling */
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: none; /* Prevents "pull-to-refresh" on mobile */
        }
        
        /* iOS-style tap highlight color */
        [data-page], button, [data-action] {
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        /* Active bottom navigation icon color */
        .nav-item.active svg {
            color: #0d6efd; /* Use a distinct blue */
        }
        .nav-item.active span {
            color: #0d6efd;
        }

        /* iOS-style segmented control (filters) */
        .segmented-control {
            display: flex;
            background-color: #e9e9eb; /* Light gray background */
            border-radius: 9px;
            padding: 2px;
        }
        .segmented-control button {
            flex: 1;
            padding: 5px 10px;
            border: none;
            background-color: transparent;
            color: #555;
            font-size: 13px;
            font-weight: 500;
            border-radius: 7px;
            transition: all 0.2s ease-in-out;
        }
        .segmented-control button.active {
            background-color: #ffffff;
            color: #000;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* Custom scrollbar */
        .page-content::-webkit-scrollbar,
        #transaction-list::-webkit-scrollbar,
        #dashboard-reminders::-webkit-scrollbar {
            width: 4px;
        }
        .page-content::-webkit-scrollbar-thumb,
        #transaction-list::-webkit-scrollbar-thumb,
        #dashboard-reminders::-webkit-scrollbar-thumb {
            background: #ddd;
            border-radius: 4px;
        }
        .page-content::-webkit-scrollbar-track,
        #transaction-list::-webkit-scrollbar-track,
        #dashboard-reminders::-webkit-scrollbar-track {
            background: transparent;
        }

        /* Form input styling */
        .form-input {
            width: 100%;
            padding: 12px;
            background-color: #f3f4f6; /* bg-gray-100 */
            border-radius: 10px;
            border: 1px solid #f3f4f6;
            font-size: 16px;
            transition: all 0.2s ease;
        }
        .form-input:focus {
            outline: none;
            border-color: #3b82f6; /* focus:ring-blue-500 */
            background-color: #fff;
            box-shadow: 0 0 0 2px #bfdbfe; /* focus:ring-2 */
        }
        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280; /* text-gray-500 */
            margin-bottom: 6px;
            padding-left: 4px;
        }
        
        /* Modal animation */
        .modal-sheet {
            transition: transform 0.3s ease-out;
            transform: translateY(100%);
        }
        .modal-sheet.open {
            transform: translateY(0);
        }
        @media (min-width: 1024px) {
            .modal-sheet {
                position: static !important;
                transform: none !important;
                max-height: 90vh;
                margin: 0 auto;
            }
            .modal-sheet.open {
                transform: none !important;
            }
        }
        .modal-overlay {
            transition: opacity 0.3s ease-out;
            opacity: 0;
        }
        .modal-overlay.open {
            opacity: 1;
        }

        /* Hide number input arrows */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] {
            -moz-appearance: textfield;
            appearance: textfield;
        }

        /* Sensitive data masking */
        .sensitive-mask {
            filter: blur(6px);
            opacity: 0.5;
            pointer-events: none;
            user-select: none;
        }
        .sensitive-wrapper {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
        }
        .lock-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            border-radius: 9999px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            background: rgba(219, 234, 254, 0.6);
            color: #2563eb;
            font-size: 14px;
            transition: all 0.2s ease-in-out;
        }
        .lock-button:hover {
            background: rgba(37, 99, 235, 0.1);
        }
        .lock-button.locked {
            background: rgba(248, 113, 113, 0.15);
            border-color: rgba(248, 113, 113, 0.35);
            color: #dc2626;
        }
        .analytics-locked {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem 1rem;
            border-radius: 1rem;
            border: 1px dashed rgba(59, 130, 246, 0.4);
            background: rgba(219, 234, 254, 0.35);
            color: #1d4ed8;
            text-align: center;
            gap: 1.5rem;
        }

        /* Lucide icon sizing */
        .lucide {
            width: 1.5rem;
            height: 1.5rem;
            stroke-width: 1.8;
        }

        .highlight-pulse {
            position: relative;
            animation: highlightFade 2.5s ease-out;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3);
        }

        @keyframes highlightFade {
            0% {
                box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.45);
            }
            40% {
                box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3);
            }
            80% {
                box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.15);
            }
            100% {
                box-shadow: none;
            }
        }

        .pr-action-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 9999px;
            background: rgba(59, 130, 246, 0.08);
            color: #2563eb;
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .pr-action-button:hover {
            background: rgba(59, 130, 246, 0.18);
            transform: translateY(-1px);
        }

        .pr-bike-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.35rem 0.75rem;
            border-radius: 9999px;
            background: rgba(37, 99, 235, 0.08);
            color: #1d4ed8;
            font-size: 0.75rem;
            font-weight: 600;
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .pr-bike-chip:hover {
            background: rgba(37, 99, 235, 0.16);
            transform: translateY(-1px);
        }
          </style>
</head>

<body class="bg-gray-200">

    <!-- App Header (Dynamic Title) -->
    <header class="bg-white/90 backdrop-blur-sm border-b border-gray-200 fixed inset-x-0 top-0 z-30">
        <div class="max-w-6xl mx-auto px-4 lg:px-8 py-4 flex flex-wrap gap-3 justify-between items-center">
            <h1 id="page-title" class="text-xl lg:text-2xl font-bold text-gray-900">Dashboard</h1>
            <!-- Add Button (context-aware) -->
            <div class="flex items-center gap-3">
                <button id="pwa-install-button" class="px-3 py-2 rounded-lg bg-blue-500 text-white text-xs sm:text-sm font-semibold shadow-sm hover:bg-blue-600 transition hidden" type="button">
                    Install App
                </button>
                <button id="sensitive-toggle" class="lock-button locked" title="Unlock sensitive data" aria-pressed="false">
                    <i data-lucide="lock"></i>
                </button>
                <button id="add-button" class="text-blue-500 hidden" title="Add new item">
                    <i data-lucide="plus" class="w-7 h-7"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- 
      Main App Wrapper
      Simulates a mobile phone screen, centered on desktop.
    -->
    <div id="app-wrapper" class="w-full max-w-6xl mx-auto min-h-screen bg-gray-100 shadow-xl lg:rounded-3xl overflow-hidden hidden flex flex-col">

        <div class="flex-1 flex flex-col">
            <!-- 
              Content Area
              Pages will be swapped here.
            -->
            <main class="flex-1 overflow-y-auto page-content lg:px-8 pt-24 pb-28">
            
            <!-- Page: Dashboard (Home) -->
            <div id="page-dashboard" class="page p-4 lg:p-6 space-y-4">
                <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4">
                    <div class="bg-white rounded-2xl p-4 shadow-sm">
                        <span class="text-sm font-medium text-gray-500">Cash in Hand</span>
                        <div class="sensitive-wrapper mt-1">
                            <div id="dashboard-cash" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl p-4 shadow-sm">
                        <span class="text-sm font-medium text-gray-500">Total Revenue</span>
                        <div class="sensitive-wrapper mt-1">
                            <div id="dashboard-revenue" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl p-4 shadow-sm">
                        <span class="text-sm font-medium text-gray-500">Total Profit</span>
                        <div class="sensitive-wrapper mt-1">
                            <div id="dashboard-profit" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl p-4 shadow-sm">
                        <span class="text-sm font-medium text-gray-500">Brand New Earnings</span>
                        <div class="sensitive-wrapper mt-1">
                            <div id="dashboard-brand" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="bg-white rounded-2xl p-4 shadow-sm">
                        <span class="text-sm font-medium text-gray-500">Unsold Investment</span>
                        <div id="metric-investment" class="text-2xl font-bold text-gray-900 mt-1">0</div>
                    </div>
                    <div class="bg-white rounded-2xl p-4 shadow-sm">
                        <span class="text-sm font-medium text-gray-500">Inventory (S/U)</span>
                        <div id="metric-inventory" class="text-2xl font-bold text-gray-900 mt-1">0 / 0</div>
                    </div>
                </div>

                <!-- Payment Reminders -->
                <div class="bg-white rounded-2xl p-4 shadow-sm">
                    <h2 class="text-lg font-semibold mb-2">Next Payment Reminder</h2>
                    <div id="dashboard-reminders" class="max-h-40 overflow-y-auto space-y-3 pr-2">
                        <!-- Reminders injected here -->
                    </div>
                </div>

                <!-- Recent Unsold -->
                <div class="bg-white rounded-2xl p-4 shadow-sm">
                    <div class="flex justify-between items-center mb-2">
                        <h2 class="text-lg font-semibold">Unsold Bikes</h2>
                        <select id="dashboard-sort" class="form-input !p-2 !py-1 !text-sm !w-auto !rounded-lg !bg-gray-200 border-none focus:ring-0 focus:border-none">
                            <option value="recent">Recent</option>
                            <option value="high_price">High Price</option>
                            <option value="low_price">Low Price</option>
                        </select>
                    </div>
                    <div id="dashboard-recent-bikes" class="space-y-2">
                        <!-- Recent bikes injected here -->
                    </div>
                </div>
            </div>

            <!-- Page: Bikes -->
            <div id="page-bikes" class="page p-4 lg:p-6 space-y-4 hidden">
                <!-- Filters -->
                <div class="sticky top-0 bg-gray-100 py-2 space-y-3">
                    <input type="search" id="bike-search" placeholder="Search by name, plate, or owner..." class="form-input">
                    <div class="segmented-control" id="bike-type-toggle">
                        <button data-type="second_hand" class="active">Second Hand</button>
                        <button data-type="brand_new">Brand New</button>
                    </div>
                    <div class="segmented-control" id="bike-filter">
                        <button data-filter="all" class="active">All</button>
                        <button data-filter="unsold">Unsold</button>
                        <button data-filter="sold">Sold</button>
                    </div>
                    <!-- NEW: Sort Dropdown -->
                    <div class="relative">
                        <button id="bike-sort-trigger" class="flex items-center justify-between w-full px-4 py-2 text-sm text-gray-700 bg-white border border-gray-200 rounded-lg shadow-sm">
                            <span id="bike-sort-label" class="font-medium">Sort: Recent</span>
                            <i data-lucide="chevron-down" class="w-4 h-4 ml-2 text-gray-500"></i>
                        </button>
                        <div id="bike-sort-menu" class="absolute z-10 w-full mt-1 bg-white rounded-lg shadow-lg hidden">
                            <ul class="py-1 text-sm text-gray-700">
                                <li data-sort="dateDesc" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Recent</li>
                                <li data-sort="az" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">A-Z</li>
                                <li data-sort="za" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Z-A</li>
                                <li data-sort="purchaseHigh" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Purchase (High)</li>
                                <li data-sort="purchaseLow" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Purchase (Low)</li>
                                <li data-sort="saleHigh" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Sales (High)</li>
                                <li data-sort="saleLow" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Sales (Low)</li>
                                <li data-sort="profitHigh" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Profit (High)</li>
                                <li data-sort="profitLow" class="bike-sort-item px-4 py-2 hover:bg-gray-100 cursor-pointer">Profit (Low)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 items-center">
                        <button id="bike-advanced-toggle" class="px-3 py-2 text-xs font-semibold text-blue-600 bg-white border border-blue-200 rounded-lg hover:bg-blue-50 transition">
                            Show Advanced Filters
                        </button>
                        <button id="bike-advanced-reset" class="px-3 py-2 text-xs font-semibold text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 transition">
                            Reset Filters
                        </button>
                        <button id="bike-bulk-toggle" class="px-3 py-2 text-xs font-semibold text-amber-600 bg-amber-100/70 border border-amber-200 rounded-lg hover:bg-amber-100 transition">
                            Select for Clearance
                        </button>
                    </div>
                    <div id="bike-advanced-panel" class="hidden bg-white rounded-2xl p-4 shadow-sm space-y-3">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <div>
                                <label class="form-label" for="bike-filter-profit-min">Profit Range ()</label>
                                <div class="flex gap-2">
                                    <input type="number" id="bike-filter-profit-min" class="form-input" placeholder="Min">
                                    <input type="number" id="bike-filter-profit-max" class="form-input" placeholder="Max">
                                </div>
                            </div>
                            <div>
                                <label class="form-label" for="bike-filter-date-from">Purchase Date</label>
                                <div class="flex gap-2">
                                    <input type="date" id="bike-filter-date-from" class="form-input">
                                    <input type="date" id="bike-filter-date-to" class="form-input">
                                </div>
                            </div>
                            <div>
                                <label class="form-label" for="bike-filter-repair-min">Repair Cost ()</label>
                                <div class="flex gap-2">
                                    <input type="number" id="bike-filter-repair-min" class="form-input" placeholder="Min">
                                    <input type="number" id="bike-filter-repair-max" class="form-input" placeholder="Max">
                                </div>
                            </div>
                        </div>
                        <p class="text-xs text-gray-500">
                            Advanced filters apply to both sold and unsold bikes. Profit for unsold bikes uses the target or similar sale averages.
                        </p>
                    </div>
                </div>
                <!-- Bike List -->
                <div id="bike-list" class="space-y-3">
                    <!-- Bike card template -->
                </div>
                <div id="bike-clearance-footer" class="hidden fixed inset-x-0 bottom-24 z-30 px-4">
                    <div class="max-w-2xl mx-auto bg-white shadow-xl border border-amber-200 rounded-2xl p-4 space-y-3">
                        <div class="flex flex-wrap justify-between items-center gap-3 text-sm">
                            <span id="bike-clearance-count" class="font-semibold text-gray-800">0 bikes selected</span>
                            <button id="bike-clearance-cancel" class="px-3 py-1.5 rounded-lg bg-gray-100 text-gray-600 font-medium hover:bg-gray-200 transition">
                                Cancel
                            </button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-3">
                            <button id="bike-clearance-mark" class="flex-1 py-2 bg-amber-500 text-white rounded-lg font-semibold hover:bg-amber-600 transition">
                                Mark as Clearance
                            </button>
                            <button id="bike-clearance-remove" class="flex-1 py-2 bg-white border border-amber-300 text-amber-600 rounded-lg font-semibold hover:bg-amber-100 transition">
                                Remove Clearance
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Page: Credit -->
            <div id="page-credit" class="page p-4 lg:p-6 space-y-4 hidden">
                <div class="bg-white rounded-2xl p-4 shadow-sm space-y-4">
                    <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-3">
                        <div class="bg-blue-50 rounded-xl p-3">
                            <p class="text-xs text-blue-600 font-medium uppercase tracking-wide">Total Credit Given</p>
                            <p id="credit-total" class="text-xl font-bold text-blue-900 mt-1">0</p>
                        </div>
                        <div class="bg-green-50 rounded-xl p-3">
                            <p class="text-xs text-green-600 font-medium uppercase tracking-wide">Collected</p>
                            <p id="credit-collected" class="text-xl font-bold text-green-900 mt-1">0</p>
                        </div>
                        <div class="bg-orange-50 rounded-xl p-3">
                            <p class="text-xs text-amber-600 font-medium uppercase tracking-wide">Pending</p>
                            <p id="credit-pending" class="text-xl font-bold text-amber-900 mt-1">0</p>
                        </div>
                        <div class="bg-purple-50 rounded-xl p-3">
                            <p class="text-xs text-purple-600 font-medium uppercase tracking-wide">Active Customers</p>
                            <p id="credit-active" class="text-xl font-bold text-purple-900 mt-1">0</p>
                        </div>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-3">
                        <button id="credit-export" class="w-full py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">Export Credit Data</button>
                        <button id="credit-bulk-toggle" class="w-full py-3 bg-white border border-blue-200 text-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition">Start Bulk Collection</button>
                    </div>
                </div>
                <div id="credit-list" class="space-y-3">
                    <!-- Credit cards injected here -->
                </div>
                <div id="credit-bulk-footer" class="hidden fixed inset-x-0 bottom-24 z-30 px-4">
                    <div class="max-w-2xl mx-auto bg-blue-600 text-white rounded-2xl shadow-xl p-4 space-y-3">
                        <div class="flex justify-between items-center text-sm">
                            <span id="credit-bulk-count">0 customers selected</span>
                            <span id="credit-bulk-total" class="font-semibold">0</span>
                        </div>
                        <div class="flex gap-3">
                            <button id="credit-bulk-cancel" class="w-1/3 py-2 bg-white/20 rounded-lg font-semibold text-white hover:bg-white/30 transition">Cancel</button>
                            <button id="credit-bulk-confirm" class="flex-1 py-2 bg-white text-blue-600 rounded-lg font-semibold hover:bg-gray-100 transition">Record Payments</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Page: Analytics -->
            <div id="page-analytics" class="page p-4 lg:p-6 space-y-4 hidden">
                <div id="analytics-locked-state" class="hidden analytics-locked">
                    <div class="text-lg font-semibold">Sensitive analytics locked</div>
                    <p class="text-sm text-blue-700">Unlock with your PIN to review financial analytics.</p>
                    <button id="analytics-unlock" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">Unlock Analytics</button>
                </div>
                <div id="analytics-content" class="space-y-4">
                    <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4">
                        <div class="bg-white rounded-2xl p-4 shadow-sm">
                            <span class="text-sm font-medium text-gray-500">Cash in Hand</span>
                            <div class="sensitive-wrapper mt-1">
                                <div id="analytics-cash" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-4 shadow-sm">
                            <span class="text-sm font-medium text-gray-500">Total Profit</span>
                            <div class="sensitive-wrapper mt-1">
                                <div id="analytics-profit" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-4 shadow-sm">
                            <span class="text-sm font-medium text-gray-500">Realized Profit</span>
                            <div class="sensitive-wrapper mt-1">
                                <div id="analytics-realized" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-4 shadow-sm">
                            <span class="text-sm font-medium text-gray-500">This Month</span>
                            <div class="sensitive-wrapper mt-1">
                                <div id="analytics-month" class="text-2xl font-bold text-gray-900 sensitive-mask" data-sensitive="currency"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-4 shadow-sm">
                            <span class="text-sm font-medium text-gray-500">Total Cash Inflow</span>
                            <div class="sensitive-wrapper mt-1">
                                <div id="analytics-inflow" class="text-2xl font-bold text-green-600 sensitive-mask" data-sensitive="currency"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-4 shadow-sm">
                            <span class="text-sm font-medium text-gray-500">Total Cash Outflow</span>
                            <div class="sensitive-wrapper mt-1">
                                <div id="analytics-outflow" class="text-2xl font-bold text-red-600 sensitive-mask" data-sensitive="currency"></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl p-4 shadow-sm">
                        <h2 class="text-lg font-semibold mb-2">Cash Transaction Log</h2>
                        <div id="analytics-transaction-list" class="max-h-60 overflow-y-auto space-y-2 pr-2">
                            <!-- Transactions injected here -->
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl p-4 shadow-sm space-y-3">
                        <div class="flex justify-between items-center">
                            <h2 class="text-lg font-semibold">Expenses</h2>
                            <span id="analytics-expense-total" class="text-sm font-medium text-gray-500">0</span>
                        </div>
                        <div id="analytics-expense-list" class="space-y-2">
                            <!-- Expenses summary -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Page: Expenses -->
            <div id="page-expenses" class="page p-4 lg:p-6 space-y-3 hidden">
                <div id="expense-list" class="space-y-3">
                    <!-- Expense card template -->
                </div>
            </div>

            <!-- Page: PR (Personal Relationship) -->
            <div id="page-pr" class="page p-4 lg:p-6 space-y-4 hidden">
                <!-- Filters -->
                <div class="sticky top-0 bg-gray-100 py-2">
                    <input type="search" id="pr-search" placeholder="Search by name, contact, or bike..." class="form-input mb-2">
                    <div class="segmented-control flex-wrap gap-2" id="pr-filter">
                        <button data-filter="all" class="active">All</button>
                        <button data-filter="Buyer">Buyers</button>
                        <button data-filter="Owner">Owners</button>
                        <button data-filter="Supplier">Suppliers</button>
                    </div>
                </div>
                <!-- PR List -->
                <div id="pr-list" class="space-y-3">
                    <!-- PR card template -->
                </div>
            </div>

            <!-- Page: Settings -->
            <div id="page-settings" class="page p-4 lg:p-6 space-y-4">
                <!-- Cash Adjustments -->
                <div class="bg-white rounded-2xl p-4 shadow-sm">
                    <h2 class="text-lg font-semibold mb-2">Cash Adjustments</h2>
                    <div class="space-y-3">
                        <div>
                            <label class="form-label" for="cash-adj-amount">Amount *</label>
                            <input type="number" id="cash-adj-amount" placeholder="50000" class="form-input">
                        </div>
                        <div>
                            <label class="form-label" for="cash-adj-desc">Description *</label>
                            <input type="text" id="cash-adj-desc" placeholder="e.g., Initial Investment, Salary" class="form-input">
                        </div>
                        <div class="flex gap-3">
                            <button id="cash-adj-remove" class="w-full py-3 bg-red-500 text-white rounded-lg font-semibold transition hover:bg-red-600">
                                Remove Cash (-)
                            </button>
                            <button id="cash-adj-add" class="w-full py-3 bg-green-500 text-white rounded-lg font-semibold transition hover:bg-green-600">
                                Add Cash (+)
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Security Settings -->
                <div class="bg-white rounded-2xl p-4 shadow-sm space-y-3">
                    <h2 class="text-lg font-semibold">Security</h2>
                    <p id="pin-status" class="text-sm text-gray-600">
                        Sensitive data is currently <span class="font-medium">locked</span>.
                    </p>
                    <div class="space-y-3">
                        <div>
                            <label class="form-label" for="pin-current">Current PIN *</label>
                            <input type="password" id="pin-current" class="form-input" placeholder="Enter current PIN" maxlength="6" inputmode="numeric">
                        </div>
                        <div>
                            <label class="form-label" for="pin-new">New PIN *</label>
                            <input type="password" id="pin-new" class="form-input" placeholder="Choose 4-6 digit PIN" maxlength="6" inputmode="numeric">
                        </div>
                        <button id="pin-update" class="w-full py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                            Update PIN
                        </button>
                    </div>
                </div>
                
                <!-- NEW: Backup & Restore Section -->
                <div class="bg-white rounded-2xl p-4 shadow-sm space-y-3">
                    <h2 class="text-lg font-semibold">Backup & Restore</h2>
                    <button id="setting-backup" class="w-full text-left px-3 py-2 bg-blue-100 rounded-lg text-blue-700 font-medium">Backup Data</button>
                    <button id="setting-restore" class="w-full text-left px-3 py-2 bg-green-100 rounded-lg text-green-700 font-medium">Restore Data</button>
                    <input type="file" id="restore-file-input" accept=".json" class="hidden">
                    <p class="text-xs text-gray-500 text-center mt-1">
                        Current Mode: <span id="backup-mode-display" class="font-medium">Local</span>
                    </p>
                </div>
                
                <!-- Data Management -->
                <div class="bg-white rounded-2xl p-4 shadow-sm space-y-3">
                    <h2 class="text-lg font-semibold">Data Management</h2>
                    <button id="setting-logout" class="w-full text-left px-3 py-2 bg-gray-100 rounded-lg text-blue-600 font-medium">Log Out / Change Sync</button>
                    <button id="setting-reset" class="w-full text-left px-3 py-2 bg-red-100 rounded-lg text-red-600 font-medium">Reset All Data</button>
                </div>
            </div>

        </main>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed inset-x-0 bottom-0 bg-white/90 backdrop-blur-sm border-t border-gray-200 z-30">
        <div class="max-w-6xl mx-auto flex justify-around items-center h-16 px-2 sm:px-4">
            <button class="nav-item flex flex-col items-center justify-center text-gray-500 active" data-page="dashboard">
                <i data-lucide="layout-dashboard"></i>
                <span class="text-xs lg:text-sm font-medium">Home</span>
            </button>
            <button class="nav-item flex flex-col items-center justify-center text-gray-500" data-page="bikes">
                <i data-lucide="bike"></i>
                <span class="text-xs lg:text-sm font-medium">Bikes</span>
            </button>
            <button class="nav-item flex flex-col items-center justify-center text-gray-500" data-page="credit">
                <i data-lucide="wallet"></i>
                <span class="text-xs lg:text-sm font-medium">Credit</span>
            </button>
            <button class="nav-item flex flex-col items-center justify-center text-gray-500" data-page="analytics">
                <i data-lucide="line-chart"></i>
                <span class="text-xs lg:text-sm font-medium">Analytics</span>
            </button>
            <button class="nav-item flex flex-col items-center justify-center text-gray-500" data-page="expenses">
                <i data-lucide="receipt"></i>
                <span class="text-xs lg:text-sm font-medium">Expenses</span>
            </button>
            <button class="nav-item flex flex-col items-center justify-center text-gray-500" data-page="pr">
                <i data-lucide="users"></i>
                <span class="text-xs lg:text-sm font-medium">PR</span>
            </button>
            <button class="nav-item flex flex-col items-center justify-center text-gray-500" data-page="settings">
                <i data-lucide="settings"></i>
                <span class="text-xs lg:text-sm font-medium">Settings</span>
            </button>
        </div>
    </nav>

    <!-- 
      PAT Authentication Modal
    -->
    <div id="pat-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-100 p-4 hidden">
        <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-sm sm:max-w-md lg:max-w-lg">
            <h2 class="text-xl font-bold text-center mb-2">GitHub Access</h2>
            <p class="text-sm text-gray-600 text-center mb-4">
                Enter a GitHub PAT with <code class="text-xs bg-gray-200 px-1 py-0.5 rounded">gist</code> permissions to sync data.
            </p>
            <div class="space-y-3">
                <label for="pat-input" class="form-label">Personal Access Token</label>
                <input type="password" id="pat-input" class="form-input" placeholder="ghp_...">
                <button id="pat-save" class="w-full py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                    Connect & Load Data
                </button>
                <button id="pat-skip" class="w-full py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition">
                    Skip & Use Locally
                </button>
            </div>
            <p id="pat-error" class="text-red-500 text-sm text-center mt-3"></p>
        </div>
    </div>
    
    <!-- 
      Global Loading Overlay
    -->
    <div id="loader" class="fixed inset-0 z-[100] flex items-center justify-center bg-white/70 backdrop-blur-sm hidden">
        <i data-lucide="loader-2" class="animate-spin h-8 w-8 text-blue-500"></i>
    </div>
    
    <!-- 
      Global Confirmation Modal
    -->
    <div id="confirm-modal" class="fixed inset-0 z-[60] flex items-center justify-center p-4 hidden">
        <div class="modal-overlay fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
        <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-sm sm:max-w-md lg:max-w-lg z-10">
            <h2 id="confirm-title" class="text-lg font-semibold text-center mb-2">Are you sure?</h2>
            <p id="confirm-message" class="text-sm text-gray-600 text-center mb-5">This action cannot be undone.</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <button id="confirm-cancel" class="w-full py-3 bg-gray-200 text-gray-800 rounded-lg font-medium">Cancel</button>
                <button id="confirm-ok" class="w-full py-3 bg-red-500 text-white rounded-lg font-medium">Confirm</button>
            </div>
        </div>
    </div>
    
    <!-- 
      PIN Verification Modal
    -->
    <div id="pin-modal" class="fixed inset-0 z-[70] flex items-center justify-center p-4 hidden">
        <div class="modal-overlay fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
        <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-sm sm:max-w-md lg:max-w-lg z-10 space-y-4">
            <div class="space-y-1 text-center">
                <h2 class="text-xl font-bold text-gray-900">Unlock Sensitive Data</h2>
                <p class="text-sm text-gray-600" id="pin-modal-message">Enter your 4-digit PIN to continue.</p>
            </div>
            <div class="space-y-3">
                <input type="password" maxlength="6" inputmode="numeric" id="pin-input" class="form-input text-center tracking-widest text-lg" placeholder="">
                <p id="pin-error" class="text-xs text-red-500 text-center"></p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <button id="pin-cancel" class="w-full py-3 bg-gray-200 text-gray-800 rounded-lg font-medium">Cancel</button>
                <button id="pin-submit" class="w-full py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition">Unlock</button>
            </div>
        </div>
    </div>
    
    <!-- 
      Main Form Modal (Sheet style)
    -->
    <div id="form-modal" class="fixed inset-0 z-40 hidden lg:flex lg:items-center lg:justify-center">
        <!-- Overlay -->
        <div id="modal-overlay" class="modal-overlay fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
        
        <!-- Sheet Content -->
        <div id="modal-sheet" class="modal-sheet fixed bottom-0 left-0 right-0 max-w-md sm:max-w-xl lg:max-w-3xl mx-auto z-50 bg-gray-100 rounded-t-2xl shadow-t-lg lg:rounded-3xl">
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-4 border-b border-gray-200">
                <button id="modal-close" class="text-blue-500 font-medium">Cancel</button>
                <h2 id="modal-title" class="text-lg font-semibold">Modal Title</h2>
                <button id="modal-save" class="text-blue-500 font-bold">Save</button>
            </div>
            
            <!-- Modal Body (Dynamic) -->
            <div id="modal-body" class="p-4 h-[75dvh] overflow-y-auto space-y-4">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>

    <script type="module">
      const env = (() => {
        const APP_VERSION = '2025.11.11';
        const DB_NAME = 'bike-manager-vault';
        const DB_VERSION = 3;
        const KDF_ITERATIONS = 250000;
        const DEFAULT_AUTO_LOCK_MS = 2 * 60 * 1000;
        const MIN_AUTO_LOCK_MS = 30 * 1000;
        const MAX_AUTO_LOCK_MS = 10 * 60 * 1000;
        return {
          APP_VERSION,
          DB_NAME,
          DB_VERSION,
          KDF_ITERATIONS,
          DEFAULT_AUTO_LOCK_MS,
          MIN_AUTO_LOCK_MS,
          MAX_AUTO_LOCK_MS
        };
      })();

      const utils = (() => {
        const encoder = new TextEncoder();
        const decoder = new TextDecoder();
        const chunkSize = 0x8000;
        const toBase64 = (input) => {
          if (input instanceof ArrayBuffer) {
            input = new Uint8Array(input);
          }
          if (input instanceof Uint8Array) {
            let binary = '';
            for (let i = 0; i < input.length; i += chunkSize) {
              const chunk = input.subarray(i, i + chunkSize);
              binary += String.fromCharCode(...chunk);
            }
            return btoa(binary);
          }
          return btoa(String(input ?? ''));
        };
        const fromBase64 = (b64) => {
          if (!b64) return new Uint8Array();
          const binary = atob(b64);
          const bytes = new Uint8Array(binary.length);
          for (let i = 0; i < binary.length; i += 1) {
            bytes[i] = binary.charCodeAt(i);
          }
          return bytes;
        };
        const encodeUtf8 = (value) => encoder.encode(value ?? '');
        const decodeUtf8 = (buffer) => decoder.decode(buffer);
        const sleep = (ms = 0) => new Promise((resolve) => setTimeout(resolve, ms));
        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);
        const nowIso = () => new Date().toISOString();
        const safeJsonParse = (text, fallback = null) => {
          try {
            return JSON.parse(text);
          } catch {
            return fallback;
          }
        };
        const safeJsonStringify = (value) => {
          try {
            return JSON.stringify(value);
          } catch {
            return JSON.stringify(null);
          }
        };
        const randomId = () => (crypto.randomUUID ? crypto.randomUUID() : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) => (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)));
        const zeroBuffer = (buf) => {
          if (!buf) return;
          if (buf instanceof ArrayBuffer) {
            new Uint8Array(buf).fill(0);
          } else if (buf instanceof Uint8Array) {
            buf.fill(0);
          }
        };
        return {
          toBase64,
          fromBase64,
          encodeUtf8,
          decodeUtf8,
          sleep,
          clamp,
          nowIso,
          safeJsonParse,
          safeJsonStringify,
          randomId,
          zeroBuffer
        };
      })();

      const db = (() => {
        let database = null;

        const open = () => {
          if (database) return Promise.resolve(database);
          return new Promise((resolve, reject) => {
            const request = indexedDB.open(env.DB_NAME, env.DB_VERSION);
            request.onupgradeneeded = () => {
              const instance = request.result;
              if (!instance.objectStoreNames.contains('settings')) {
                instance.createObjectStore('settings', { keyPath: 'key' });
              }
              if (!instance.objectStoreNames.contains('auth')) {
                instance.createObjectStore('auth', { keyPath: 'key' });
              }
              if (!instance.objectStoreNames.contains('entries')) {
                instance.createObjectStore('entries', { keyPath: 'id' });
              }
              if (!instance.objectStoreNames.contains('images')) {
                instance.createObjectStore('images', { keyPath: 'id' });
              }
            };
            request.onsuccess = () => {
              database = request.result;
              database.onclose = () => {
                database = null;
              };
              resolve(database);
            };
            request.onerror = () => reject(request.error);
          });
        };

        const asPromise = (request) => new Promise((resolve, reject) => {
          request.onsuccess = () => resolve(request.result);
          request.onerror = () => reject(request.error);
        });

        const run = async (storeName, mode, executor) => {
          const instance = await open();
          return new Promise((resolve, reject) => {
            const transaction = instance.transaction(storeName, mode);
            const store = transaction.objectStore(storeName);
            let result;
            Promise.resolve()
              .then(() => executor(store, transaction))
              .then((value) => {
                result = value;
              })
              .catch((error) => {
                if (transaction.error) {
                  reject(transaction.error);
                } else {
                  transaction.abort();
                  reject(error);
                }
              });
            transaction.oncomplete = () => resolve(result);
            transaction.onabort = () => reject(transaction.error || new Error('Transaction aborted'));
            transaction.onerror = () => reject(transaction.error);
          });
        };

        const getSetting = (key) => run('settings', 'readonly', (store) => asPromise(store.get(key)).then((record) => record?.value));
        const setSetting = (key, value) => run('settings', 'readwrite', (store) => asPromise(store.put({ key, value })));
        const deleteSetting = (key) => run('settings', 'readwrite', (store) => asPromise(store.delete(key)));

        const getAuthRecord = () => run('auth', 'readonly', (store) => asPromise(store.get('primary')));
        const setAuthRecord = (record) => run('auth', 'readwrite', (store) => asPromise(store.put({ ...record, key: 'primary' })));

        const clearEntries = () => run('entries', 'readwrite', (store) => asPromise(store.clear()));
        const putEntry = (entry) => run('entries', 'readwrite', (store) => asPromise(store.put(entry)));
        const getEntries = () => run('entries', 'readonly', (store) => asPromise(store.getAll()).then((records) => records || []));
        const removeEntry = (id) => run('entries', 'readwrite', (store) => asPromise(store.delete(id)));

        const putImage = (blobRecord) => run('images', 'readwrite', (store) => asPromise(store.put(blobRecord)));
        const getImage = (id) => run('images', 'readonly', (store) => asPromise(store.get(id)));
        const deleteImage = (id) => run('images', 'readwrite', (store) => asPromise(store.delete(id)));
        const listImageIds = () => run('images', 'readonly', (store) => asPromise(store.getAllKeys()).then((keys) => keys || []));

        return {
          open,
          getSetting,
          setSetting,
          deleteSetting,
          getAuthRecord,
          setAuthRecord,
          clearEntries,
          putEntry,
          getEntries,
          removeEntry,
          putImage,
          getImage,
          deleteImage,
          listImageIds
        };
      })();

      const cryptoModule = (() => {
        const randomBytes = (length) => {
          const array = new Uint8Array(length);
          crypto.getRandomValues(array);
          return array;
        };

        const deriveKeyFromPin = async (pin, salt, iterations, extractable = false, usages = ['encrypt', 'decrypt']) => {
          const baseKey = await crypto.subtle.importKey('raw', utils.encodeUtf8(pin), 'PBKDF2', false, ['deriveKey']);
          return crypto.subtle.deriveKey(
            { name: 'PBKDF2', salt, iterations, hash: 'SHA-256' },
            baseKey,
            { name: 'AES-GCM', length: 256 },
            extractable,
            usages
          );
        };

        const deriveBitsFromPin = async (pin, salt, iterations, length = 256) => {
          const baseKey = await crypto.subtle.importKey('raw', utils.encodeUtf8(pin), 'PBKDF2', false, ['deriveBits']);
          const bits = await crypto.subtle.deriveBits(
            { name: 'PBKDF2', salt, iterations, hash: 'SHA-256' },
            baseKey,
            length
          );
          return new Uint8Array(bits);
        };

        const importMasterKey = (raw, usages = ['encrypt', 'decrypt']) => crypto.subtle.importKey('raw', raw, { name: 'AES-GCM' }, false, usages);

        const encrypt = async (plainBuffer, key, additionalData) => {
          const iv = randomBytes(12);
          const params = { name: 'AES-GCM', iv };
          if (additionalData) params.additionalData = additionalData;
          const ciphertext = await crypto.subtle.encrypt(params, key, plainBuffer instanceof Uint8Array ? plainBuffer.buffer : plainBuffer);
          return { iv, ciphertext: new Uint8Array(ciphertext) };
        };

        const decrypt = async (cipherBuffer, key, iv, additionalData) => {
          const params = { name: 'AES-GCM', iv };
          if (additionalData) params.additionalData = additionalData;
          const plain = await crypto.subtle.decrypt(params, key, cipherBuffer instanceof Uint8Array ? cipherBuffer.buffer : cipherBuffer);
          return new Uint8Array(plain);
        };

        const sha256 = async (buffer) => {
          const hash = await crypto.subtle.digest('SHA-256', buffer instanceof Uint8Array ? buffer.buffer : buffer);
          return new Uint8Array(hash);
        };

        const compress = async (text) => {
          if (typeof CompressionStream === 'undefined') {
            return { encoding: 'none', buffer: utils.encodeUtf8(text) };
          }
          const stream = new CompressionStream('gzip');
          const writer = stream.writable.getWriter();
          await writer.write(utils.encodeUtf8(text));
          await writer.close();
          const response = new Response(stream.readable);
          const arrayBuffer = await response.arrayBuffer();
          return { encoding: 'gzip', buffer: new Uint8Array(arrayBuffer) };
        };

        const decompress = async (buffer, encoding) => {
          if (!encoding || encoding === 'none') {
            return utils.decodeUtf8(buffer);
          }
          if (encoding === 'gzip' && typeof DecompressionStream !== 'undefined') {
            const stream = new DecompressionStream('gzip');
            const writer = stream.writable.getWriter();
            await writer.write(buffer);
            await writer.close();
            const response = new Response(stream.readable);
            const arrayBuffer = await response.arrayBuffer();
            return utils.decodeUtf8(arrayBuffer);
          }
          return utils.decodeUtf8(buffer);
        };

        return {
          randomBytes,
          deriveKeyFromPin,
          deriveBitsFromPin,
          importMasterKey,
          encrypt,
          decrypt,
          sha256,
          compress,
          decompress
        };
      })();

      const auth = (() => {
        const listeners = {
          lock: new Set(),
          unlock: new Set()
        };

        const state = {
          record: null,
          masterBytes: null,
          masterKey: null,
          sessionKey: null,
          unlockedAt: null,
          autoLockMs: env.DEFAULT_AUTO_LOCK_MS,
          autoLockTimer: null
        };

        const notify = (type) => listeners[type].forEach((handler) => {
          try {
            handler();
          } catch (error) {
            console.error(`[auth] ${type} listener failed`, error);
          }
        });

        const ensureRecordLoaded = async () => {
          if (state.record) return state.record;
          const record = await db.getAuthRecord();
          if (record?.settings?.autoLockMs) {
            state.autoLockMs = utils.clamp(record.settings.autoLockMs, env.MIN_AUTO_LOCK_MS, env.MAX_AUTO_LOCK_MS);
          }
          state.record = record || {
            key: 'primary',
            version: 1,
            pin: null,
            settings: {
              autoLockMs: state.autoLockMs,
              biometricEnabled: false
            },
            webauthn: {
              credentials: []
            }
          };
          return state.record;
        };

        const hasPin = async () => Boolean((await ensureRecordLoaded())?.pin?.wrappedKey);

        const clearSession = () => {
          if (state.masterBytes) {
            utils.zeroBuffer(state.masterBytes);
          }
          state.masterBytes = null;
          state.masterKey = null;
          state.sessionKey = null;
          state.unlockedAt = null;
          if (state.autoLockTimer) {
            clearTimeout(state.autoLockTimer);
            state.autoLockTimer = null;
          }
        };

        const lock = () => {
          if (!state.sessionKey && !state.masterBytes) return;
          clearSession();
          notify('lock');
        };

        const scheduleAutoLock = (ms) => {
          const duration = utils.clamp(ms ?? state.autoLockMs, env.MIN_AUTO_LOCK_MS, env.MAX_AUTO_LOCK_MS);
          if (state.autoLockTimer) {
            clearTimeout(state.autoLockTimer);
          }
          state.autoLockTimer = setTimeout(() => {
            lock();
          }, duration);
        };

        const refreshAutoLockTimer = () => {
          if (!state.sessionKey) return;
          scheduleAutoLock(state.autoLockMs);
        };

        const updateRecordSettings = async (updater) => {
          const record = await ensureRecordLoaded();
          record.settings = {
            ...(record.settings || {}),
            ...updater(record.settings || {})
          };
          await db.setAuthRecord(record);
        };

        const setAutoLockMs = async (ms) => {
          const normalized = utils.clamp(ms, env.MIN_AUTO_LOCK_MS, env.MAX_AUTO_LOCK_MS);
          state.autoLockMs = normalized;
          await updateRecordSettings(() => ({
            autoLockMs: normalized,
            biometricEnabled: state.record?.settings?.biometricEnabled ?? false
          }));
          if (state.sessionKey) {
            refreshAutoLockTimer();
          }
        };

        const getAutoLockMs = () => state.autoLockMs;

        const setPin = async (pin) => {
          const trimmed = String(pin || '').trim();
          if (!/^\d{4,12}$/.test(trimmed)) {
            throw new Error('PIN must be 4-12 digits.');
          }
          const record = await ensureRecordLoaded();
          let masterBytes = state.masterBytes;
          if (!masterBytes) {
            if (record?.pin?.wrappedKey) {
              throw new Error('Unlock with the current PIN before changing it.');
            }
            masterBytes = cryptoModule.randomBytes(32);
          } else {
            masterBytes = new Uint8Array(masterBytes);
          }

          const salt = cryptoModule.randomBytes(16);
          const pinKey = await cryptoModule.deriveKeyFromPin(trimmed, salt, env.KDF_ITERATIONS);
          const encrypted = await cryptoModule.encrypt(masterBytes, pinKey);
          const verifier = await cryptoModule.deriveBitsFromPin(trimmed, salt, env.KDF_ITERATIONS);
          const digest = await cryptoModule.sha256(masterBytes);

          record.pin = {
            salt: utils.toBase64(salt),
            iterations: env.KDF_ITERATIONS,
            wrappedKey: utils.toBase64(encrypted.ciphertext),
            iv: utils.toBase64(encrypted.iv),
            verifier: utils.toBase64(verifier),
            masterDigest: utils.toBase64(digest)
          };
          record.settings = {
            autoLockMs: state.autoLockMs,
            biometricEnabled: record?.settings?.biometricEnabled ?? false
          };
          record.version = 1;

          await db.setAuthRecord(record);
          state.record = record;
          state.masterBytes = masterBytes;
          state.masterKey = await cryptoModule.importMasterKey(masterBytes);
          state.sessionKey = state.masterKey;
          state.unlockedAt = Date.now();
          refreshAutoLockTimer();
          notify('unlock');
        };

        const unlockWithPin = async (pin) => {
          const trimmed = String(pin || '').trim();
          const record = await ensureRecordLoaded();
          if (!record?.pin?.wrappedKey) {
            throw new Error('No PIN is configured.');
          }
          const salt = utils.fromBase64(record.pin.salt);
          const iterations = record.pin.iterations || env.KDF_ITERATIONS;
          const wrapped = utils.fromBase64(record.pin.wrappedKey);
          const iv = utils.fromBase64(record.pin.iv);
          const verifierSource = record.pin.verifier ? utils.fromBase64(record.pin.verifier) : null;

          const pinKey = await cryptoModule.deriveKeyFromPin(trimmed, salt, iterations);
          if (verifierSource) {
            const verifierCandidate = await cryptoModule.deriveBitsFromPin(trimmed, salt, iterations);
            if (utils.toBase64(verifierCandidate) !== record.pin.verifier) {
              throw new Error('Incorrect PIN. Try again.');
            }
          }

          let masterBytes;
          try {
            masterBytes = await cryptoModule.decrypt(wrapped, pinKey, iv);
          } catch (error) {
            throw new Error('Incorrect PIN. Try again.');
          }

          if (record.pin.masterDigest) {
            const digest = await cryptoModule.sha256(masterBytes);
            if (utils.toBase64(digest) !== record.pin.masterDigest) {
              utils.zeroBuffer(masterBytes);
              throw new Error('Integrity check failed.');
            }
          }

          clearSession();
          state.masterBytes = masterBytes;
          state.masterKey = await cryptoModule.importMasterKey(masterBytes);
          state.sessionKey = state.masterKey;
          state.unlockedAt = Date.now();
          refreshAutoLockTimer();
          notify('unlock');
        };

        const getSessionKey = () => state.sessionKey;
        const isUnlocked = () => Boolean(state.sessionKey);

        const addListener = (type, handler) => {
          if (!listeners[type]) return () => {};
          listeners[type].add(handler);
          return () => listeners[type].delete(handler);
        };

        const removeListener = (type, handler) => {
          if (!listeners[type]) return;
          listeners[type].delete(handler);
        };

        const getRecordSnapshot = () => (state.record ? JSON.parse(JSON.stringify(state.record)) : null);

        const setBiometricEnabled = async (enabled) => {
          const record = await ensureRecordLoaded();
          record.settings = {
            autoLockMs: state.autoLockMs,
            biometricEnabled: Boolean(enabled)
          };
          await db.setAuthRecord(record);
          state.record = record;
        };

        const isBiometricEnabled = () => Boolean(state.record?.settings?.biometricEnabled);

        const init = async () => {
          await ensureRecordLoaded();
          state.autoLockMs = utils.clamp(state.record?.settings?.autoLockMs ?? env.DEFAULT_AUTO_LOCK_MS, env.MIN_AUTO_LOCK_MS, env.MAX_AUTO_LOCK_MS);
          return state.record;
        };

        return {
          init,
          hasPin,
          setPin,
          unlockWithPin,
          lock,
          isUnlocked,
          getSessionKey,
          refreshAutoLockTimer,
          scheduleAutoLock,
          setAutoLockMs,
          getAutoLockMs,
          addListener,
          removeListener,
          getRecordSnapshot,
          setBiometricEnabled,
          isBiometricEnabled
        };
      })();

      const vault = (() => {
        const STATE_KEY = 'app-state';
        const META_KEY = 'app-meta';

        const ensureUnlockedKey = () => {
          const key = auth.getSessionKey();
          if (!key) throw new Error('Vault requires unlocked session key.');
          return key;
        };

        const load = async () => {
          const encrypted = await db.getSetting(STATE_KEY);
          if (!encrypted) {
            return null;
          }
          const key = ensureUnlockedKey();
          const ciphertext = utils.fromBase64(encrypted.ciphertext);
          const iv = utils.fromBase64(encrypted.iv);
          const plainBuffer = await cryptoModule.decrypt(ciphertext, key, iv);
          const payload = await cryptoModule.decompress(plainBuffer, encrypted.encoding || 'none');
          const parsed = utils.safeJsonParse(payload, null);
          if (!parsed || typeof parsed !== 'object') {
            throw new Error('Decrypted vault payload is invalid.');
          }
          return parsed;
        };

        const save = async (payload) => {
          const key = ensureUnlockedKey();
          const json = utils.safeJsonStringify(payload);
          const compressed = await cryptoModule.compress(json);
          const encrypted = await cryptoModule.encrypt(compressed.buffer, key);
          const checksum = await cryptoModule.sha256(compressed.buffer);
          const record = {
            version: 1,
            iv: utils.toBase64(encrypted.iv),
            ciphertext: utils.toBase64(encrypted.ciphertext),
            encoding: compressed.encoding,
            checksum: utils.toBase64(checksum),
            savedAt: utils.nowIso()
          };
          await db.setSetting(STATE_KEY, record);
          await db.setSetting(META_KEY, {
            savedAt: record.savedAt,
            version: env.APP_VERSION
          });
          return record.savedAt;
        };

        const getMeta = async () => (await db.getSetting(META_KEY)) || null;

        const clear = async () => {
          await db.deleteSetting(STATE_KEY);
          await db.deleteSetting(META_KEY);
          await db.clearEntries();
          const imageIds = await db.listImageIds();
          await Promise.all(imageIds.map((id) => db.deleteImage(id)));
        };

        return {
          load,
          save,
          getMeta,
          clear
        };
      })();

      const icons = (() => {
        const baseAttrs = {
          xmlns: 'http://www.w3.org/2000/svg',
          width: '24',
          height: '24',
          viewBox: '0 0 24 24',
          fill: 'none',
          stroke: 'currentColor',
          'stroke-width': '2',
          'stroke-linecap': 'round',
          'stroke-linejoin': 'round'
        };

        const shapes = {
          lock: [
            ['rect', { width: '18', height: '11', x: '3', y: '11', rx: '2', ry: '2' }],
            ['path', { d: 'M7 11V7a5 5 0 0 1 10 0v4' }]
          ],
          unlock: [
            ['rect', { width: '18', height: '11', x: '3', y: '11', rx: '2', ry: '2' }],
            ['path', { d: 'M7 11V7a5 5 0 0 1 9.9-1' }]
          ],
          plus: [
            ['path', { d: 'M5 12h14' }],
            ['path', { d: 'M12 5v14' }]
          ],
          'chevron-down': [
            ['path', { d: 'm6 9 6 6 6-6' }]
          ],
          bike: [
            ['circle', { cx: '18.5', cy: '17.5', r: '3.5' }],
            ['circle', { cx: '5.5', cy: '17.5', r: '3.5' }],
            ['circle', { cx: '15', cy: '5', r: '1' }],
            ['path', { d: 'M12 17.5V14l-3-3 4-3 2 3h2' }]
          ],
          wallet: [
            ['path', { d: 'M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1' }],
            ['path', { d: 'M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4' }]
          ],
          'line-chart': [
            ['path', { d: 'M3 3v16a2 2 0 0 0 2 2h16' }],
            ['path', { d: 'm19 9-5 5-4-4-3 3' }]
          ],
          receipt: [
            ['path', { d: 'M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z' }],
            ['path', { d: 'M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8' }],
            ['path', { d: 'M12 17.5v-11' }]
          ],
          users: [
            ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2' }],
            ['circle', { cx: '9', cy: '7', r: '4' }],
            ['path', { d: 'M22 21v-2a4 4 0 0 0-3-3.87' }],
            ['path', { d: 'M16 3.13a4 4 0 0 1 0 7.75' }]
          ],
          settings: [
            ['path', { d: 'M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z' }],
            ['circle', { cx: '12', cy: '12', r: '3' }]
          ],
          'loader-2': [
            ['path', { d: 'M21 12a9 9 0 1 1-6.219-8.56' }]
          ],
          navigation: [
            ['polygon', { points: '3 11 22 2 13 21 11 13 3 11' }]
          ],
          phone: [
            ['path', { d: 'M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z' }]
          ],
          'message-circle': [
            ['path', { d: 'M7.9 20A9 9 0 1 0 4 16.1L2 22Z' }]
          ],
          copy: [
            ['rect', { width: '14', height: '14', x: '8', y: '8', rx: '2', ry: '2' }],
            ['path', { d: 'M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2' }]
          ],
          filter: [
            ['polygon', { points: '22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3' }]
          ],
          target: [
            ['circle', { cx: '12', cy: '12', r: '10' }],
            ['circle', { cx: '12', cy: '12', r: '6' }],
            ['circle', { cx: '12', cy: '12', r: '2' }]
          ],
          'layout-dashboard': [
            ['rect', { width: '7', height: '9', x: '3', y: '3', rx: '1' }],
            ['rect', { width: '7', height: '5', x: '14', y: '3', rx: '1' }],
            ['rect', { width: '7', height: '9', x: '14', y: '12', rx: '1' }],
            ['rect', { width: '7', height: '5', x: '3', y: '16', rx: '1' }]
          ]
        };

        const setAttributes = (element, attrs) => {
          Object.entries(attrs).forEach(([key, value]) => {
            element.setAttribute(key, value);
          });
        };

        const renderOne = (placeholder, name) => {
          if (!placeholder) return;
          const normalized = String(name || '').trim().toLowerCase();
          const definition = shapes[normalized];
          if (!definition) return;
          const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
          setAttributes(svg, baseAttrs);
          if (placeholder.getAttribute('class')) {
            svg.setAttribute('class', placeholder.getAttribute('class'));
          }
          if (placeholder.getAttribute('aria-hidden')) {
            svg.setAttribute('aria-hidden', placeholder.getAttribute('aria-hidden'));
          }
          const sizeOverride = placeholder.getAttribute('data-size');
          if (sizeOverride) {
            svg.setAttribute('width', sizeOverride);
            svg.setAttribute('height', sizeOverride);
          }
          definition.forEach(([tag, attrs]) => {
            const child = document.createElementNS('http://www.w3.org/2000/svg', tag);
            setAttributes(child, attrs);
            svg.appendChild(child);
          });
          placeholder.replaceWith(svg);
        };

        const renderAll = (root = document) => {
          root.querySelectorAll('[data-lucide]').forEach((el) => renderOne(el, el.getAttribute('data-lucide')));
        };

        return {
          renderAll,
          renderOne
        };
      })();

      const DEFAULT_DATA = {
        bikes: [],
        expenses: [],
        pr: [],
        cashEntries: [],
        payments: [],
        brandNewDeliveries: [],
        settings: {
          theme: 'system',
          autoLockMs: env.DEFAULT_AUTO_LOCK_MS,
          biometricEnabled: false,
          lastBackupAt: null
        }
      };
        // --- DOM Elements ---
        const $ = (selector) => document.querySelector(selector);
        
        // App containers
        const appWrapper = $('#app-wrapper');
        const patModal = $('#pat-modal');
        const loader = $('#loader');
        const formModal = $('#form-modal');
        const modalOverlay = $('#modal-overlay');
        const modalSheet = $('#modal-sheet');
        const confirmModal = $('#confirm-modal');
        
        // Navigation
        const navBar = $('nav');
        const pageTitle = $('#page-title');
        const addButton = $('#add-button');
        const pwaInstallButton = $('#pwa-install-button');
        const sensitiveToggle = $('#sensitive-toggle');
        
        // Pages
        const pages = document.querySelectorAll('.page');
        
        // Dashboard Page
        const metricInvestment = $('#metric-investment');
        const metricInventory = $('#metric-inventory');
        const dashboardRecentBikes = $('#dashboard-recent-bikes');
        const dashboardReminders = $('#dashboard-reminders');
        const dashboardSort = $('#dashboard-sort');
        const dashboardCash = $('#dashboard-cash');
        const dashboardRevenue = $('#dashboard-revenue');
        const dashboardProfit = $('#dashboard-profit');
        const dashboardBrand = $('#dashboard-brand');
        
        // Bikes Page
        const bikeList = $('#bike-list');
        const bikeFilter = $('#bike-filter');
        const bikeSearch = $('#bike-search');
        const bikeTypeToggle = $('#bike-type-toggle');
        const bikeSortTrigger = $('#bike-sort-trigger');
        const bikeSortMenu = $('#bike-sort-menu');
        const bikeSortLabel = $('#bike-sort-label');
        const bikeAdvancedToggle = $('#bike-advanced-toggle');
        const bikeAdvancedReset = $('#bike-advanced-reset');
        const bikeAdvancedPanel = $('#bike-advanced-panel');
        const bikeFilterProfitMin = $('#bike-filter-profit-min');
        const bikeFilterProfitMax = $('#bike-filter-profit-max');
        const bikeFilterDateFrom = $('#bike-filter-date-from');
        const bikeFilterDateTo = $('#bike-filter-date-to');
        const bikeFilterRepairMin = $('#bike-filter-repair-min');
        const bikeFilterRepairMax = $('#bike-filter-repair-max');
        const bikeBulkToggle = $('#bike-bulk-toggle');
        const bikeClearanceFooter = $('#bike-clearance-footer');
        const bikeClearanceCount = $('#bike-clearance-count');
        const bikeClearanceCancel = $('#bike-clearance-cancel');
        const bikeClearanceMark = $('#bike-clearance-mark');
        const bikeClearanceRemove = $('#bike-clearance-remove');

        // Credit Page
        const creditList = $('#credit-list');
        const creditTotal = $('#credit-total');
        const creditCollected = $('#credit-collected');
        const creditPending = $('#credit-pending');
        const creditActive = $('#credit-active');
        const creditExport = $('#credit-export');
        const creditBulkToggle = $('#credit-bulk-toggle');
        const creditBulkFooter = $('#credit-bulk-footer');
        const creditBulkCount = $('#credit-bulk-count');
        const creditBulkTotal = $('#credit-bulk-total');
        const creditBulkConfirm = $('#credit-bulk-confirm');
        const creditBulkCancel = $('#credit-bulk-cancel');

        let deferredInstallPrompt = null;

        const getInstallSupportMessage = () => {
            const ua = (navigator.userAgent || '').toLowerCase();
            if (ua.includes('iphone') || ua.includes('ipad') || ua.includes('ipod')) {
                return 'On Safari tap the Share icon, then choose "Add to Home Screen".';
            }
            if (ua.includes('android')) {
                return 'Open your browser menu and choose "Install app" or "Add to Home screen".';
            }
            return 'Use your browser menu to install/add this app to your device.';
        };

        const isStandaloneDisplay = () => {
            return window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true;
        };

        const updateInstallButtonState = () => {
            if (!pwaInstallButton) return;

            const installHelp = getInstallSupportMessage();
            const installed = isStandaloneDisplay();
            if (installed) {
                pwaInstallButton.classList.remove('hidden');
                pwaInstallButton.disabled = true;
                pwaInstallButton.setAttribute('aria-disabled', 'true');
                pwaInstallButton.textContent = 'App Installed';
                pwaInstallButton.title = 'App already installed';
                pwaInstallButton.classList.add('opacity-60', 'cursor-not-allowed');
                return;
            }

            pwaInstallButton.classList.remove('opacity-60', 'cursor-not-allowed');

            if (deferredInstallPrompt) {
                pwaInstallButton.classList.remove('hidden');
                pwaInstallButton.disabled = false;
                pwaInstallButton.setAttribute('aria-disabled', 'false');
                pwaInstallButton.textContent = 'Install App';
                pwaInstallButton.title = 'Install this app on your device';
            } else {
                pwaInstallButton.disabled = true;
            }
        };

        const setupPWAInstall = () => {
            if (!pwaInstallButton) return;

            updateInstallButtonState();

            const canUseServiceWorker = (window.isSecureContext || ['localhost', '127.0.0.1'].includes(window.location.hostname));
            if ('serviceWorker' in navigator && canUseServiceWorker) {
                navigator.serviceWorker.register('./sw.js', { scope: './' }).catch((error) => {
                    console.error('Service worker registration failed:', error);
                });
            } else if (!canUseServiceWorker) {
                console.warn('Service workers require HTTPS. PWA features may be limited.');
                pwaInstallButton.classList.remove('hidden');
                pwaInstallButton.disabled = true;
                pwaInstallButton.setAttribute('aria-disabled', 'true');
                pwaInstallButton.textContent = 'Install App';
                pwaInstallButton.title = 'Install requires HTTPS or serving from localhost.';
                pwaInstallButton.classList.add('opacity-60', 'cursor-not-allowed');
            }

            window.addEventListener('beforeinstallprompt', (event) => {
                event.preventDefault();
                deferredInstallPrompt = event;
                updateInstallButtonState();
            });

            pwaInstallButton.addEventListener('click', async () => {
                if (pwaInstallButton.disabled) {
                    if (typeof showToast === 'function') {
                        showToast(getInstallSupportMessage(), true);
                    }
                    return;
                }
                if (!deferredInstallPrompt) {
                    if (typeof showToast === 'function') {
                        showToast(getInstallSupportMessage(), true);
                    }
                    updateInstallButtonState();
                    return;
                }
                try {
                    deferredInstallPrompt.prompt();
                    const choice = await deferredInstallPrompt.userChoice;
                    deferredInstallPrompt = null;
                    if (choice.outcome === 'accepted') {
                        if (typeof showToast === 'function') {
                            showToast('Installation started. Check your device for the app icon.');
                        }
                    }
                } catch (error) {
                    console.error('Install prompt failed:', error);
                } finally {
                    updateInstallButtonState();
                }
            });

            window.addEventListener('appinstalled', () => {
                deferredInstallPrompt = null;
                if (typeof showToast === 'function') {
                    showToast('App installed! You can launch it from your device.');
                }
                updateInstallButtonState();
            });

            const standaloneMedia = window.matchMedia('(display-mode: standalone)');
            const handleStandaloneChange = () => updateInstallButtonState();
            if (standaloneMedia.addEventListener) {
                standaloneMedia.addEventListener('change', handleStandaloneChange);
            } else if (standaloneMedia.addListener) {
                standaloneMedia.addListener(handleStandaloneChange);
            }

            updateInstallButtonState();
        };

        // Expenses Page
        const expenseList = $('#expense-list');

        // PR Page
        const prList = $('#pr-list');
        const prFilter = $('#pr-filter');
        const prSearch = $('#pr-search');
        
        // Analytics Page
        const analyticsContent = $('#analytics-content');
        const analyticsLockedState = $('#analytics-locked-state');
        const analyticsUnlockBtn = $('#analytics-unlock');
        const analyticsCash = $('#analytics-cash');
        const analyticsProfit = $('#analytics-profit');
        const analyticsRealized = $('#analytics-realized');
        const analyticsMonth = $('#analytics-month');
        const analyticsExpenseTotal = $('#analytics-expense-total');
        const analyticsExpenseList = $('#analytics-expense-list');
        const analyticsInflow = $('#analytics-inflow');
        const analyticsOutflow = $('#analytics-outflow');
        const analyticsTransactionList = $('#analytics-transaction-list');

        // Settings Page
        const cashAdjAmount = $('#cash-adj-amount');
        const cashAdjDesc = $('#cash-adj-desc');
        const cashAdjAdd = $('#cash-adj-add');
        const cashAdjRemove = $('#cash-adj-remove');
        const settingLogout = $('#setting-logout');
        const settingReset = $('#setting-reset');
        const pinStatus = $('#pin-status');
        const pinCurrentInput = $('#pin-current');
        const pinNewInput = $('#pin-new');
        const pinUpdateBtn = $('#pin-update');
        
        // NEW: Backup/Restore Selectors
        const settingBackup = $('#setting-backup');
        const settingRestore = $('#setting-restore');
        const restoreFileInput = $('#restore-file-input');
        const backupModeDisplay = $('#backup-mode-display');
        
        // PAT Modal
        const patInput = $('#pat-input');
        const patSave = $('#pat-save');
        const patSkip = $('#pat-skip');
        const patError = $('#pat-error');
        
        // Form Modal
        const modalTitle = $('#modal-title');
        const modalBody = $('#modal-body');
        const modalSave = $('#modal-save');
        const modalClose = $('#modal-close');
        
        // Confirm Modal
        const confirmTitle = $('#confirm-title');
        const confirmMessage = $('#confirm-message');
        const confirmOk = $('#confirm-ok');
        const confirmCancel = $('#confirm-cancel');

        // PIN Modal
        const pinModal = $('#pin-modal');
        const pinInput = $('#pin-input');
        const pinSubmit = $('#pin-submit');
        const pinCancel = $('#pin-cancel');
        const pinError = $('#pin-error');
        const pinModalMessage = $('#pin-modal-message');

        // --- Gist API Constants ---
        const GIST_API_URL = 'https://api.github.com/gists';
        const GIST_FILENAME = 'secondHandBikeManager.data.json';
        const LOCAL_STORAGE_KEY = 'bikeManagerData';
        
        const renderBrandNewBikes = () => {
            const search = (state.ui.currentBikeSearch || '').toLowerCase();
            const deliveries = (state.data.brandNewDeliveries || [])
                .slice()
                .sort((a, b) => new Date(b.deliveryDate || b.createdAt) - new Date(a.deliveryDate || a.createdAt))
                .filter(delivery => {
                    if (!search) return true;
                    const haystack = [
                        delivery.bikeModel,
                        delivery.customerName,
                        delivery.customerContact,
                        delivery.showroomName,
                        delivery.invoiceNumber
                    ].map(value => (value || '').toString().toLowerCase());
                    return haystack.some(field => field.includes(search));
                });
            
            if (deliveries.length === 0) {
                bikeList.innerHTML = `<p class="text-gray-500 text-center mt-4">No brand new deliveries recorded yet.</p>`;
                return;
            }

            bikeList.innerHTML = deliveries.map(delivery => {
                const deliveryId = esc(delivery.id || '');
                const bikeModel = esc(delivery.bikeModel || 'Delivery');
                const customerName = esc(delivery.customerName || 'Customer');
                const showroomName = esc(delivery.showroomName || 'Showroom');
                const invoiceNumberValue = delivery.invoiceNumber ? esc(delivery.invoiceNumber) : '';
                const notesValue = delivery.notes ? esc(delivery.notes) : '';
                const commissionReceived = delivery.commissionReceived || 0;
                const paidOut = (delivery.commissionToGive || []).reduce((sum, ref) => {
                    return sum + (ref.paymentStatus === 'paid' ? (ref.commissionAmount || 0) : 0);
                }, 0);
                const pendingOut = (delivery.commissionToGive || []).reduce((sum, ref) => {
                    return sum + (ref.paymentStatus !== 'paid' ? (ref.commissionAmount || 0) : 0);
                }, 0);
                const netEarnings = commissionReceived - paidOut;
                
                const referrersHTML = (delivery.commissionToGive || []).length === 0
                    ? '<p class="text-sm text-gray-500">No referrer commissions configured.</p>'
                    : delivery.commissionToGive.map(ref => {
                        const statusPaid = ref.paymentStatus === 'paid';
                        const statusClass = statusPaid ? 'text-green-600' : 'text-amber-600';
                        const statusText = esc(statusPaid ? 'Paid' : 'Pending');
                        const toggleLabel = esc(statusPaid ? 'Mark Pending' : 'Mark Paid');
                        const contactInfo = ref.referrerContact
                            ? `<p class="text-xs text-gray-500">${esc(ref.referrerContact)}</p>`
                            : '';
                        return `
                            <div class="flex justify-between items-center py-2 border-b border-gray-100 last:border-0" data-ref-id="${esc(ref.id || '')}">
                                <div>
                                    <p class="font-medium text-gray-800">${esc(ref.referrerName || 'Unnamed Referrer')}</p>
                                    ${contactInfo}
                                </div>
                                <div class="text-right space-y-1">
                                    <p class="font-semibold text-gray-900">${esc(formatCurrency(ref.commissionAmount || 0))}</p>
                                    <span class="text-xs font-medium ${statusClass}">${statusText}</span>
                                    <button data-action="toggle-commission" class="block text-xs text-blue-600 font-semibold"> ${toggleLabel}</button>
                                </div>
                            </div>
                        `;
                    }).join('');

                const invoiceRow = delivery.invoiceNumber
                    ? `<p class="text-xs text-gray-500">Invoice: ${invoiceNumberValue}</p>`
                    : '';
                const notesRow = delivery.notes
                    ? `<p class="text-xs text-gray-500">Notes: ${notesValue}</p>`
                    : '';

                return `
                <div class="bg-white rounded-xl p-4 shadow-sm space-y-3" data-brand-id="${deliveryId}">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">${bikeModel}</h3>
                            <p class="text-sm text-gray-600">${customerName}  ${showroomName}</p>
                            ${invoiceRow}
                            ${notesRow}
                        </div>
                        <div class="text-right">
                            <p class="text-xs text-gray-500">Commission Received</p>
                            <p class="text-lg font-bold text-blue-600">${esc(formatCurrency(commissionReceived))}</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-3 text-sm bg-gray-50 rounded-lg p-3">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide">Delivery Date</p>
                            <p class="font-semibold text-gray-800">${esc(formatDate(delivery.deliveryDate || delivery.createdAt))}</p>
                        </div>
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide">Net Earnings</p>
                            <p class="font-semibold ${netEarnings >= 0 ? 'text-green-600' : 'text-red-600'}">${esc(formatCurrency(netEarnings))}</p>
                        </div>
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide">Paid Out</p>
                            <p class="font-semibold text-gray-800">${esc(formatCurrency(paidOut))}</p>
                        </div>
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide">Pending Payout</p>
                            <p class="font-semibold text-amber-600">${esc(formatCurrency(pendingOut))}</p>
                        </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-3">
                        <p class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-2">Referrer Commissions</p>
                        <div class="space-y-2">
                            ${referrersHTML}
                        </div>
                    </div>

                    <div class="flex justify-end gap-3 pt-2 border-t border-gray-200">
                        <button data-action="edit-brand-new" class="text-blue-500 font-medium text-sm">Edit</button>
                        <button data-action="delete-brand-new" class="text-red-500 font-medium text-sm">Delete</button>
                    </div>
                </div>
                `;
            }).join('');
            applyPendingHighlight();
        };
        
        // --- App State ---
        let state = {
            data: JSON.parse(JSON.stringify(DEFAULT_DATA)),
            ui: {
                currentPage: 'dashboard',
                currentBikeFilter: 'all',
                currentBikeSearch: '',
                currentBikeSort: 'dateDesc', // NEW
                currentBikeType: 'second_hand',
                bikeAdvancedFilters: {
                    profitMin: '',
                    profitMax: '',
                    dateFrom: '',
                    dateTo: '',
                    repairMin: '',
                    repairMax: ''
                },
                showBikeAdvanced: false,
                bikeBulkMode: false,
                bikeBulkSelection: [],
                currentDashboardSort: 'recent', // NEW
                currentPRFilter: 'all',
                currentPRSearch: '',
                creditBulkMode: false,
                creditBulkSelection: [],
                creditBulkDrafts: {},
                modal: {
                    isOpen: false,
                    type: null,
                    data: null
                },
                isGistSaving: false,
                pendingHighlight: null,
            },
            security: {
                isUnlocked: false,
                pendingResolve: null,
                pinMode: 'unlock',
                biometricInProgress: false
            },
            persistence: {
                ready: false,
                lastLoadedAt: null,
                lastSavedAt: null,
                version: env.APP_VERSION
            },
            media: {
                pendingImages: [],
                activeStream: null
            },
            metrics: {
                cashInHand: 0,
                totalProfit: 0,
                totalRevenue: 0,
                brandNewEarnings: 0,
                realizedProfit: 0,
                thisMonthProfit: 0,
                unsoldInvestment: 0,
                inventorySold: 0,
                inventoryUnsold: 0,
                totalCashInflow: 0, // NEW
                totalCashOutflow: 0, // NEW
                pendingReceivables: 0,
                creditCustomers: 0,
            }
        };

        // --- Cross Navigation Helpers ---

        const setBikePageState = ({ type = 'second_hand', filter = 'all', search = '' } = {}) => {
            state.ui.currentBikeType = type;
            state.ui.currentBikeFilter = filter;
            state.ui.currentBikeSearch = search;
        };

        const scheduleBikeHighlight = (payload) => {
            state.ui.pendingHighlight = payload;
        };

        const applyPendingHighlight = () => {
            const highlight = state.ui.pendingHighlight;
            if (!highlight || state.ui.currentPage !== 'bikes') return;

            const selector = highlight.type === 'brand_new'
                ? `[data-brand-id="${highlight.id}"]`
                : `[data-bike-id="${highlight.id}"]`;

            const target = document.querySelector(selector);
            if (!target) return;

            target.classList.add('highlight-pulse');
            target.scrollIntoView({ behavior: 'smooth', block: 'center' });
            setTimeout(() => target.classList.remove('highlight-pulse'), 3500);
            state.ui.pendingHighlight = null;
        };

        const navigateToBikeRecord = (bikeName) => {
            if (!bikeName) {
                showToast('No bike linked yet.', true);
                return;
            }

            const normalized = bikeName.toLowerCase();
            const matchBike = state.data.bikes.find(bike => {
                const names = [
                    (bike.bikeName || '').toLowerCase(),
                    (bike.bikeNumberPlate || '').toLowerCase()
                ];
                return names.includes(normalized);
            });

            if (matchBike) {
                setBikePageState({
                    type: 'second_hand',
                    filter: 'all',
                    search: matchBike.bikeName || matchBike.bikeNumberPlate || ''
                });
                scheduleBikeHighlight({ type: 'second_hand', id: matchBike.id });
                renderPage('bikes');
                return;
            }

            const matchBrand = state.data.brandNewDeliveries.find(delivery => (delivery.bikeModel || '').toLowerCase() === normalized);
            if (matchBrand) {
                setBikePageState({
                    type: 'brand_new',
                    filter: 'all',
                    search: matchBrand.bikeModel || ''
                });
                scheduleBikeHighlight({ type: 'brand_new', id: matchBrand.id });
                renderPage('bikes');
                return;
            }

            showToast('Could not find the linked bike yet.', true);
        };

        const filterBikesBySupplier = (supplierName) => {
            if (!supplierName) return;
            setBikePageState({
                type: 'second_hand',
                filter: 'all',
                search: supplierName
            });
            renderPage('bikes');
            showToast(`Filtered bikes by supplier: ${supplierName}`);
        };

        const filterBikesByOwner = (ownerName) => {
            if (!ownerName) return;
            setBikePageState({
                type: 'second_hand',
                filter: 'unsold',
                search: ownerName
            });
            renderPage('bikes');
            showToast(`Showing unsold bikes for ${ownerName}`);
        };

        const logPaymentForBuyer = (buyerName) => {
            if (!buyerName) {
                showToast('Buyer details missing.', true);
                return;
            }
            const normalized = buyerName.toLowerCase();
            const matches = state.data.bikes.filter(bike => (bike.customerName || '').toLowerCase() === normalized);

            if (!matches.length) {
                showToast('No bike sales linked to this buyer yet.', true);
                return;
            }

            const pendingBike = matches.find(bike => {
                if (bike.paymentMode === 'credit' && bike.creditInfo) {
                    return (bike.creditInfo.remaining || 0) > EPSILON;
                }
                if (bike.paymentMode === 'emi' && bike.emiInfo) {
                    return (bike.emiInfo.installmentsPaid || 0) < (bike.emiInfo.totalInstallments || 0);
                }
                return false;
            });

            const targetBike = pendingBike || matches[0];
            openModal('logPayment', targetBike);
        };

        const copyTextToClipboard = async (text) => {
            try {
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(text);
                } else {
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                }
                showToast('Contact copied.');
            } catch (error) {
                console.error('Clipboard error:', error);
                showToast('Unable to copy contact.', true);
            }
        };

        // --- Utility Functions ---
        
        const esc = (value = '') => String(value)
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;');
        
        const SENSITIVE_MASK = '';

        const setSensitiveValue = (element, value, formatter = (val) => val) => {
            if (!element) return;
            if (state.security.isUnlocked) {
                element.textContent = formatter(value);
                element.classList.remove('sensitive-mask');
            } else {
                element.textContent = SENSITIVE_MASK;
                element.classList.add('sensitive-mask');
            }
        };

        const setSensitiveCurrency = (element, value) => {
            setSensitiveValue(element, value ?? 0, (val) => formatCurrency(val || 0));
        };

        const refreshIcons = () => {
            icons.renderAll();
        };

        const updateSensitiveToggle = () => {
            if (!sensitiveToggle) return;
            sensitiveToggle.classList.toggle('locked', !state.security.isUnlocked);
            sensitiveToggle.setAttribute('title', state.security.isUnlocked ? 'Lock sensitive data' : 'Unlock sensitive data');
            sensitiveToggle.setAttribute('aria-pressed', state.security.isUnlocked ? 'true' : 'false');
            sensitiveToggle.innerHTML = `<i data-lucide="${esc(state.security.isUnlocked ? 'unlock' : 'lock')}"></i>`;
            refreshIcons();
        };

        const lockSensitiveData = () => {
            state.security.isUnlocked = false;
            updateSensitiveToggle();
            render();
        };

        const ensureSensitiveState = () => {
            updateSensitiveToggle();
        };

        const sanitizePhone = (value = '') => value.toString().replace(/\D/g, '');

        const formatCurrency = (num) => {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                maximumFractionDigits: 0
            }).format(num);
        };
        
        const formatDate = (dateString) => {
            if (!dateString) return '';
            try {
                return new Date(dateString).toISOString().split('T')[0];
            } catch (e) {
                return '';
            }
        };

        const formatDateTime = (dateString) => {
            if (!dateString) return 'No date';
            try {
                const d = new Date(dateString);
                if (dateString.includes('T')) {
                    return d.toLocaleString('en-IN', { dateStyle: 'short', timeStyle: 'short', hour12: true });
                }
                const parts = dateString.split('-');
                if (parts.length === 3) {
                    const utcDate = new Date(Date.UTC(parts[0], parts[1] - 1, parts[2]));
                    return utcDate.toLocaleDateString('en-IN', { dateStyle: 'short' });
                }
                return d.toLocaleDateString('en-IN', { dateStyle: 'short' });
            } catch (e) {
                console.warn(`Invalid date string: ${dateString}`);
                return dateString;
            }
        };

        const getNextMonthDate = (dateString) => {
            const date = new Date(dateString);
            date.setMonth(date.getMonth() + 1);
            return date.toISOString().split('T')[0];
        };
        
        const EPSILON = 0.01; // For floating point comparisons
        const MS_IN_DAY = 24 * 60 * 60 * 1000;
        const DEFAULT_GRACE_PERIOD_DAYS = 7;

        const parseToMidnight = (value) => {
            if (!value) return null;
            const date = new Date(value);
            if (Number.isNaN(date.getTime())) return null;
            return new Date(date.getFullYear(), date.getMonth(), date.getDate());
        };

        const getGracePeriodDays = (bike) => {
            if (bike.paymentMode === 'credit') {
                return parseInt(bike.creditInfo?.gracePeriodDays, 10) || DEFAULT_GRACE_PERIOD_DAYS;
            }
            if (bike.paymentMode === 'emi') {
                return parseInt(bike.emiInfo?.gracePeriodDays, 10) || DEFAULT_GRACE_PERIOD_DAYS;
            }
            return DEFAULT_GRACE_PERIOD_DAYS;
        };

        const getInterestRate = (bike) => {
            if (bike.paymentMode === 'credit') {
                return parseFloat(bike.creditInfo?.interestRate) || 0;
            }
            if (bike.paymentMode === 'emi') {
                return parseFloat(bike.emiInfo?.interestRate) || 0;
            }
            return 0;
        };

        const calculateSuggestedInterest = ({ principal, interestRate, daysOverdue }) => {
            if (!principal || principal <= 0) return 0;
            if (!interestRate || interestRate <= 0) return 0;
            if (!daysOverdue || daysOverdue <= 0) return 0;
            const dailyRate = (interestRate / 100) / 30;
            const interest = principal * dailyRate * daysOverdue;
            return Math.max(0, Math.round(interest));
        };

        const getDueMetadata = (bike) => {
            const today = parseToMidnight(new Date());
            const graceDays = getGracePeriodDays(bike);
            const interestRate = getInterestRate(bike);
            let dueDate = null;
            let pendingPrincipal = 0;
            let installmentsLeft = 0;

            if (bike.paymentMode === 'credit' && bike.creditInfo) {
                dueDate = parseToMidnight(bike.creditInfo.dueDate);
                pendingPrincipal = Math.max(0, parseFloat(bike.creditInfo.remaining) || 0);
            } else if (bike.paymentMode === 'emi' && bike.emiInfo) {
                dueDate = parseToMidnight(bike.emiInfo.nextDueDate);
                installmentsLeft = Math.max(0, (parseInt(bike.emiInfo.totalInstallments, 10) || 0) - (parseInt(bike.emiInfo.installmentsPaid, 10) || 0));
                pendingPrincipal = Math.max(0, installmentsLeft * (parseFloat(bike.emiInfo.monthlyAmount) || 0));
            }

            let status = 'clear';
            let statusLabel = 'All dues cleared';
            let daysUntilDue = null;
            let daysOverdue = null;

            if (dueDate && pendingPrincipal > EPSILON) {
                const diffMs = dueDate.getTime() - today.getTime();
                const diffDays = Math.floor(diffMs / MS_IN_DAY);

                if (diffDays > 0) {
                    status = 'upcoming';
                    daysUntilDue = diffDays;
                    statusLabel = diffDays === 1 ? 'Due tomorrow' : `Due in ${diffDays} days`;
                } else if (diffDays === 0) {
                    status = 'dueToday';
                    statusLabel = 'Due today';
                } else {
                    const overdueBy = Math.abs(diffDays);
                    if (overdueBy <= graceDays) {
                        status = 'grace';
                        daysOverdue = overdueBy;
                        const remainingGrace = graceDays - overdueBy;
                        statusLabel = remainingGrace === 0
                            ? 'Grace period ends today'
                            : `Within grace period (${remainingGrace} day${remainingGrace === 1 ? '' : 's'} left)`;
                    } else {
                        status = 'overdue';
                        daysOverdue = overdueBy - graceDays;
                        statusLabel = `Overdue by ${daysOverdue} day${daysOverdue === 1 ? '' : 's'}`;
                    }
                }
            }

            const suggestedInterest = calculateSuggestedInterest({
                principal: pendingPrincipal,
                interestRate,
                daysOverdue: status === 'overdue' ? daysOverdue : 0
            });

            return {
                dueDate: dueDate ? dueDate.toISOString().split('T')[0] : null,
                graceDays,
                interestRate,
                pendingPrincipal,
                installmentsLeft,
                status,
                statusLabel,
                daysUntilDue,
                daysOverdue,
                suggestedInterest
            };
        };

        const showLoader = () => {
            loader.classList.remove('hidden');
        };
        
        const hideLoader = () => {
            loader.classList.add('hidden');
        };

        const showToast = (message, isError = false) => {
            const toast = document.createElement('div');
            toast.className = `fixed top-5 left-1/2 -translate-x-1/2 p-3 rounded-lg shadow-md text-white z-[110] ${isError ? 'bg-red-500' : 'bg-green-500'}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.remove();
            }, 3000);
        };
        
        const showConfirm = (title, message) => {
            return new Promise((resolve) => {
                confirmTitle.textContent = title;
                confirmMessage.textContent = message;
                confirmModal.classList.remove('hidden');

                confirmOk.onclick = () => {
                    confirmModal.classList.add('hidden');
                    resolve(true);
                };
                confirmCancel.onclick = () => {
                    confirmModal.classList.add('hidden');
                    resolve(false);
                };
            });
        };

        const showExportChoice = (title = 'Export Data', message = 'Select export format.') => {
            return new Promise((resolve) => {
                const previousState = {
                    title: confirmTitle.textContent,
                    message: confirmMessage.textContent,
                    okLabel: confirmOk.textContent,
                    cancelLabel: confirmCancel.textContent,
                    okHandler: confirmOk.onclick,
                    cancelHandler: confirmCancel.onclick,
                    overlayHandler: confirmModal.querySelector('.modal-overlay').onclick
                };

                const overlay = confirmModal.querySelector('.modal-overlay');

                const cleanup = () => {
                    confirmModal.classList.add('hidden');
                    confirmTitle.textContent = previousState.title;
                    confirmMessage.textContent = previousState.message;
                    confirmOk.textContent = previousState.okLabel;
                    confirmCancel.textContent = previousState.cancelLabel;
                    confirmOk.onclick = previousState.okHandler;
                    confirmCancel.onclick = previousState.cancelHandler;
                    overlay.onclick = previousState.overlayHandler;
                    document.removeEventListener('keydown', handleKeyDown);
                };

                const handleKeyDown = (event) => {
                    if (event.key === 'Escape') {
                        cleanup();
                        resolve(null);
                    }
                };

                confirmTitle.textContent = title;
                confirmMessage.textContent = message;
                confirmOk.textContent = 'CSV';
                confirmCancel.textContent = 'PDF';
                confirmModal.classList.remove('hidden');
                document.addEventListener('keydown', handleKeyDown);

                confirmOk.onclick = () => {
                    cleanup();
                    resolve('csv');
                };
                confirmCancel.onclick = () => {
                    cleanup();
                    resolve('pdf');
                };

                overlay.onclick = () => {
                    cleanup();
                    resolve(null);
                };
            });
        };
        
        const runDataMigration = () => {
            let migrated = false;
            
            if (!state.data || typeof state.data !== 'object') {
                state.data = JSON.parse(JSON.stringify(DEFAULT_DATA));
                migrated = true;
            }
            
            state.data.bikes = Array.isArray(state.data.bikes) ? state.data.bikes : [];
            state.data.expenses = Array.isArray(state.data.expenses) ? state.data.expenses : [];
            state.data.pr = Array.isArray(state.data.pr) ? state.data.pr : [];
            state.data.cashEntries = Array.isArray(state.data.cashEntries) ? state.data.cashEntries : [];
            state.data.payments = Array.isArray(state.data.payments) ? state.data.payments : [];
            state.data.brandNewDeliveries = Array.isArray(state.data.brandNewDeliveries) ? state.data.brandNewDeliveries : [];
            state.data.settings = state.data.settings || {};
            if (!state.data.settings.pin) {
                state.data.settings.pin = '1111';
                migrated = true;
            }
            
            if (!state.data.cashEntries) {
                state.data.cashEntries = [];
                migrated = true;
            }
            if (!state.data.payments) {
                state.data.payments = [];
                migrated = true;
            }
            
            if (state.data.settings && state.data.settings.baseInvestment > 0) {
                state.data.cashEntries.push({
                    id: crypto.randomUUID(),
                    type: 'add',
                    amount: state.data.settings.baseInvestment,
                    description: 'Initial Base Investment (Migrated)',
                    createdAt: new Date().toISOString()
                });
                state.data.settings.baseInvestment = 0;
                migrated = true;
            }

            state.data.bikes.forEach(bike => {
            if (bike.creditInfo) {
                const parsedGrace = parseInt(bike.creditInfo.gracePeriodDays, 10);
                bike.creditInfo.gracePeriodDays = Number.isFinite(parsedGrace) && parsedGrace >= 0
                    ? parsedGrace
                    : DEFAULT_GRACE_PERIOD_DAYS;
                const parsedRate = parseFloat(bike.creditInfo.interestRate);
                bike.creditInfo.interestRate = Number.isFinite(parsedRate) && parsedRate >= 0
                    ? parsedRate
                    : 0;
            }

            if (bike.emiInfo) {
                const parsedGrace = parseInt(bike.emiInfo.gracePeriodDays, 10);
                bike.emiInfo.gracePeriodDays = Number.isFinite(parsedGrace) && parsedGrace >= 0
                    ? parsedGrace
                    : DEFAULT_GRACE_PERIOD_DAYS;
                const parsedRate = parseFloat(bike.emiInfo.interestRate);
                bike.emiInfo.interestRate = Number.isFinite(parsedRate) && parsedRate >= 0
                    ? parsedRate
                    : 0;
            }

                if (!bike.referral) {
                    bike.referral = null;
                } else {
                    bike.referral.name = (bike.referral.name || '').trim();
                    bike.referral.contact = (bike.referral.contact || '').trim();
                    bike.referral.commission = parseFloat(bike.referral.commission || 0) || 0;
                }

                const parsedTarget = parseFloat(bike.targetSalePrice);
                const cleanTarget = Number.isFinite(parsedTarget) && parsedTarget > 0 ? parsedTarget : null;
                if (bike.targetSalePrice !== cleanTarget) {
                    bike.targetSalePrice = cleanTarget;
                    migrated = true;
                }
                if (typeof bike.clearanceSale !== 'boolean') {
                    bike.clearanceSale = !!bike.clearanceSale;
                    migrated = true;
                }

                if (bike.sold && bike.sellingPrice > 0 && !bike.paymentMode) {
                    bike.paymentMode = 'cash';
                    
                    const existingPayment = state.data.payments.find(p => p.bikeId === bike.id && p.type === 'Initial Payment');
                    if (!existingPayment) {
                        state.data.payments.push({
                            id: crypto.randomUUID(),
                            bikeId: bike.id,
                            bikeName: bike.bikeName || bike.bikeNumberPlate,
                            amount: bike.sellingPrice,
                            date: bike.soldAt || bike.soldDate,
                            type: 'Initial Payment'
                        });
                        migrated = true;
                    }
                }

                if (bike.paymentMode === 'emi' && bike.emiInfo && typeof bike.emiInfo.totalInstallments === 'undefined') {
                    bike.emiInfo.totalInstallments = 0; 
                    bike.emiInfo.installmentsPaid = 0;
                    migrated = true;
                }
            });

            state.data.pr = state.data.pr.filter(pr => pr.relationType !== 'Showroom' && pr.relationType !== 'Referrer');

            state.data.brandNewDeliveries = state.data.brandNewDeliveries.map(delivery => {
                const safeDelivery = {
                    ...delivery,
                    commissionToGive: Array.isArray(delivery.commissionToGive) ? delivery.commissionToGive : delivery.commission_to_give || [],
                };

                safeDelivery.commissionToGive = safeDelivery.commissionToGive.map(ref => ({
                    id: ref.id || crypto.randomUUID(),
                    referrerName: ref.referrerName || ref.referrer_name || '',
                    referrerContact: ref.referrerContact || ref.referrer_contact || '',
                    commissionAmount: parseFloat(ref.commissionAmount ?? ref.commission_amount ?? 0) || 0,
                    paymentStatus: (ref.paymentStatus || ref.payment_status || 'pending') === 'paid' ? 'paid' : 'pending'
                }));

                safeDelivery.commissionReceived = parseFloat(safeDelivery.commissionReceived ?? safeDelivery.commission_received ?? 0) || 0;
                delete safeDelivery.commission_received;
                delete safeDelivery.commission_to_give;
                safeDelivery.createdAt = safeDelivery.createdAt || safeDelivery.created_at || new Date().toISOString();
                delete safeDelivery.created_at;

                return safeDelivery;
            });
            
            if (migrated) {
                console.log("Data migration complete.");
            }

            const isCompletelyEmpty = state.data.bikes.length === 0
                && state.data.expenses.length === 0
                && state.data.pr.length === 0
                && state.data.cashEntries.length === 0
                && state.data.payments.length === 0;

            if (isCompletelyEmpty) {
                state.data = JSON.parse(JSON.stringify(DEFAULT_DATA));
                console.info('Loaded default demo dataset.');
                saveData();
            } else if (migrated) {
                saveData();
            }
        };

        // --- Vault Persistence ---

        let saveTimeout;
        const persistState = async () => {
            try {
                const savedAt = await vault.save(state.data);
                state.persistence.lastSavedAt = savedAt;
                state.persistence.ready = true;
                return true;
            } catch (error) {
                console.error('Error saving vault:', error);
                showToast('Failed to save data.', true);
                return false;
            }
        };

        const saveData = (delay = 400) => {
            if (!auth.isUnlocked()) {
                console.warn('Skipped save while locked.');
                return Promise.resolve(false);
            }
            if (saveTimeout) {
                clearTimeout(saveTimeout);
            }
            return new Promise((resolve) => {
                saveTimeout = setTimeout(async () => {
                    saveTimeout = null;
                    const result = await persistState();
                    resolve(result);
                }, Math.max(0, delay));
            });
        };

        const saveDataImmediate = () => saveData(0);

        // --- Core App Logic ---

        const autoCreatePRContact = ({ name, contact, relationType = 'Other', relatedBikeName }) => {
            if (relationType === 'Showroom' || relationType === 'Referrer') {
                return;
            }
            const trimmedName = (name || '').trim();
            const displayContact = (contact || '').trim();
            const normalizedContact = sanitizePhone(displayContact);
            if (!trimmedName) {
                return;
            }

            const relation = relationType || 'Other';
            const bikeName = (relatedBikeName || '').trim();
            const identityKey = normalizedContact || trimmedName.toLowerCase();

            const existingEntry = state.data.pr.find(pr => {
                const existingKey = sanitizePhone(pr.contact) || pr.name.toLowerCase();
                return existingKey === identityKey && pr.relationType === relation;
            });

            if (existingEntry) {
                existingEntry.name = trimmedName;
                existingEntry.contact = displayContact || existingEntry.contact || '';
                if (bikeName) {
                    const bikes = new Set(
                        (existingEntry.relatedBikeName || '')
                            .split(',')
                            .map(entry => entry.trim())
                            .filter(Boolean)
                    );
                    bikes.add(bikeName);
                    existingEntry.relatedBikeName = Array.from(bikes).join(', ');
                }
                return;
            }

            state.data.pr.push({
                id: crypto.randomUUID(),
                name: trimmedName,
                contact: displayContact,
                relationType: relation,
                relatedBikeName: bikeName
            });
        };
        
        const calculateMetrics = () => {
            const { bikes, expenses, cashEntries, payments } = state.data;
            
            const soldBikes = bikes.filter(b => b.sold);
            const unsoldBikes = bikes.filter(b => !b.sold);
            
            const totalProfit = soldBikes.reduce((sum, b) => {
                const cost = (b.purchasePrice || 0) + (b.repairPrice || 0);
                const sale = b.sellingPrice || 0;
                return sum + (sale - cost);
            }, 0);
            const totalRevenue = soldBikes.reduce((sum, b) => sum + (b.sellingPrice || 0), 0);
            const brandNewDeliveries = state.data.brandNewDeliveries || [];
            const brandNewEarnings = brandNewDeliveries.reduce((sum, delivery) => sum + (delivery.commissionReceived || 0), 0);
            const brandNewCommissionsPaid = brandNewDeliveries.reduce((sum, delivery) => {
                return sum + (delivery.commissionToGive || []).reduce((s, ref) => {
                    return s + (ref.paymentStatus === 'paid' ? (ref.commissionAmount || 0) : 0);
                }, 0);
            }, 0);
            
            const unsoldInvestment = unsoldBikes.reduce((sum, b) => {
                return sum + (b.purchasePrice || 0) + (b.repairPrice || 0);
            }, 0);
            
            const totalCashAdded = (cashEntries || []).reduce((sum, e) => e.type === 'add' ? sum + e.amount : sum, 0);
            const totalCashRemoved = (cashEntries || []).reduce((sum, e) => e.type === 'remove' ? sum + e.amount : sum, 0);
            const totalSalesReceived = (payments || []).reduce((sum, p) => sum + p.amount, 0);
            const totalPurchases = bikes.reduce((sum, b) => sum + (b.purchasePrice || 0) + (b.repairPrice || 0), 0);
            const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
            
            const cashInHand = (totalCashAdded + totalSalesReceived + brandNewEarnings) - (totalCashRemoved + totalPurchases + totalExpenses + brandNewCommissionsPaid);
            
            const totalCashInflow = totalCashAdded + totalSalesReceived + brandNewEarnings;
            const totalCashOutflow = totalCashRemoved + totalPurchases + totalExpenses + brandNewCommissionsPaid;

            const pendingReceivables = soldBikes.reduce((sum, bike) => {
                if (bike.paymentMode === 'credit' && bike.creditInfo) {
                    return sum + Math.max(0, bike.creditInfo.remaining || 0);
                }
                if (bike.paymentMode === 'emi' && bike.emiInfo) {
                    const installmentsPaid = bike.emiInfo.installmentsPaid || 0;
                    const totalInstallments = bike.emiInfo.totalInstallments || 0;
                    const monthlyAmount = bike.emiInfo.monthlyAmount || 0;
                    const installmentsLeft = Math.max(totalInstallments - installmentsPaid, 0);
                    return sum + (installmentsLeft * monthlyAmount);
                }
                return sum;
            }, 0);

            const creditCustomers = soldBikes.filter(bike => {
                if (bike.paymentMode === 'credit' && bike.creditInfo) {
                    return (bike.creditInfo.remaining || 0) > EPSILON;
                }
                if (bike.paymentMode === 'emi' && bike.emiInfo) {
                    const installmentsPaid = bike.emiInfo.installmentsPaid || 0;
                    const totalInstallments = bike.emiInfo.totalInstallments || 0;
                    return installmentsPaid < totalInstallments;
                }
                return false;
            }).length;

            const paymentsThisMonth = payments.filter(p => {
                if (!p.date) return false;
                const d = new Date(p.date);
                const now = new Date();
                return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth();
            }).reduce((sum, p) => sum + (p.amount || 0), 0);

            const purchasesThisMonth = bikes.filter(b => {
                if (!b.purchaseDate) return false;
                const d = new Date(b.purchaseDate);
                const now = new Date();
                return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth();
            }).reduce((sum, b) => sum + (b.purchasePrice || 0) + (b.repairPrice || 0), 0);

            const expensesThisMonth = expenses.filter(e => {
                if (!e.date) return false;
                const d = new Date(e.date);
                const now = new Date();
                return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth();
            }).reduce((sum, e) => sum + (e.amount || 0), 0);

            const realizedProfit = totalSalesReceived - totalPurchases - totalExpenses;
            const thisMonthProfit = paymentsThisMonth - purchasesThisMonth - expensesThisMonth;
            
            state.metrics = {
                cashInHand,
                totalProfit,
                totalRevenue,
                brandNewEarnings,
                realizedProfit,
                thisMonthProfit,
                unsoldInvestment,
                inventorySold: soldBikes.length,
                inventoryUnsold: unsoldBikes.length,
                totalCashInflow,
                totalCashOutflow,
                pendingReceivables,
                creditCustomers,
            };
        };

        // --- Rendering Functions ---

        const render = () => {
            calculateMetrics();
            
            const pageId = `page-${state.ui.currentPage}`;
            const pageRenderFunction = {
                'page-dashboard': renderDashboard,
                'page-bikes': renderBikesPage,
                'page-credit': renderCreditPage,
                'page-analytics': renderAnalyticsPage,
                'page-expenses': renderExpensesPage,
                'page-pr': renderPRPage,
                'page-settings': renderSettingsPage,
            }[pageId];
            
            if (pageRenderFunction) pageRenderFunction();
            
            renderDashboardReminders();
            if (state.ui.currentPage !== 'dashboard') {
                renderDashboard();
            }
            ensureSensitiveState();
            refreshIcons();
        };

        const renderPage = (pageId) => {
            state.ui.currentPage = pageId;
            
            pages.forEach(p => p.classList.add('hidden'));
            const activePage = $(`#page-${pageId}`);
            if (activePage) {
                activePage.classList.remove('hidden');
            }
            
            navBar.querySelectorAll('.nav-item').forEach(item => {
                item.classList.toggle('active', item.dataset.page === pageId);
            });
            
            const pageTitles = {
                'dashboard': 'Dashboard',
                'bikes': 'Bikes',
                'credit': 'Credit Desk',
                'analytics': 'Analytics',
                'expenses': 'Expenses',
                'pr': 'PR Contacts',
                'settings': 'Settings'
            };
            pageTitle.textContent = pageTitles[pageId] || 'Manager';

            const showAddButton = ['bikes', 'expenses', 'pr'];
            addButton.classList.toggle('hidden', !showAddButton.includes(pageId));
            
            render();
        };

        const renderDashboard = () => {
            const { unsoldInvestment, inventorySold, inventoryUnsold } = state.metrics;
            const sortMode = state.ui.currentDashboardSort;

            setSensitiveCurrency(dashboardCash, state.metrics.cashInHand);
            setSensitiveCurrency(dashboardRevenue, state.metrics.totalRevenue);
            setSensitiveCurrency(dashboardProfit, state.metrics.totalProfit);
            setSensitiveCurrency(dashboardBrand, state.metrics.brandNewEarnings);

            metricInvestment.textContent = formatCurrency(unsoldInvestment);
            metricInventory.textContent = `${inventoryUnsold} unsold / ${inventorySold} sold`;
            dashboardSort.value = sortMode;
            
            // Render unsold bikes
            let unsoldBikes = state.data.bikes
                .filter(b => !b.sold);
            
            const getBikeCost = b => (b.purchasePrice || 0) + (b.repairPrice || 0);

            if (sortMode === 'recent') {
                unsoldBikes.sort((a, b) => new Date(b.createdAt || b.purchaseDate) - new Date(a.createdAt || a.purchaseDate));
            } else if (sortMode === 'high_price') {
                unsoldBikes.sort((a, b) => getBikeCost(b) - getBikeCost(a));
            } else if (sortMode === 'low_price') {
                unsoldBikes.sort((a, b) => getBikeCost(a) - getBikeCost(b));
            }
            
            // Show all unsold, not just 3, since it's sortable now
            if (unsoldBikes.length === 0) {
                dashboardRecentBikes.innerHTML = `<p class="text-gray-500 text-sm text-center">No unsold bikes yet.</p>`;
            } else {
                dashboardRecentBikes.innerHTML = unsoldBikes.map(bike => `
                    <div class="flex justify-between items-center py-1">
                        <div>
                            <span class="font-medium">${esc(bike.bikeName || bike.bikeNumberPlate)}</span>
                            <span class="text-xs text-gray-500 block">${esc(bike.bikeNumberPlate || '')}</span>
                        </div>
                        <span class="text-sm text-gray-600">${esc(formatCurrency(getBikeCost(bike)))}</span>
                    </div>
                `).join('');
            }
            renderDashboardReminders();
        };
        
        const renderDashboardReminders = () => {
            const { records } = summarizeCreditRecords();
            const statusRank = {
                overdue: 0,
                dueToday: 1,
                grace: 2,
                upcoming: 3
            };

            let bestReminder = null;

            records.forEach(record => {
                const dueMeta = record.dueMeta || {};
                const pendingPrincipal = typeof dueMeta.pendingPrincipal === 'number'
                    ? dueMeta.pendingPrincipal
                    : (typeof record.pendingAmount === 'number' ? record.pendingAmount : 0);
                if (pendingPrincipal <= EPSILON) {
                    return;
                }

                let dueDate = null;
                if (dueMeta.dueDate) {
                    const parsed = new Date(dueMeta.dueDate);
                    if (!Number.isNaN(parsed.getTime())) {
                        dueDate = parsed;
                    }
                }

                if (!dueDate) {
                    return;
                }

                const status = dueMeta.status || 'upcoming';
                const priority = Object.prototype.hasOwnProperty.call(statusRank, status)
                    ? statusRank[status]
                    : 99;

                let amount = pendingPrincipal;
                if (record.paymentMode === 'emi') {
                    const monthly = record.monthlyAmount || 0;
                    const installmentsLeft = typeof dueMeta.installmentsLeft === 'number'
                        ? dueMeta.installmentsLeft
                        : Math.max((record.totalInstallments || 0) - (record.installmentsPaid || 0), 0);
                    const isFinalInstallment = installmentsLeft <= 1;
                    if (monthly > EPSILON) {
                        amount = isFinalInstallment ? pendingPrincipal : Math.min(monthly, pendingPrincipal);
                    }
                }

                const candidate = {
                    record,
                    priority,
                    dueDate,
                    amount
                };

                if (
                    !bestReminder ||
                    candidate.priority < bestReminder.priority ||
                    (candidate.priority === bestReminder.priority && candidate.dueDate < bestReminder.dueDate)
                ) {
                    bestReminder = candidate;
                }
            });

            if (!bestReminder) {
                dashboardReminders.innerHTML = `<p class="text-gray-500 text-sm text-center">No upcoming EMI or credit payments.</p>`;
                return;
            }

            const { record, amount, dueDate } = bestReminder;
            const dueMeta = record.dueMeta || {};
            const label = record.paymentMode === 'emi' ? 'EMI' : 'Credit';
            const dueDateDisplay = formatDate(dueDate.toISOString());
            const statusLabel = dueMeta.statusLabel || '';
            const contactLabel = (record.contact && record.contact !== 'N/A') ? record.contact : 'No contact saved';
            const contactDigits = record.phoneHref || '';
            const callHref = contactDigits ? `tel:${contactDigits}` : '';
            const whatsappHref = contactDigits
                ? `https://wa.me/${contactDigits}?text=${encodeURIComponent(buildWhatsappReminderMessage(record))}`
                : '';
            const overdueInterestLine = record.overdueInterest > EPSILON
                ? `<p class="text-xs text-red-600 mt-2">Interest due: ${esc(formatCurrency(record.overdueInterest))}</p>`
                : '';

            const chips = [];
            if (dueMeta.graceDays) {
                chips.push(`<span class="px-2 py-0.5 text-[10px] font-medium bg-blue-100 text-blue-700 rounded-full">Grace ${esc(dueMeta.graceDays)}d</span>`);
            }
            if (dueMeta.interestRate) {
                chips.push(`<span class="px-2 py-0.5 text-[10px] font-medium bg-purple-100 text-purple-700 rounded-full">Interest ${esc(dueMeta.interestRate)}%/mo</span>`);
            }

            dashboardReminders.innerHTML = `
                <div class="py-3 px-4 border border-blue-100 rounded-xl bg-blue-50/60 space-y-3 cursor-pointer" data-reminder-card data-bike-id="${esc(record.bikeId || '')}">
                    <div class="flex justify-between items-start gap-3">
                        <div class="space-y-1">
                            <p class="text-sm font-semibold text-blue-700">${esc(label)} due on ${esc(dueDateDisplay)}</p>
                            <p class="text-sm font-medium text-gray-900">${esc(record.customerName || 'Unknown')}</p>
                            <p class="text-xs text-gray-600">${esc(record.bikeName || '')}</p>
                            ${chips.length ? `<div class="flex flex-wrap gap-2">${chips.join('')}</div>` : ''}
                        </div>
                        <div class="text-right space-y-1">
                            <span class="text-base font-bold text-blue-600">${esc(formatCurrency(amount))}</span>
                            ${statusLabel ? `<span class="inline-block text-[11px] font-semibold px-2 py-0.5 rounded-full bg-white border border-blue-200 text-blue-700">${esc(statusLabel)}</span>` : ''}
                        </div>
                    </div>
                    <div class="flex justify-between items-center text-xs text-gray-500">
                        <span>${esc(contactLabel)}</span>
                        <div class="flex gap-2">
                            ${callHref ? `<a class="px-2 py-1 rounded-lg bg-white text-blue-600 font-semibold shadow-sm" data-reminder-action href="${esc(callHref)}">Call</a>` : ''}
                            ${whatsappHref ? `<a class="px-2 py-1 rounded-lg bg-green-500 text-white font-semibold shadow-sm" data-reminder-action href="${esc(whatsappHref)}" target="_blank" rel="noopener noreferrer">WhatsApp</a>` : ''}
                        </div>
                    </div>
                    ${overdueInterestLine}
                    <p class="text-xs text-gray-500">Tap the card to log a payment.</p>
                </div>
            `;
        };
        
        function updateBikeBulkFooter() {
            if (!bikeClearanceFooter) return;
            const selection = state.ui.bikeBulkSelection || [];
            const show = state.ui.bikeBulkMode && selection.length > 0;
            bikeClearanceFooter.classList.toggle('hidden', !show);
            if (bikeClearanceCount) {
                bikeClearanceCount.textContent = `${selection.length} bike${selection.length === 1 ? '' : 's'} selected`;
            }
            [bikeClearanceMark, bikeClearanceRemove].forEach((button) => {
                if (!button) return;
                const disabled = selection.length === 0;
                button.disabled = disabled;
                button.classList.toggle('opacity-60', disabled);
                button.classList.toggle('cursor-not-allowed', disabled);
            });
        }

        const renderBikesPage = () => {
            const {
                currentBikeFilter,
                currentBikeSearch,
                currentBikeSort,
                currentBikeType,
                bikeAdvancedFilters = {},
                showBikeAdvanced,
                bikeBulkMode,
                bikeBulkSelection = []
            } = state.ui;

            const search = currentBikeSearch.toLowerCase();

            const parseNumber = (value) => {
                const num = parseFloat(value);
                return Number.isFinite(num) ? num : null;
            };

            const parseDate = (value) => {
                if (!value) return null;
                const date = new Date(value);
                return Number.isNaN(date.getTime()) ? null : date;
            };

            const dayMs = 24 * 60 * 60 * 1000;
            const getBikeCost = (bike) => (bike.purchasePrice || 0) + (bike.repairPrice || 0);
            const normalizeName = (value) => (value || '').trim().toLowerCase();

            const insightsCache = new Map();
            const computeProfitInsights = (bike) => {
                if (!bike) {
                    return {
                        totalCost: 0,
                        saleValue: 0,
                        profitValue: 0,
                        margin: 0,
                        level: 'medium',
                        badgeClass: 'bg-yellow-100 text-yellow-700',
                        label: 'Medium',
                        isActual: false,
                        similarSold: [],
                        similarUnsold: []
                    };
                }

                const totalCost = getBikeCost(bike);
                const sold = !!bike.sold;
                const soldPrice = sold ? (bike.sellingPrice || 0) : 0;
                const normalized = normalizeName(bike.bikeName);

                const similarSold = !sold && normalized
                    ? state.data.bikes.filter(entry =>
                        entry.id !== bike.id &&
                        !!entry.sold &&
                        normalizeName(entry.bikeName) === normalized)
                    : [];

                const similarUnsold = !sold && normalized
                    ? state.data.bikes.filter(entry =>
                        entry.id !== bike.id &&
                        !entry.sold &&
                        normalizeName(entry.bikeName) === normalized)
                    : [];

                let estimatedSale = sold ? soldPrice : (bike.targetSalePrice || 0);
                if (!sold && !estimatedSale && similarSold.length) {
                    const total = similarSold.reduce((sum, entry) => sum + (entry.sellingPrice || 0), 0);
                    estimatedSale = total / similarSold.length;
                }

                const saleValue = estimatedSale || 0;
                const profitValue = saleValue - totalCost;
                const margin = totalCost > 0 ? profitValue / totalCost : 0;

                let level = 'medium';
                let badgeClass = 'bg-yellow-100 text-yellow-700';
                if (profitValue <= 0 || margin < 0.08) {
                    level = 'low';
                    badgeClass = 'bg-red-100 text-red-700';
                } else if (profitValue >= 15000 || margin >= 0.25) {
                    level = 'high';
                    badgeClass = 'bg-green-100 text-green-700';
                }

                return {
                    totalCost,
                    saleValue,
                    profitValue,
                    margin,
                    level,
                    badgeClass,
                    label: level === 'high' ? 'High' : level === 'low' ? 'Low' : 'Medium',
                    isActual: sold,
                    similarSold,
                    similarUnsold
                };
            };

            const getInsights = (bike) => {
                if (!bike || !bike.id) {
                    return computeProfitInsights(bike);
                }
                if (!insightsCache.has(bike.id)) {
                    insightsCache.set(bike.id, computeProfitInsights(bike));
                }
                return insightsCache.get(bike.id);
            };

            const buildSimilarSection = (bike, insights) => {
                if (!bike || bike.sold) return '';

                const matches = [...(insights.similarSold || []), ...(insights.similarUnsold || [])]
                    .filter(entry => entry && entry.id !== bike.id)
                    .slice(0, 3);

                if (!matches.length) {
                    return '';
                }

                const rows = matches.map(entry => {
                    const entryInsights = getInsights(entry);
                    const status = esc(entry.sold ? 'Sold' : 'Unsold');
                    const statusClass = entry.sold ? 'text-green-600' : 'text-amber-600';
                    const saleLabel = entry.sold
                        ? `Sold @ ${esc(formatCurrency(entry.sellingPrice || 0))}`
                        : (entry.targetSalePrice
                            ? `Target ${esc(formatCurrency(entry.targetSalePrice))}`
                            : `Cost ${esc(formatCurrency(entryInsights.totalCost))}`);
                    const profitLabel = esc(entry.sold ? 'Profit' : 'Potential');

                    return `
                        <div class="flex justify-between items-start gap-3 text-xs">
                            <div>
                                <p class="font-semibold text-gray-700">${esc(entry.bikeName || entry.bikeNumberPlate)}</p>
                                <p class="text-gray-500">${saleLabel}</p>
                            </div>
                            <div class="text-right">
                                <span class="font-semibold ${statusClass}">${status}</span>
                                <p class="text-[11px] text-gray-500">${profitLabel}: ${esc(formatCurrency(entryInsights.profitValue))}</p>
                            </div>
                        </div>
                    `;
                }).join('');

                return `
                    <div class="bg-gray-50 rounded-xl p-3 space-y-2">
                        <div class="flex items-center justify-between">
                            <span class="text-xs font-semibold text-gray-600 uppercase tracking-wide">Similar Bikes</span>
                            <span class="text-[11px] text-gray-500">${esc(matches.length)} match${matches.length === 1 ? '' : 'es'}</span>
                        </div>
                        ${rows}
                    </div>
                `;
            };

            if (bikeTypeToggle) {
                bikeTypeToggle.querySelectorAll('button').forEach(button => {
                    button.classList.toggle('active', button.dataset.type === currentBikeType);
                });
            }

            if (bikeSearch && bikeSearch !== document.activeElement) {
                bikeSearch.value = currentBikeSearch;
            }

            if (bikeFilter) {
                bikeFilter.querySelectorAll('button').forEach(button => {
                    button.classList.toggle('active', button.dataset.filter === currentBikeFilter);
                });
            }

            const isBrandNew = currentBikeType === 'brand_new';

            if (bikeAdvancedToggle) {
                bikeAdvancedToggle.classList.toggle('hidden', isBrandNew);
                bikeAdvancedToggle.textContent = showBikeAdvanced ? 'Hide Advanced Filters' : 'Show Advanced Filters';
            }

            if (bikeAdvancedPanel) {
                bikeAdvancedPanel.classList.toggle('hidden', !(showBikeAdvanced && !isBrandNew));
            }

            const advancedFilters = bikeAdvancedFilters || {};
            const hasAdvancedFilters = Object.values(advancedFilters).some(Boolean);

            if (bikeAdvancedReset) {
                bikeAdvancedReset.classList.toggle('hidden', isBrandNew);
                bikeAdvancedReset.disabled = !hasAdvancedFilters;
                bikeAdvancedReset.classList.toggle('opacity-60', !hasAdvancedFilters);
                bikeAdvancedReset.classList.toggle('cursor-not-allowed', !hasAdvancedFilters);
            }

            if (bikeBulkToggle) {
                bikeBulkToggle.classList.toggle('hidden', isBrandNew);
                bikeBulkToggle.textContent = bikeBulkMode ? 'Exit Clearance Selection' : 'Select for Clearance';
                bikeBulkToggle.classList.toggle('bg-amber-500', bikeBulkMode);
                bikeBulkToggle.classList.toggle('text-white', bikeBulkMode);
                bikeBulkToggle.classList.toggle('border-amber-500', bikeBulkMode);
                bikeBulkToggle.classList.toggle('hover:bg-amber-500/90', bikeBulkMode);
                bikeBulkToggle.classList.toggle('bg-amber-100/70', !bikeBulkMode);
                bikeBulkToggle.classList.toggle('text-amber-600', !bikeBulkMode);
                bikeBulkToggle.classList.toggle('border-amber-200', !bikeBulkMode);
            }

            if (bikeFilterProfitMin && bikeFilterProfitMin !== document.activeElement) bikeFilterProfitMin.value = advancedFilters.profitMin ?? '';
            if (bikeFilterProfitMax && bikeFilterProfitMax !== document.activeElement) bikeFilterProfitMax.value = advancedFilters.profitMax ?? '';
            if (bikeFilterDateFrom && bikeFilterDateFrom !== document.activeElement) bikeFilterDateFrom.value = advancedFilters.dateFrom ?? '';
            if (bikeFilterDateTo && bikeFilterDateTo !== document.activeElement) bikeFilterDateTo.value = advancedFilters.dateTo ?? '';
            if (bikeFilterRepairMin && bikeFilterRepairMin !== document.activeElement) bikeFilterRepairMin.value = advancedFilters.repairMin ?? '';
            if (bikeFilterRepairMax && bikeFilterRepairMax !== document.activeElement) bikeFilterRepairMax.value = advancedFilters.repairMax ?? '';

            if (isBrandNew) {
                if (state.ui.showBikeAdvanced) {
                    state.ui.showBikeAdvanced = false;
                }
                if (state.ui.bikeBulkMode || (state.ui.bikeBulkSelection || []).length) {
                    state.ui.bikeBulkMode = false;
                    state.ui.bikeBulkSelection = [];
                    updateBikeBulkFooter();
                }
                bikeFilter.classList.add('hidden');
                bikeSortTrigger.classList.add('hidden');
                bikeSortMenu.classList.add('hidden');
                bikeSearch.placeholder = 'Search by model, customer, showroom...';
                renderBrandNewBikes();
                return;
            }

            bikeFilter.classList.remove('hidden');
            bikeSortTrigger.classList.remove('hidden');
            bikeSearch.placeholder = 'Search by name, plate, or owner...';

            let filteredBikes = state.data.bikes.filter(bike => {
                if (currentBikeFilter === 'sold' && !bike.sold) return false;
                if (currentBikeFilter === 'unsold' && bike.sold) return false;

                if (search) {
                    const plate = (bike.bikeNumberPlate || '').toLowerCase();
                    const owner = (bike.ownerName || '').toLowerCase();
                    const name = (bike.bikeName || '').toLowerCase();
                    if (!plate.includes(search) && !owner.includes(search) && !name.includes(search)) {
                        return false;
                    }
                }
                return true;
            });

            const profitMin = parseNumber(advancedFilters.profitMin);
            const profitMax = parseNumber(advancedFilters.profitMax);
            const repairMin = parseNumber(advancedFilters.repairMin);
            const repairMax = parseNumber(advancedFilters.repairMax);
            const dateFrom = parseDate(advancedFilters.dateFrom);
            const dateTo = parseDate(advancedFilters.dateTo);

            filteredBikes = filteredBikes.filter(bike => {
                const insights = getInsights(bike);

                if (profitMin !== null && insights.profitValue < profitMin) return false;
                if (profitMax !== null && insights.profitValue > profitMax) return false;

                if (dateFrom) {
                    const purchaseDate = bike.purchaseDate ? new Date(bike.purchaseDate) : null;
                    if (!purchaseDate || purchaseDate < dateFrom) return false;
                }

                if (dateTo) {
                    const purchaseDate = bike.purchaseDate ? new Date(bike.purchaseDate) : null;
                    if (!purchaseDate || purchaseDate > dateTo) return false;
                }

                const repairValue = parseFloat(bike.repairPrice || 0);
                if (repairMin !== null && repairValue < repairMin) return false;
                if (repairMax !== null && repairValue > repairMax) return false;

                return true;
            });

            const getSaleValue = (bike) => getInsights(bike).saleValue;
            const getProfitValue = (bike) => getInsights(bike).profitValue;

            filteredBikes.sort((a, b) => {
                switch (currentBikeSort) {
                    case 'az':
                        return (a.bikeName || '').localeCompare(b.bikeName || '');
                    case 'za':
                        return (b.bikeName || '').localeCompare(a.bikeName || '');
                    case 'purchaseHigh':
                        return getBikeCost(b) - getBikeCost(a);
                    case 'purchaseLow':
                        return getBikeCost(a) - getBikeCost(b);
                    case 'saleHigh':
                        return getSaleValue(b) - getSaleValue(a);
                    case 'saleLow':
                        return getSaleValue(a) - getSaleValue(b);
                    case 'profitHigh':
                        return getProfitValue(b) - getProfitValue(a);
                    case 'profitLow':
                        return getProfitValue(a) - getProfitValue(b);
                    case 'dateDesc':
                    default:
                        return new Date(b.createdAt || b.purchaseDate) - new Date(a.createdAt || a.purchaseDate);
                }
            });

            if (filteredBikes.length === 0) {
                bikeList.innerHTML = `<p class="text-gray-500 text-center mt-4">No bikes found.</p>`;
                updateBikeBulkFooter();
                return;
            }

            bikeList.innerHTML = filteredBikes.map(bike => {
                const bikeId = esc(bike.id || '');
                const bikeNameLabel = esc(bike.bikeName || bike.bikeNumberPlate || 'Unknown');
                const bikePlateLabel = esc(bike.bikeNumberPlate || '');
                const ownerNameLabel = esc(bike.ownerName || 'N/A');
                const insights = getInsights(bike);
                const totalCost = insights.totalCost;
                const badges = [];
                let showLogPayment = false;

                if (bike.sold) {
                    if (bike.paymentMode === 'cash') {
                        badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-700">Paid</span>`);
                    } else if (bike.paymentMode === 'credit' && bike.creditInfo) {
                        if ((bike.creditInfo.remaining || 0) > EPSILON) {
                            badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-orange-100 text-orange-800">Credit: ${esc(formatCurrency(bike.creditInfo.remaining))} due</span>`);
                            showLogPayment = true;
                        } else {
                            badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-700">Paid</span>`);
                        }
                    } else if (bike.paymentMode === 'emi' && bike.emiInfo) {
                        if ((bike.emiInfo.installmentsPaid || 0) < (bike.emiInfo.totalInstallments || 0)) {
                            const emiPaid = esc(bike.emiInfo.installmentsPaid || 0);
                            const emiTotal = esc(bike.emiInfo.totalInstallments || 0);
                            badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-blue-100 text-blue-800">EMI: ${emiPaid}/${emiTotal} paid</span>`);
                            showLogPayment = true;
                        } else {
                            badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-700">Paid</span>`);
                        }
                    } else {
                        badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-700">Sold</span>`);
                    }
                } else {
                    badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800">Unsold</span>`);
                }

                if (bike.clearanceSale) {
                    badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-amber-100 text-amber-700">Clearance</span>`);
                }

                if (bike.purchaseDate) {
                    const purchaseDate = new Date(bike.purchaseDate);
                    if (!Number.isNaN(purchaseDate.getTime())) {
                        if (!bike.sold) {
                            const diff = Math.max(0, Math.floor((Date.now() - purchaseDate.getTime()) / dayMs));
                            badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-700">In stock ${esc(diff)}d</span>`);
                        } else if (bike.soldDate) {
                            const soldDate = new Date(bike.soldDate);
                            if (!Number.isNaN(soldDate.getTime())) {
                                const diff = Math.max(0, Math.floor((soldDate.getTime() - purchaseDate.getTime()) / dayMs));
                                badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-700">Sold in ${esc(diff)}d</span>`);
                            }
                        }
                    }
                }

                badges.push(`<span class="text-xs font-semibold px-2 py-0.5 rounded-full ${esc(insights.badgeClass)}">${esc(insights.isActual ? 'Actual Profit' : 'Profit Potential')}: ${esc(formatCurrency(insights.profitValue))}</span>`);

                const selection = state.ui.bikeBulkMode && !bike.sold
                    ? `
                        <label class="flex items-center gap-2 text-[11px] text-gray-600 mt-2">
                            <input type="checkbox" class="bike-clearance-checkbox h-4 w-4 rounded border-gray-300 text-amber-500 focus:ring-amber-500" data-bike-id="${bikeId}" ${bikeBulkSelection.includes(bike.id) ? 'checked' : ''}>
                            Mark for clearance
                        </label>
                    `
                    : '';

                const badgesBlock = badges.length
                    ? `<div class="flex flex-wrap justify-end gap-2">${badges.join('')}</div>`
                    : '';

                const costBreakdown = bike.sold ? `
                        <div class="text-sm space-y-1 pt-2 border-t border-gray-100 mt-2">
                            <p class="flex justify-between">
                                <span>Sale:</span>
                                <span>${esc(formatCurrency(bike.sellingPrice))}</span>
                            </p>
                            <p class="flex justify-between">
                                <span>Cost:</span>
                                <span>${esc(formatCurrency(totalCost))}</span>
                            </p>
                            <p class="flex justify-between font-semibold">
                                <span>Profit:</span>
                                <span class="${insights.profitValue >= 0 ? 'text-green-600' : 'text-red-600'}">${esc(formatCurrency(insights.profitValue))}</span>
                            </p>
                        </div>
                    ` : `
                        <div class="text-sm space-y-1 pt-2 border-t border-gray-100 mt-2">
                            <p class="flex justify-between">
                                <span>Purchase:</span>
                                <span>${esc(formatCurrency(bike.purchasePrice))}</span>
                            </p>
                            <p class="flex justify-between">
                                <span>Repair:</span>
                                <span>${esc(formatCurrency(bike.repairPrice))}</span>
                            </p>
                            <p class="flex justify-between">
                                <span>Total Cost:</span>
                                <span>${esc(formatCurrency(totalCost))}</span>
                            </p>
                            ${insights.saleValue > 0 ? `
                                <p class="flex justify-between">
                                    <span>Target Sale:</span>
                                    <span>${esc(formatCurrency(insights.saleValue))}</span>
                                </p>
                            ` : ''}
                            <p class="flex justify-between font-semibold">
                                <span>Potential Profit:</span>
                                <span class="${insights.profitValue >= 0 ? 'text-green-600' : 'text-red-600'}">${esc(formatCurrency(insights.profitValue))}</span>
                            </p>
                        </div>
                    `;

                const referralBlock = bike.referral ? `
                        <div class="mt-2 pt-2 border-t border-gray-100 text-xs text-gray-600">
                            <p class="font-medium text-gray-700">Reference: ${esc(bike.referral.name || 'N/A')}</p>
                            ${bike.referral.contact ? `<p>Contact: ${esc(bike.referral.contact)}</p>` : ''}
                            ${bike.referral.commission ? `<p>Commission Share: ${esc(formatCurrency(bike.referral.commission))}</p>` : ''}
                        </div>
                    ` : '';

                const ownerPhone = sanitizePhone(bike.ownerContact || '');
                const customerPhone = sanitizePhone(bike.customerContact || '');
                const shareLines = [
                    `Bike: ${bike.bikeName || bike.bikeNumberPlate}`,
                    `Cost: ${formatCurrency(totalCost)}`,
                    bike.sold
                        ? `Sold @ ${formatCurrency(bike.sellingPrice || 0)}`
                        : (insights.saleValue > 0 ? `Target @ ${formatCurrency(insights.saleValue)}` : ''),
                    `${insights.isActual ? 'Actual' : 'Potential'} profit: ${formatCurrency(insights.profitValue)}`
                ].filter(Boolean);
                const shareRecipient = bike.sold ? customerPhone : '';
                const shareHref = esc(`https://wa.me/${shareRecipient}?text=${encodeURIComponent(shareLines.join('\n'))}`);

                const quickActions = [
                    ownerPhone ? `<a href="tel:${ownerPhone}" class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 transition">Call Owner</a>` : '',
                    bike.sold && customerPhone ? `<a href="tel:${customerPhone}" class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-green-50 text-green-600 hover:bg-green-100 transition">Call Customer</a>` : '',
                    `<a href="${shareHref}" target="_blank" rel="noopener noreferrer" class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-emerald-50 text-emerald-600 hover:bg-emerald-100 transition">Share on WhatsApp</a>`
                ].filter(Boolean);

                const quickActionsBlock = quickActions.length
                    ? `<div class="flex flex-wrap gap-2 pt-2 border-t border-dashed border-gray-200 mt-3">${quickActions.join('')}</div>`
                    : '';

                const similarBlock = buildSimilarSection(bike, insights);

                const actionsBlock = `
                    <div class="flex flex-wrap justify-end gap-3 pt-3">
                        ${!bike.sold ? `<button data-action="mark-sold" class="text-green-600 font-medium text-sm">Mark Sold</button>` : ''}
                        ${showLogPayment ? `<button data-action="log-payment" class="text-blue-600 font-medium text-sm">Log Payment</button>` : ''}
                        <button data-action="edit-bike" class="text-blue-500 font-medium text-sm">Edit</button>
                    </div>
                `;

                const cardClasses = `bg-white rounded-xl p-4 shadow-sm space-y-3 ${bike.clearanceSale ? 'border border-amber-300' : ''}`;

                return `
                    <div class="${cardClasses}" data-bike-id="${bikeId}">
                        <div class="flex flex-col gap-2">
                            <div class="flex justify-between items-start gap-3">
                                <div>
                                    <span class="font-semibold text-lg text-gray-800">${bikeNameLabel}</span>
                                    <span class="font-medium text-sm text-gray-500 block">${bikePlateLabel}</span>
                                    <p class="text-gray-600 text-sm">Owner: ${ownerNameLabel}</p>
                                </div>
                                <div class="flex flex-col items-end gap-2">
                                    ${badgesBlock}
                                    ${selection}
                                </div>
                            </div>
                            ${costBreakdown}
                            ${referralBlock}
                            ${similarBlock}
                            ${quickActionsBlock}
                            ${actionsBlock}
                        </div>
                    </div>
                `;
            }).join('');

            updateBikeBulkFooter();
            applyPendingHighlight();
        };
        
        const renderExpensesPage = () => {
            const expenses = state.data.expenses.sort((a, b) => new Date(b.createdAt || b.date) - new Date(a.createdAt || a.date));
            
            if (expenses.length === 0) {
                expenseList.innerHTML = `<p class="text-gray-500 text-center mt-4">No expenses recorded.</p>`;
                return;
            }
            
            expenseList.innerHTML = expenses.map(expense => `
                <div class="bg-white rounded-xl p-4 shadow-sm flex justify-between items-center" data-expense-id="${esc(expense.id || '')}">
                    <div>
                        <p class="font-semibold">${esc(expense.description || '')}</p>
                        <p class="text-sm text-gray-500">${esc(formatDate(expense.date))}</p>
                    </div>
                    <span class="font-bold text-lg text-red-600">- ${esc(formatCurrency(expense.amount))}</span>
                </div>
            `).join('');
        };
        
        const renderPRPage = () => {
            const { currentPRFilter, currentPRSearch } = state.ui;
            const search = currentPRSearch.toLowerCase();

            const filteredPR = state.data.pr.filter(pr => {
                if (currentPRFilter !== 'all' && pr.relationType !== currentPRFilter) return false;
                
                if (search) {
                    const name = pr.name.toLowerCase();
                    const contact = pr.contact.toString().toLowerCase();
                    const bikeName = (pr.relatedBikeName || '').toLowerCase();
                    if (!name.includes(search) && !contact.includes(search) && !bikeName.includes(search)) {
                        return false;
                    }
                }
                return true;
            }).sort((a, b) => a.name.localeCompare(b.name));
            
            if (filteredPR.length === 0) {
                prList.innerHTML = `<p class="text-gray-500 text-center mt-4">No contacts found.</p>`;
                return;
            }
            
            const relationClassMap = {
                Buyer: 'bg-blue-100 text-blue-800',
                Supplier: 'bg-purple-100 text-purple-800',
                Owner: 'bg-amber-100 text-amber-800',
                Other: 'bg-gray-100 text-gray-700'
            };
            
            prList.innerHTML = filteredPR.map(pr => {
                const relationType = pr.relationType || 'Other';
                const relationClass = relationClassMap[relationType] || relationClassMap.Other;
                const relatedBikes = (pr.relatedBikeName || '')
                    .split(',')
                    .map(name => name.trim())
                    .filter((value, index, arr) => value && arr.indexOf(value) === index);
                const contactDigits = sanitizePhone(pr.contact);
                const safeName = esc(pr.name || 'Contact');
                const safeContact = esc(pr.contact || 'N/A');

                const bikeButtons = relatedBikes.length
                    ? relatedBikes.map(name => `
                        <button type="button" class="pr-bike-chip" data-action="pr-go-bike" data-bike-name="${esc(name)}">
                            <i data-lucide="navigation"></i>
                            ${esc(name)}
                        </button>
                    `).join('')
                    : '<span class="text-xs text-gray-400">No linked bikes yet.</span>';

                const baseActions = `
                    ${contactDigits ? `<button type="button" class="pr-action-button" data-action="pr-call" data-contact="${contactDigits}" title="Call">
                        <i data-lucide="phone"></i>
                    </button>` : ''}
                    ${contactDigits ? `<button type="button" class="pr-action-button" data-action="pr-whatsapp" data-contact="${contactDigits}" title="WhatsApp">
                        <i data-lucide="message-circle"></i>
                    </button>` : ''}
                    ${pr.contact ? `<button type="button" class="pr-action-button" data-action="pr-copy" data-contact="${contactDigits}" title="Copy contact">
                        <i data-lucide="copy"></i>
                    </button>` : ''}
                `;

                let relationActions = '';
                if (relationType === 'Buyer') {
                    relationActions += `
                        <button type="button" class="pr-action-button" data-action="pr-log-payment" data-pr-name="${safeName}" title="Log credit payment">
                            <i data-lucide="wallet"></i>
                        </button>
                    `;
                } else if (relationType === 'Supplier') {
                    relationActions += `
                        <button type="button" class="pr-action-button" data-action="pr-filter-supplier" data-pr-name="${safeName}" title="Show supplier bikes">
                            <i data-lucide="filter"></i>
                        </button>
                    `;
                } else if (relationType === 'Owner') {
                    relationActions += `
                        <button type="button" class="pr-action-button" data-action="pr-filter-owner" data-pr-name="${safeName}" title="Show owner bikes">
                            <i data-lucide="target"></i>
                        </button>
                    `;
                }
                
                return `
                <div class="bg-white rounded-xl p-4 shadow-sm" data-pr-id="${esc(pr.id || '')}">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold text-lg">${safeName}</span>
                        <span class="text-xs font-medium px-2 py-0.5 rounded-full ${relationClass}">${esc(relationType)}</span>
                    </div>
                    <p class="text-gray-600 text-sm mt-1">Contact: ${safeContact}</p>
                    <div class="flex flex-wrap gap-2 mt-3">
                        ${bikeButtons}
                    </div>
                    <div class="flex flex-wrap gap-2 mt-3">
                        ${baseActions}
                        ${relationActions}
                    </div>
                </div>
                `;
            }).join('');
        };
        
        const renderSettingsPage = () => {
            if (pinStatus) {
                const lockState = state.security.isUnlocked ? 'unlocked' : 'locked';
                const color = state.security.isUnlocked ? 'text-green-600' : 'text-amber-600';
                pinStatus.innerHTML = `Sensitive data is currently <span class="font-medium ${color}">${lockState}</span>.`;
            }

            // NEW: Update backup mode display
            const backupMode = state.storageMode === 'gist' ? 'GitHub Gist' : 'Local File';
            backupModeDisplay.textContent = backupMode;
        };

        // --- Modal & Form Handling ---
        
        const openModal = (type, data = null) => {
            state.ui.modal = { isOpen: true, type, data };
            
            let title = '';
            let body = '';
            
            const today = formatDate(new Date());
            
            switch (type) {
                case 'addBike':
                    title = 'Add New Bike';
                    body = getBikeFormHTML({ purchaseDate: today });
                    break;
                case 'editBike':
                    title = 'Edit Bike';
                    body = getBikeFormHTML(data);
                    setTimeout(() => addSalesFormListeners(data), 10);
                    break;
                case 'markSold':
                    title = 'Mark Bike as Sold';
                    body = getBikeSaleFormHTML(data);
                    setTimeout(() => addSalesFormListeners(data), 10);
                    break;
                case 'logPayment':
                    title = 'Log Payment';
                    body = getLogPaymentFormHTML(data);
                    setTimeout(() => addLogPaymentListeners(data), 10);
                    break;
                case 'bulkPayments':
                    title = 'Record Bulk Payments';
                    body = getBulkPaymentFormHTML(data);
                    setTimeout(() => addBulkPaymentListeners(data), 10);
                    break;
                case 'addExpense':
                    title = 'Add Expense';
                    body = getExpenseFormHTML({ date: today });
                    break;
                case 'editExpense':
                    title = 'Edit Expense';
                    body = getExpenseFormHTML(data);
                    break;
                case 'addPR':
                    title = 'Add Contact';
                    body = getPRFormHTML({});
                    break;
                case 'editPR':
                    title = 'Edit Contact';
                    body = getPRFormHTML(data);
                    break;
                case 'addBrandNew':
                    title = 'Add Brand New Delivery';
                    body = getBrandNewFormHTML({});
                    setTimeout(() => addBrandNewFormListeners(), 10);
                    break;
                case 'editBrandNew':
                    title = 'Edit Brand New Delivery';
                    body = getBrandNewFormHTML(data);
                    setTimeout(() => addBrandNewFormListeners(), 10);
                    break;
            }
            
            modalTitle.textContent = title;
            modalBody.innerHTML = body;
            
            formModal.classList.remove('hidden');
            refreshIcons();
            setTimeout(() => {
                modalOverlay.classList.add('open');
                modalSheet.classList.add('open');
            }, 10);
        };
        
        const closeModal = () => {
            state.ui.modal = { isOpen: false, type: null, data: null };
            modalOverlay.classList.remove('open');
            modalSheet.classList.remove('open');
            setTimeout(() => {
                formModal.classList.add('hidden');
                modalBody.innerHTML = '';
            }, 300);
        };
        
        const getBikeFormHTML = (bike = {}) => {
            const isEditing = !!bike.id;
            
            return `
            <input type="hidden" id="bike-id" value="${esc(bike.id || '')}">
            <div class="bg-white rounded-xl p-4 space-y-3">
                <h3 class="font-semibold">Bike Details</h3>
                <div>
                    <label class="form-label" for="bike-name">Bike Name *</label>
                    <input type="text" id="bike-name" class="form-input" placeholder="e.g., Pulsar 150" value="${esc(bike.bikeName || '')}">
                </div>
                 <div>
                    <label class="form-label" for="bike-plate">Bike Number Plate *</label>
                    <input type="text" id="bike-plate" class="form-input uppercase" placeholder="GJ01AB1234" value="${esc(bike.bikeNumberPlate || '')}" ${isEditing && bike.sold ? 'readonly' : ''}>
                </div>
            </div>

            <div class="bg-white rounded-xl p-4 space-y-3">
                <h3 class="font-semibold">Purchase Details</h3>
                <div>
                    <label class="form-label" for="bike-owner">Owner Name *</label>
                    <input type="text" id="bike-owner" class="form-input" placeholder="John Doe" value="${esc(bike.ownerName || '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-owner-contact">Owner Contact</label>
                    <input type="tel" id="bike-owner-contact" class="form-input" placeholder="9876543210" value="${esc(bike.ownerContact || '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-supplier">Supplier Name</label>
                    <input type="text" id="bike-supplier" class="form-input" placeholder="Bike Supplier Co." value="${esc(bike.supplierName || '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-supplier-contact">Supplier Contact</label>
                    <input type="tel" id="bike-supplier-contact" class="form-input" placeholder="9876543210" value="${esc(bike.supplierContact || '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-purchase-date">Purchase Date *</label>
                    <input type="date" id="bike-purchase-date" class="form-input" value="${esc(formatDate(bike.purchaseDate))}">
                </div>
                <div>
                    <label class="form-label" for="bike-purchase-price">Purchase Price *</label>
                    <input type="number" id="bike-purchase-price" class="form-input" placeholder="50000" value="${esc(bike.purchasePrice ?? '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-repair-price">Repair Price</label>
                    <input type="number" id="bike-repair-price" class="form-input" placeholder="5000" value="${esc(bike.repairPrice ?? '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-target-price">Target Selling Price</label>
                    <input type="number" id="bike-target-price" class="form-input" placeholder="65000" value="${esc(bike.targetSalePrice ?? '')}">
                    <p class="text-xs text-gray-400 mt-1">Used to estimate profit potential and advanced filters.</p>
                </div>
            </div>

            <div class="bg-white rounded-xl p-4 space-y-3">
                <h3 class="font-semibold">Reference / Agent Commission</h3>
                <p class="text-xs text-gray-500">Track referral partners who shared commission on this purchase.</p>
                <div>
                    <label class="form-label" for="bike-ref-name">Reference Name</label>
                    <input type="text" id="bike-ref-name" class="form-input" placeholder="Agent name" value="${esc(bike.referral?.name || '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-ref-contact">Reference Contact</label>
                    <input type="tel" id="bike-ref-contact" class="form-input" placeholder="Contact number" value="${esc(bike.referral?.contact || '')}">
                </div>
                <div>
                    <label class="form-label" for="bike-ref-commission">Commission Amount</label>
                    <input type="number" id="bike-ref-commission" class="form-input" placeholder="2000" value="${esc(bike.referral?.commission ?? '')}">
                </div>
            </div>
            
            ${isEditing ? getBikeSaleFormHTML(bike) : ''}
            
            ${isEditing ? `
            <div class="mt-4">
                <button id="delete-bike-btn" class="w-full py-3 bg-red-100 text-red-600 rounded-lg font-semibold transition hover:bg-red-200">
                    Delete Bike
                </button>
            </div>
            ` : ''}
            `;
        };
        
        const getBikeSaleFormHTML = (bike = {}) => {
            const today = formatDate(new Date());
            const soldDate = bike.sold ? bike.soldDate : today;
            const creditDueDate = bike.creditInfo ? bike.creditInfo.dueDate : today;
            const emiStartDate = bike.emiInfo ? bike.emiInfo.startDate : today;
            const creditGrace = typeof bike.creditInfo?.gracePeriodDays !== 'undefined'
                ? bike.creditInfo.gracePeriodDays
                : DEFAULT_GRACE_PERIOD_DAYS;
            const creditInterest = typeof bike.creditInfo?.interestRate !== 'undefined'
                ? bike.creditInfo.interestRate
                : '';
            const emiGrace = typeof bike.emiInfo?.gracePeriodDays !== 'undefined'
                ? bike.emiInfo.gracePeriodDays
                : DEFAULT_GRACE_PERIOD_DAYS;
            const emiInterest = typeof bike.emiInfo?.interestRate !== 'undefined'
                ? bike.emiInfo.interestRate
                : '';

            return `
            <div class="bg-white rounded-xl p-4 space-y-3">
                <h3 class="font-semibold">Sales Details ${bike.sold ? `(Sold on ${esc(formatDate(bike.soldDate))})` : ''}</h3>
                
                <div>
                    <label class="form-label" for="sale-customer-name">Customer Name</label>
                    <input type="text" id="sale-customer-name" class="form-input" placeholder="Jane Smith" value="${esc(bike.customerName || '')}">
                </div>
                <div>
                    <label class="form-label" for="sale-customer-contact">Customer Contact</label>
                    <input type="tel" id="sale-customer-contact" class="form-input" placeholder="9876543210" value="${esc(bike.customerContact || '')}">
                </div>
                <div>
                    <label class="form-label" for="sale-total-price">Total Selling Price *</label>
                    <input type="number" id="sale-total-price" class="form-input" placeholder="70000" value="${esc(bike.sellingPrice ?? '')}">
                </div>
                <div>
                    <label class="form-label" for="sale-payment-mode">Payment Mode *</label>
                    <select id="sale-payment-mode" class="form-input">
                        <option value="cash" ${bike.paymentMode === 'cash' ? 'selected' : ''}>Cash</option>
                        <option value="credit" ${bike.paymentMode === 'credit' ? 'selected' : ''}>Credit</option>
                        <option value="emi" ${bike.paymentMode === 'emi' ? 'selected' : ''}>EMI</option>
                    </select>
                </div>

                <!-- Fields for Cash -->
                <div id="sale-cash-fields" class="hidden space-y-3">
                    <div>
                        <label class="form-label" for="sale-cash-received">Amount Received</label>
                        <input type="number" id="sale-cash-received" class="form-input bg-gray-200" readonly value="${esc(bike.sellingPrice ?? '')}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-cash-date">Payment Date *</label>
                        <input type="date" id="sale-cash-date" class="form-input" value="${esc(formatDate(soldDate))}">
                    </div>
                </div>

                <!-- Fields for Credit -->
                <div id="sale-credit-fields" class="hidden space-y-3">
                    <div>
                        <label class="form-label" for="sale-credit-initial">Initial Payment *</label>
                        <input type="number" id="sale-credit-initial" class="form-input" placeholder="50000" value="${esc((bike.creditInfo && bike.creditInfo.initialPayment) ?? '')}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-credit-remaining">Remaining Amount</label>
                        <input type="number" id="sale-credit-remaining" class="form-input bg-gray-200" readonly placeholder="20000" value="${esc((bike.creditInfo && bike.creditInfo.remaining) ?? '')}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-credit-due-date">Remaining Due Date *</label>
                        <input type="date" id="sale-credit-due-date" class="form-input" value="${esc(formatDate(creditDueDate))}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-credit-grace">Grace Period (days)</label>
                        <input type="number" id="sale-credit-grace" class="form-input" min="0" value="${esc(creditGrace)}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-credit-interest">Interest Rate (% per month)</label>
                        <input type="number" id="sale-credit-interest" class="form-input" min="0" step="0.1" value="${esc(creditInterest)}">
                        <p class="text-xs text-gray-400 mt-1">Used to suggest interest once the grace period ends.</p>
                    </div>
                </div>

                <!-- Fields for EMI -->
                <div id="sale-emi-fields" class="hidden space-y-3">
                    <div>
                        <label class="form-label" for="sale-emi-downpayment">Down Payment *</label>
                        <input type="number" id="sale-emi-downpayment" class="form-input" placeholder="30000" value="${esc((bike.emiInfo && bike.emiInfo.downPayment) ?? '')}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-emi-monthly">Monthly EMI Amount *</label>
                        <input type="number" id="sale-emi-monthly" class="form-input" placeholder="5000" value="${esc((bike.emiInfo && bike.emiInfo.monthlyAmount) ?? '')}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-emi-installments">Number of Installments *</label>
                        <input type="number" id="sale-emi-installments" class="form-input" placeholder="12" value="${esc((bike.emiInfo && bike.emiInfo.totalInstallments) ?? '')}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-emi-start-date">EMI Start Date *</label>
                        <input type="date" id="sale-emi-start-date" class="form-input" value="${esc(formatDate(emiStartDate))}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-emi-grace">Grace Period (days)</label>
                        <input type="number" id="sale-emi-grace" class="form-input" min="0" value="${esc(emiGrace)}">
                    </div>
                    <div>
                        <label class="form-label" for="sale-emi-interest">Interest Rate (% per month)</label>
                        <input type="number" id="sale-emi-interest" class="form-input" min="0" step="0.1" value="${esc(emiInterest)}">
                        <p class="text-xs text-gray-400 mt-1">Applied on overdue EMIs after the grace period.</p>
                    </div>
                </div>
            </div>
            `;
        };
        
        const getBrandNewFormHTML = (delivery = {}) => {
            const referrers = (delivery.commissionToGive || []).map(ref => `
                <div class="brand-referrer-item flex items-center justify-between bg-blue-50 rounded-lg p-3" 
                    data-ref-id="${esc(ref.id || crypto.randomUUID())}"
                    data-ref-name="${esc(ref.referrerName || ref.referrer_name || '')}"
                    data-ref-contact="${esc(ref.referrerContact || ref.referrer_contact || '')}"
                    data-ref-amount="${esc(ref.commissionAmount ?? ref.commission_amount ?? 0)}"
                    data-status="${esc(ref.paymentStatus || ref.payment_status || 'pending')}">
                    <div>
                        <p class="font-semibold text-gray-800">${esc(ref.referrerName || ref.referrer_name || 'Referrer')}</p>
                        ${(ref.referrerContact || ref.referrer_contact) ? `<p class="text-xs text-gray-500">${esc(ref.referrerContact || ref.referrer_contact)}</p>` : ''}
                        <p class="text-sm font-medium text-gray-700 mt-1">${esc(formatCurrency(ref.commissionAmount || ref.commission_amount || 0))}</p>
                    </div>
                    <div class="flex flex-col items-end gap-2">
                        <select class="brand-referrer-status form-input !py-1 !px-2 !w-auto">
                            <option value="pending" ${(ref.paymentStatus || ref.payment_status) !== 'paid' ? 'selected' : ''}>Pending</option>
                            <option value="paid" ${(ref.paymentStatus || ref.payment_status) === 'paid' ? 'selected' : ''}>Paid</option>
                        </select>
                        <button type="button" class="brand-referrer-remove text-xs text-red-500 font-semibold">Remove</button>
                    </div>
                </div>
            `).join('');

            return `
            <input type="hidden" id="brand-delivery-id" value="${esc(delivery.id || '')}">
            <div class="bg-white rounded-xl p-4 space-y-3">
                <h3 class="font-semibold text-gray-800">Delivery Details</h3>
                <div>
                    <label class="form-label" for="brand-bike-model">Bike Model *</label>
                    <input type="text" id="brand-bike-model" class="form-input" placeholder="e.g., Pulsar 150" value="${esc(delivery.bikeModel || '')}">
                </div>
                <div>
                    <label class="form-label" for="brand-delivery-date">Delivery Date *</label>
                    <input type="date" id="brand-delivery-date" class="form-input" value="${esc(formatDate(delivery.deliveryDate) || formatDate(new Date()))}">
                </div>
                <div>
                    <label class="form-label" for="brand-commission-received">Commission Received *</label>
                    <input type="number" id="brand-commission-received" class="form-input" placeholder="5000" value="${esc(delivery.commissionReceived ?? '')}">
                </div>
                <div>
                    <label class="form-label" for="brand-invoice-number">Invoice Number</label>
                    <input type="text" id="brand-invoice-number" class="form-input" placeholder="Optional invoice reference" value="${esc(delivery.invoiceNumber || '')}">
                </div>
                <div>
                    <label class="form-label" for="brand-notes">Notes</label>
                    <textarea id="brand-notes" class="form-input" rows="3" placeholder="Additional notes...">${esc(delivery.notes || '')}</textarea>
                </div>
            </div>

            <div class="bg-white rounded-xl p-4 space-y-3">
                <h3 class="font-semibold text-gray-800">Customer & Showroom</h3>
                <div>
                    <label class="form-label" for="brand-customer-name">Customer Name *</label>
                    <input type="text" id="brand-customer-name" class="form-input" placeholder="Customer name" value="${esc(delivery.customerName || '')}">
                </div>
                <div>
                    <label class="form-label" for="brand-customer-contact">Customer Contact</label>
                    <input type="tel" id="brand-customer-contact" class="form-input" placeholder="9876543210" value="${esc(delivery.customerContact || '')}">
                </div>
                <div>
                    <label class="form-label" for="brand-showroom-name">Showroom Name *</label>
                    <input type="text" id="brand-showroom-name" class="form-input" placeholder="Showroom or partner" value="${esc(delivery.showroomName || '')}">
                </div>
            </div>

            <div class="bg-white rounded-xl p-4 space-y-3">
                <div class="flex items-center justify-between">
                    <h3 class="font-semibold text-gray-800">Referrer Commissions</h3>
                    <button type="button" id="brand-add-referrer" class="text-blue-500 text-sm font-semibold">Add Referrer</button>
                </div>
                <div id="brand-referrer-list" class="space-y-3">
                    ${referrers || '<p class="text-sm text-gray-500">No referrers added yet.</p>'}
                </div>
                <div class="bg-gray-50 rounded-lg p-3 space-y-2">
                    <div>
                        <label class="form-label" for="brand-ref-name">Referrer Name</label>
                        <input type="text" id="brand-ref-name" class="form-input" placeholder="Agent or partner name">
                    </div>
                    <div>
                        <label class="form-label" for="brand-ref-contact">Referrer Contact</label>
                        <input type="tel" id="brand-ref-contact" class="form-input" placeholder="Contact (optional)">
                    </div>
                    <div>
                        <label class="form-label" for="brand-ref-amount">Commission Amount</label>
                        <input type="number" id="brand-ref-amount" class="form-input" placeholder="Commission amount">
                    </div>
                </div>
            </div>
            `;
        };
        
        const getLogPaymentFormHTML = (bike = {}) => {
            const bikeName = bike.bikeName || bike.bikeNumberPlate;
            const dueMeta = getDueMetadata(bike);
            const statusClassMap = {
                clear: 'bg-green-100 text-green-700',
                upcoming: 'bg-blue-100 text-blue-700',
                dueToday: 'bg-amber-100 text-amber-700',
                grace: 'bg-amber-100 text-amber-700',
                overdue: 'bg-red-100 text-red-700'
            };
            const statusClass = statusClassMap[dueMeta.status] || 'bg-gray-100 text-gray-600';

            let expectedPrincipal = 0;
            let paymentType = '';
            let planDetails = '';
            let emiFinalCheckbox = '';

            if (bike.paymentMode === 'credit' && bike.creditInfo) {
                expectedPrincipal = Math.max(0, Math.round(bike.creditInfo.remaining || 0));
                paymentType = 'Credit Payment';
                planDetails = `
                    <p class="text-sm text-gray-600">
                        Remaining Due: <span class="font-medium">${esc(formatCurrency(bike.creditInfo.remaining || 0))}</span>
                    </p>
                `;
            } else if (bike.paymentMode === 'emi' && bike.emiInfo) {
                expectedPrincipal = Math.max(0, Math.round(bike.emiInfo.monthlyAmount || 0));
                paymentType = 'EMI Payment';
                const emiLeft = dueMeta.installmentsLeft;
                const totalRemaining = emiLeft * (bike.emiInfo.monthlyAmount || 0);
                planDetails = `
                    <p class="text-sm text-gray-600">
                        EMIs Left: <span class="font-medium">${esc(bike.emiInfo.installmentsPaid || 0)}/${esc(bike.emiInfo.totalInstallments || 0)}</span>  
                        Monthly: <span class="font-medium">${esc(formatCurrency(bike.emiInfo.monthlyAmount || 0))}</span>
                    </p>
                    <p class="text-xs text-gray-500">Estimated remaining: ${esc(formatCurrency(totalRemaining))}</p>
                `;
                emiFinalCheckbox = `
                    <div class="flex items-center mt-3">
                        <input type="checkbox" id="payment-emi-final" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                        <label for="payment-emi-final" class="ml-2 block text-sm text-gray-700">Log as Final Settlement?</label>
                    </div>
                `;
            }

            const dueInfo = dueMeta.pendingPrincipal > EPSILON
                ? `
                    <div class="flex items-center justify-between text-xs mt-2">
                        <span class="text-gray-500">Due ${dueMeta.dueDate ? esc(formatDate(dueMeta.dueDate)) : 'Not scheduled'}</span>
                        <span class="px-2 py-0.5 rounded-full font-medium ${statusClass}">${esc(dueMeta.statusLabel)}</span>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">Grace: ${esc(dueMeta.graceDays)} day${dueMeta.graceDays === 1 ? '' : 's'}  Interest: ${esc(dueMeta.interestRate || 0)}% / month</p>
                `
                : '<p class="text-xs text-green-600 mt-2">All dues cleared.</p>';

            const suggestedInterest = dueMeta.suggestedInterest || 0;
            const interestFieldValue = suggestedInterest > 0 ? suggestedInterest : '';
            const interestDisplay = suggestedInterest > 0
                ? `Suggested: ${esc(formatCurrency(suggestedInterest))}`
                : 'No additional interest suggested';

            return `
                <input type="hidden" id="payment-bike-id" value="${esc(bike.id || '')}">
                <div class="bg-white rounded-xl p-4 space-y-2">
                    <p class="text-lg font-semibold">${esc(bikeName)}</p>
                    <p class="text-gray-600">Customer: ${esc(bike.customerName || 'N/A')}</p>
                    ${planDetails}
                    ${dueInfo}
                </div>
                <div class="bg-white rounded-xl p-4 space-y-3">
                    <h3 class="font-semibold">Log New Payment</h3>
                    <div>
                        <label class="form-label" for="payment-amount">Principal Amount *</label>
                        <input type="number" id="payment-amount" class="form-input" value="${esc(expectedPrincipal || '')}" ${paymentType === 'EMI Payment' ? 'readonly' : ''}>
                    </div>
                    <div>
                        <label class="form-label" for="payment-interest">Interest Amount</label>
                        <input type="number" id="payment-interest" class="form-input" min="0" value="${esc(interestFieldValue)}">
                        <p class="text-xs text-gray-400 mt-1">${interestDisplay}</p>
                    </div>
                    ${emiFinalCheckbox}
                    <div>
                        <label class="form-label" for="payment-date">Payment Date *</label>
                        <input type="date" id="payment-date" class="form-input" value="${esc(formatDate(new Date()))}">
                    </div>
                    <div>
                        <label class="form-label" for="payment-type">Payment Type</label>
                        <input type="text" id="payment-type" class="form-input bg-gray-200" readonly value="${esc(paymentType)}">
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3 flex justify-between items-center">
                        <span class="text-sm text-gray-600">Total (principal + interest)</span>
                        <span id="payment-total-display" class="text-base font-semibold text-gray-900">${esc(formatCurrency((expectedPrincipal || 0) + (suggestedInterest || 0)))}</span>
                    </div>
                </div>
            `;
        };
        
        const getBulkPaymentFormHTML = (records = []) => {
            if (!Array.isArray(records) || records.length === 0) {
                return `
                    <div class="bg-white rounded-xl p-4 text-sm text-gray-500">
                        No customers selected for bulk payment.
                    </div>
                `;
            }

            const today = formatDate(new Date());
            let totalDefault = 0;

            const rows = records.map((record, index) => {
                const suggestedPrincipal = Math.max(0, getBulkSuggestedAmount(record));
                const suggestedInterest = record.overdueInterest > 0 ? record.overdueInterest : 0;
                totalDefault += suggestedPrincipal + suggestedInterest;
                const rowId = `${record.bikeId || index}`;
                const statusBadge = record.dueMeta?.statusLabel || 'Status';
                const statusClass = record.dueMeta?.status
                    ? (record.dueMeta.status === 'overdue'
                        ? 'bg-red-100 text-red-700'
                        : record.dueMeta.status === 'grace'
                            ? 'bg-amber-100 text-amber-700'
                            : 'bg-blue-100 text-blue-700')
                    : 'bg-gray-100 text-gray-600';

                return `
                    <div class="border border-gray-200 rounded-lg p-3 space-y-3" data-bulk-id="${record.bikeId}">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-semibold text-gray-900">${record.customerName}</p>
                                <p class="text-xs text-gray-500">${record.bikeName}</p>
                            </div>
                            <span class="text-xs font-medium px-2 py-0.5 rounded-full ${statusClass}">
                                ${statusBadge}
                            </span>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs text-gray-500">
                            <div>Pending: <span class="font-semibold text-gray-700">${formatCurrency(record.pendingAmount)}</span></div>
                            <div>Mode: <span class="font-semibold text-gray-700">${record.paymentMode === 'emi' ? 'EMI' : 'Credit'}</span></div>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <div>
                                <label class="form-label" for="bulk-principal-${rowId}">Principal</label>
                                <input type="number" min="0" id="bulk-principal-${rowId}" class="form-input bulk-principal" data-bulk-id="${record.bikeId}" value="${suggestedPrincipal}">
                            </div>
                            <div>
                                <label class="form-label" for="bulk-interest-${rowId}">Interest</label>
                                <input type="number" min="0" id="bulk-interest-${rowId}" class="form-input bulk-interest" data-bulk-id="${record.bikeId}" value="${suggestedInterest || ''}">
                            </div>
                        </div>
                        ${record.paymentMode === 'emi' ? `
                            <label class="flex items-center gap-2 text-xs text-gray-600 select-none">
                                <input type="checkbox" class="bulk-final h-4 w-4 text-blue-600 border-gray-300 rounded" data-bulk-id="${record.bikeId}">
                                Mark as final settlement
                            </label>
                        ` : ''}
                    </div>
                `;
            }).join('');

            return `
                <div class="bg-white rounded-xl p-4 space-y-4">
                    <div>
                        <label class="form-label" for="bulk-payment-date">Payment Date *</label>
                        <input type="date" id="bulk-payment-date" class="form-input" value="${today}">
                    </div>
                    <div id="bulk-payment-list" class="space-y-3">
                        ${rows}
                    </div>
                    <div class="bg-gray-100 rounded-lg p-3 flex justify-between items-center text-sm">
                        <span id="bulk-summary-count">${records.length} customer${records.length === 1 ? '' : 's'}</span>
                        <span id="bulk-summary-total" class="font-semibold text-gray-900">${formatCurrency(totalDefault)}</span>
                    </div>
                    <p class="text-xs text-gray-500">
                        Adjust principal or interest amounts if needed. Interest entries are logged separately and do not reduce principal.
                    </p>
                </div>
            `;
        };

        const addBulkPaymentListeners = (records = []) => {
            const listContainer = $('#bulk-payment-list');
            const summaryCount = $('#bulk-summary-count');
            const summaryTotal = $('#bulk-summary-total');

            if (!listContainer) return;

            const updateSummary = () => {
                let totalPrincipal = 0;
                let totalInterest = 0;
                records.forEach(record => {
                    const principalInput = listContainer.querySelector(`.bulk-principal[data-bulk-id="${record.bikeId}"]`);
                    const interestInput = listContainer.querySelector(`.bulk-interest[data-bulk-id="${record.bikeId}"]`);
                    const principal = parseFloat(principalInput?.value || '0') || 0;
                    const interest = parseFloat(interestInput?.value || '0') || 0;
                    totalPrincipal += Math.max(0, principal);
                    totalInterest += Math.max(0, interest);
                });
                if (summaryCount) {
                    summaryCount.textContent = `${records.length} customer${records.length === 1 ? '' : 's'}`;
                }
                if (summaryTotal) {
                    summaryTotal.textContent = formatCurrency(totalPrincipal + totalInterest);
                }
            };

            listContainer.addEventListener('input', (event) => {
                const target = event.target;
                if (!target) return;
                if (target.classList.contains('bulk-principal') || target.classList.contains('bulk-interest')) {
                    if (parseFloat(target.value) < 0) {
                        target.value = '0';
                    }
                    updateSummary();
                }
            });

            listContainer.addEventListener('change', (event) => {
                const checkbox = event.target;
                if (!checkbox || !checkbox.classList.contains('bulk-final')) return;
                const bikeId = checkbox.dataset.bulkId;
                const record = records.find(item => item.bikeId === bikeId);
                if (!record) return;
                const principalInput = listContainer.querySelector(`.bulk-principal[data-bulk-id="${bikeId}"]`);
                if (!principalInput) return;
                if (checkbox.checked) {
                    principalInput.value = record.pendingAmount;
                } else {
                    principalInput.value = getBulkSuggestedAmount(record);
                }
                updateSummary();
            });

            updateSummary();
        };
        
        const getExpenseFormHTML = (expense = {}) => {
            return `
            <input type="hidden" id="expense-id" value="${expense.id || ''}">
            <div class="bg-white rounded-xl p-4 space-y-3">
                <div>
                    <label class="form-label" for="expense-desc">Description *</label>
                    <input type="text" id="expense-desc" class="form-input" placeholder="Office rent" value="${expense.description || ''}">
                </div>
                <div>
                    <label class="form-label" for="expense-amount">Amount *</label>
                    <input type="number" id="expense-amount" class="form-input" placeholder="5000" value="${expense.amount || ''}">
                </div>
                <div>
                    <label class="form-label" for="expense-date">Date *</label>
                    <input type="date" id="expense-date" class="form-input" value="${formatDate(expense.date)}">
                </div>
            </div>
            `;
        };
        
        const getPRFormHTML = (pr = {}) => {
            return `
            <input type="hidden" id="pr-id" value="${pr.id || ''}">
            <div class="bg-white rounded-xl p-4 space-y-3">
                <div>
                    <label class="form-label" for="pr-name">Name *</label>
                    <input type="text" id="pr-name" class="form-input" placeholder="Contact Name" value="${pr.name || ''}">
                </div>
                <div>
                    <label class="form-label" for="pr-contact">Contact *</label>
                    <input type="tel" id="pr-contact" class="form-input" placeholder="9876543210" value="${pr.contact || ''}">
                </div>
                <div>
                    <label class="form-label" for="pr-type">Relation Type *</label>
                    <select id="pr-type" class="form-input">
                        <option value="Buyer" ${pr.relationType === 'Buyer' ? 'selected' : ''}>Buyer</option>
                        <option value="Supplier" ${pr.relationType === 'Supplier' ? 'selected' : ''}>Supplier</option>
                    </select>
                </div>
                <div>
                    <label class="form-label" for="pr-bike-name">Related Bike</label>
                    <input type="text" id="pr-bike-name" class="form-input" placeholder="e.g., Pulsar 150" value="${pr.relatedBikeName || ''}">
                </div>
            </div>
            `;
        };
        
        const addSalesFormListeners = (bike = {}) => {
            const paymentMode = $('#sale-payment-mode');
            const totalPrice = $('#sale-total-price');
            
            const cashFields = $('#sale-cash-fields');
            const cashReceived = $('#sale-cash-received');
            
            const creditFields = $('#sale-credit-fields');
            const creditInitial = $('#sale-credit-initial');
            const creditRemaining = $('#sale-credit-remaining');
            
            const emiFields = $('#sale-emi-fields');

            const toggleFields = () => {
                const mode = paymentMode.value;
                cashFields.classList.toggle('hidden', mode !== 'cash');
                creditFields.classList.toggle('hidden', mode !== 'credit');
                emiFields.classList.toggle('hidden', mode !== 'emi');
                updateCalculations();
            };
            
            const updateCalculations = () => {
                const total = parseFloat(totalPrice.value) || 0;
                cashReceived.value = total;
                const initial = parseFloat(creditInitial.value) || 0;
                creditRemaining.value = total - initial;
            };

            paymentMode.addEventListener('change', toggleFields);
            totalPrice.addEventListener('input', updateCalculations);
            creditInitial.addEventListener('input', updateCalculations);

            const deleteBtn = $('#delete-bike-btn');
            if (deleteBtn) {
                deleteBtn.addEventListener('click', () => handleDeleteBike(bike.id));
            }
            
            toggleFields();
        };

        const addLogPaymentListeners = (bike = {}) => {
            const amountInput = $('#payment-amount');
            const interestInput = $('#payment-interest');
            const totalDisplay = $('#payment-total-display');

            const updateTotal = () => {
                if (!totalDisplay) return;
                const principal = parseFloat(amountInput?.value || '0') || 0;
                const interest = parseFloat(interestInput?.value || '0') || 0;
                totalDisplay.textContent = formatCurrency(principal + interest);
            };

            amountInput?.addEventListener('input', updateTotal);
            interestInput?.addEventListener('input', updateTotal);
            updateTotal();

            if (bike.paymentMode === 'emi' && bike.emiInfo) {
                const finalCheckbox = $('#payment-emi-final');
                if (!finalCheckbox || !amountInput) return;

                finalCheckbox.addEventListener('change', () => {
                    if (finalCheckbox.checked) {
                        const emiLeft = (bike.emiInfo.totalInstallments || 0) - (bike.emiInfo.installmentsPaid || 0);
                        const totalRemaining = emiLeft * (bike.emiInfo.monthlyAmount || 0);
                        amountInput.value = totalRemaining;
                        amountInput.readOnly = false;
                    } else {
                        amountInput.value = bike.emiInfo.monthlyAmount || 0;
                        amountInput.readOnly = true;
                    }
                    updateTotal();
                });
            }
        };
        
        const addBrandNewFormListeners = () => {
            const addButton = $('#brand-add-referrer');
            const listContainer = $('#brand-referrer-list');
            const nameInput = $('#brand-ref-name');
            const contactInput = $('#brand-ref-contact');
            const amountInput = $('#brand-ref-amount');

            if (!addButton || !listContainer) return;

            const ensurePlaceholder = () => {
                if (!listContainer.querySelector('.brand-referrer-item')) {
                    listContainer.innerHTML = '<p class="text-sm text-gray-500">No referrers added yet.</p>';
                }
            };

            const createReferrerItem = ({ id, name, contact, amount, status }) => {
                const wrapper = document.createElement('div');
                wrapper.className = 'brand-referrer-item flex items-center justify-between bg-blue-50 rounded-lg p-3';
                wrapper.dataset.refId = id || crypto.randomUUID();
                wrapper.dataset.refName = name;
                wrapper.dataset.refContact = contact;
                wrapper.dataset.refAmount = amount;
                wrapper.dataset.status = status || 'pending';
                wrapper.innerHTML = `
                    <div>
                        <p class="font-semibold text-gray-800">${name}</p>
                        ${contact ? `<p class="text-xs text-gray-500">${contact}</p>` : ''}
                        <p class="text-sm font-medium text-gray-700 mt-1">${formatCurrency(parseFloat(amount) || 0)}</p>
                    </div>
                    <div class="flex flex-col items-end gap-2">
                        <select class="brand-referrer-status form-input !py-1 !px-2 !w-auto">
                            <option value="pending" ${status !== 'paid' ? 'selected' : ''}>Pending</option>
                            <option value="paid" ${status === 'paid' ? 'selected' : ''}>Paid</option>
                        </select>
                        <button type="button" class="brand-referrer-remove text-xs text-red-500 font-semibold">Remove</button>
                    </div>
                `;
                return wrapper;
            };

            addButton.addEventListener('click', () => {
                const name = (nameInput?.value || '').trim();
                const contact = (contactInput?.value || '').trim();
                const amountValue = parseFloat(amountInput?.value || '0');

                if (!name) {
                    showToast('Referrer name is required.', true);
                    return;
                }
                if (isNaN(amountValue) || amountValue <= 0) {
                    showToast('Commission amount must be greater than 0.', true);
                    return;
                }

                if (!listContainer.querySelector('.brand-referrer-item')) {
                    listContainer.innerHTML = '';
                }

                const item = createReferrerItem({
                    id: crypto.randomUUID(),
                    name,
                    contact,
                    amount: amountValue,
                    status: 'pending'
                });
                listContainer.appendChild(item);

                nameInput.value = '';
                contactInput.value = '';
                amountInput.value = '';
            });

            listContainer.addEventListener('click', (event) => {
                const target = event.target;
                if (target && target.classList.contains('brand-referrer-remove')) {
                    const item = target.closest('.brand-referrer-item');
                    item?.remove();
                    ensurePlaceholder();
                }
            });

            listContainer.addEventListener('change', (event) => {
                const select = event.target;
                if (select && select.classList.contains('brand-referrer-status')) {
                    const item = select.closest('.brand-referrer-item');
                    if (item) {
                        item.dataset.status = select.value;
                    }
                }
            });

            ensurePlaceholder();
        };
        
        const handleDeleteBike = async (bikeId) => {
            const confirmed = await showConfirm(
                'Delete this bike?',
                'This will permanently delete this bike and all its associated sales and payment logs. This action cannot be undone.'
            );
            
            if (confirmed) {
                try {
                    state.data.bikes = state.data.bikes.filter(b => b.id !== bikeId);
                    state.data.payments = state.data.payments.filter(p => p.bikeId !== bikeId);
                    
                    showToast('Bike deleted successfully.');
                    closeModal();
                    render();
                    saveData();
                } catch (error) {
                    showToast(`Error: ${error.message}`, true);
                }
            }
        };

        const handleDeleteBrandNew = async (deliveryId) => {
            const confirmed = await showConfirm(
                'Delete this delivery?',
                'This will permanently delete this brand new delivery record. This action cannot be undone.'
            );
            if (!confirmed) return;

            try {
                state.data.brandNewDeliveries = (state.data.brandNewDeliveries || []).filter(delivery => delivery.id !== deliveryId);
                showToast('Brand new delivery deleted.');
                closeModal();
                render();
                saveData();
            } catch (error) {
                showToast(`Error: ${error.message}`, true);
            }
        };

        const toggleBrandNewCommissionStatus = (deliveryId, refId) => {
            const delivery = (state.data.brandNewDeliveries || []).find(entry => entry.id === deliveryId);
            if (!delivery) {
                showToast('Delivery not found.', true);
                return;
            }
            const ref = (delivery.commissionToGive || []).find(entry => entry.id === refId);
            if (!ref) {
                showToast('Referrer not found.', true);
                return;
            }
            ref.paymentStatus = ref.paymentStatus === 'paid' ? 'pending' : 'paid';
            showToast(`Referrer marked as ${ref.paymentStatus}.`);
            render();
            saveData();
        };

        const summarizeCreditRecords = () => {
            const creditBikes = (state.data.bikes || []).filter(bike => bike.sold && (bike.paymentMode === 'credit' || bike.paymentMode === 'emi'));
            if (!creditBikes.length) {
                return {
                    records: [],
                    totals: {
                        totalCredit: 0,
                        collected: 0,
                        pending: 0,
                        activeCustomers: 0
                    }
                };
            }

            const creditIds = new Set(creditBikes.map(b => b.id));
            const paymentsByBike = new Map();
            let collected = 0;

            (state.data.payments || []).forEach(payment => {
                if (!creditIds.has(payment.bikeId)) return;
                const list = paymentsByBike.get(payment.bikeId) || [];
                list.push(payment);
                paymentsByBike.set(payment.bikeId, list);
                collected += payment.amount || 0;
            });

            const totalCredit = creditBikes.reduce((sum, bike) => sum + (bike.sellingPrice || 0), 0);

            const records = creditBikes.map(bike => {
                const payments = (paymentsByBike.get(bike.id) || []).slice().sort((a, b) => new Date(b.date) - new Date(a.date));
                const totalPaid = payments.reduce((sum, payment) => sum + (payment.amount || 0), 0);
                const dueMeta = getDueMetadata(bike);
                const totalPrincipal = bike.sellingPrice || 0;
                const progressPercent = totalPrincipal > EPSILON
                    ? Math.min(100, Math.round((totalPaid / totalPrincipal) * 100))
                    : 0;

                let nextDueText = 'Paid in full';
                let initialPayment = 0;
                let monthlyAmount = 0;
                let installmentsPaid = 0;
                let totalInstallments = 0;
                let overdueInterest = dueMeta.status === 'overdue' ? dueMeta.suggestedInterest : 0;

                if (bike.paymentMode === 'credit' && bike.creditInfo) {
                    initialPayment = bike.creditInfo.initialPayment || 0;
                    nextDueText = dueMeta.pendingPrincipal > EPSILON
                        ? (dueMeta.dueDate ? `Due ${formatDate(dueMeta.dueDate)}  ${dueMeta.statusLabel}` : dueMeta.statusLabel)
                        : 'All dues cleared';
                } else if (bike.paymentMode === 'emi' && bike.emiInfo) {
                    monthlyAmount = bike.emiInfo.monthlyAmount || 0;
                    installmentsPaid = bike.emiInfo.installmentsPaid || 0;
                    totalInstallments = bike.emiInfo.totalInstallments || 0;
                    initialPayment = bike.emiInfo.downPayment || 0;
                    nextDueText = dueMeta.pendingPrincipal > EPSILON
                        ? (dueMeta.dueDate ? `Next EMI ${formatDate(dueMeta.dueDate)}  ${dueMeta.statusLabel}` : `EMI pending  ${dueMeta.statusLabel}`)
                        : 'All EMIs completed';
                }

                return {
                    bikeId: bike.id,
                    customerName: bike.customerName || 'Customer',
                    contact: bike.customerContact || 'N/A',
                    phoneHref: sanitizePhone(bike.customerContact || ''),
                    bikeName: bike.bikeName || bike.bikeNumberPlate,
                    bikeNumberPlate: bike.bikeNumberPlate,
                    salePrice: totalPrincipal,
                    paymentMode: bike.paymentMode,
                    pendingAmount: dueMeta.pendingPrincipal,
                    nextDueText,
                    dueDate: dueMeta.dueDate,
                    initialPayment,
                    monthlyAmount,
                    installmentsPaid,
                    totalInstallments,
                    payments,
                    totalPaid,
                    progressPercent,
                    dueMeta,
                    overdueInterest
                };
            });

            const totals = {
                totalCredit,
                collected,
                pending: records.reduce((sum, record) => sum + record.pendingAmount, 0),
                activeCustomers: records.filter(record => record.pendingAmount > EPSILON).length
            };

            return { records, totals };
        };

        const applyPaymentForBike = ({ bike, principalAmount, interestAmount, isoDate, isEMIFinal = false, paymentTypeHint = 'Payment' }) => {
            if (!bike) throw new Error('Bike not found.');
            if (!isoDate) throw new Error('Payment date is required.');
            if (principalAmount < 0 || interestAmount < 0) throw new Error('Amounts cannot be negative.');
            if (principalAmount <= 0 && interestAmount <= 0) throw new Error('Enter the principal or interest amount to continue.');

            let paymentType = paymentTypeHint || 'Payment';
            const payments = [];

            if (bike.paymentMode === 'credit' && bike.creditInfo) {
                if (principalAmount > 0) {
                    if (principalAmount > bike.creditInfo.remaining + EPSILON) {
                        throw new Error('Payment cannot be greater than remaining balance.');
                    }
                    if (principalAmount >= bike.creditInfo.remaining - EPSILON) {
                        paymentType = 'Final Credit Payment';
                        bike.creditInfo.remaining = 0;
                    } else {
                        bike.creditInfo.remaining -= principalAmount;
                    }
                }
            } else if (bike.paymentMode === 'emi' && bike.emiInfo) {
                if (isEMIFinal) {
                    if (principalAmount <= 0) {
                        throw new Error('Principal amount is required for final settlement.');
                    }
                    const emiLeft = (bike.emiInfo.totalInstallments || 0) - (bike.emiInfo.installmentsPaid || 0);
                    const totalRemaining = emiLeft * (bike.emiInfo.monthlyAmount || 0);
                    if (principalAmount > totalRemaining + EPSILON) {
                        throw new Error('Settlement cannot be greater than total remaining balance.');
                    }
                    paymentType = 'Final EMI Installment';
                    bike.emiInfo.installmentsPaid = bike.emiInfo.totalInstallments;
                    bike.emiInfo.nextDueDate = null;
                } else if (principalAmount > 0) {
                    if (principalAmount > (bike.emiInfo.monthlyAmount || 0) + EPSILON) {
                        throw new Error('Payment cannot be greater than monthly EMI amount.');
                    }
                    bike.emiInfo.installmentsPaid = (bike.emiInfo.installmentsPaid || 0) + 1;
                    if (bike.emiInfo.installmentsPaid >= bike.emiInfo.totalInstallments) {
                        paymentType = 'Final EMI Installment';
                        bike.emiInfo.nextDueDate = null;
                    } else {
                        const nextDueSource = bike.emiInfo.nextDueDate || bike.emiInfo.startDate || isoDate;
                        bike.emiInfo.nextDueDate = getNextMonthDate(nextDueSource);
                    }
                }
            }

            if (principalAmount > 0) {
                payments.push({
                    id: crypto.randomUUID(),
                    bikeId: bike.id,
                    bikeName: bike.bikeName || bike.bikeNumberPlate,
                    amount: principalAmount,
                    date: isoDate,
                    type: paymentType
                });
            }

            if (interestAmount > 0) {
                payments.push({
                    id: crypto.randomUUID(),
                    bikeId: bike.id,
                    bikeName: bike.bikeName || bike.bikeNumberPlate,
                    amount: interestAmount,
                    date: isoDate,
                    type: 'Interest Charge'
                });
            }

            return payments;
        };

        const buildWhatsappReminderMessage = (record) => {
            if (!record) return '';
            const dueMeta = record.dueMeta || {};
            const pendingAmount = typeof record.pendingAmount === 'number' ? record.pendingAmount : 0;
            const dueDateText = dueMeta.dueDate ? formatDate(dueMeta.dueDate) : null;
            const status = dueMeta.status || 'clear';
            const graceDays = dueMeta.graceDays ?? DEFAULT_GRACE_PERIOD_DAYS;
            const daysOverdue = dueMeta.daysOverdue ?? 0;
            const lines = [];

            const namePart = (record.customerName || 'there').split(' ')[0];
            lines.push(`Hi ${namePart},`);
            lines.push(`Gentle reminder about your ${record.bikeName || 'bike'} payment.`);

            if (pendingAmount > EPSILON) {
                lines.push(`Pending amount: ${formatCurrency(pendingAmount)}.`);
            }

            if (dueDateText) {
                lines.push(`Due date: ${dueDateText}.`);
            }

            if (status === 'grace') {
                const graceLeft = Math.max(0, graceDays - daysOverdue);
                lines.push(`You are within the grace period (${graceLeft} day${graceLeft === 1 ? '' : 's'} left).`);
            } else if (status === 'overdue') {
                lines.push(`Overdue by ${daysOverdue} day${daysOverdue === 1 ? '' : 's'}. Kindly clear it to avoid additional interest.`);
            }

            if (record.overdueInterest > 0) {
                lines.push(`Current interest due: ${formatCurrency(record.overdueInterest)}.`);
            }

            lines.push('Please let me know once the payment is completed. Thank you!');
            return lines.join('\n');
        };

        const getBulkSuggestedAmount = (record) => {
            if (!record) return 0;
            if (record.paymentMode === 'emi') {
                const installmentsLeft = record.dueMeta?.installmentsLeft ?? 0;
                if (installmentsLeft <= 0) {
                    return record.pendingAmount;
                }
                const monthly = record.monthlyAmount || 0;
                if (monthly <= 0) {
                    return record.pendingAmount;
                }
                return Math.min(monthly, record.pendingAmount);
            }
            return record.pendingAmount;
        };

        const updateCreditBulkFooter = (records = []) => {
            if (!creditBulkFooter) return;
            const bulkMode = !!state.ui.creditBulkMode;
            const selectedIds = new Set(state.ui.creditBulkSelection || []);
            if (!bulkMode || selectedIds.size === 0) {
                creditBulkFooter.classList.add('hidden');
                creditBulkCount.textContent = '0 customers selected';
                creditBulkTotal.textContent = formatCurrency(0);
                return;
            }

            const drafts = state.ui.creditBulkDrafts || {};
            const selectedRecords = records.filter(record => selectedIds.has(record.bikeId));
            let total = 0;

            selectedRecords.forEach(record => {
                const draft = drafts[record.bikeId];
                const amount = typeof draft?.principal === 'number'
                    ? draft.principal
                    : getBulkSuggestedAmount(record);
                total += amount;
            });

            creditBulkFooter.classList.remove('hidden');
            creditBulkCount.textContent = `${selectedRecords.length} customer${selectedRecords.length === 1 ? '' : 's'} selected`;
            creditBulkTotal.textContent = formatCurrency(total);
        };

        const renderCreditPage = () => {
            const { records, totals } = summarizeCreditRecords();
            const bulkMode = !!state.ui.creditBulkMode;
            const selectedIds = new Set(state.ui.creditBulkSelection || []);
            const statusClassMap = {
                clear: 'bg-green-100 text-green-700',
                upcoming: 'bg-blue-100 text-blue-700',
                dueToday: 'bg-amber-100 text-amber-700',
                grace: 'bg-amber-100 text-amber-700',
                overdue: 'bg-red-100 text-red-700'
            };

            creditTotal.textContent = formatCurrency(totals.totalCredit);
            creditCollected.textContent = formatCurrency(totals.collected);
            creditPending.textContent = formatCurrency(totals.pending);
            creditActive.textContent = totals.activeCustomers.toString();

            if (creditBulkToggle) {
                creditBulkToggle.textContent = bulkMode ? 'Exit Bulk Collection' : 'Start Bulk Collection';
                creditBulkToggle.classList.toggle('bg-blue-500', bulkMode);
                creditBulkToggle.classList.toggle('text-white', bulkMode);
                creditBulkToggle.classList.toggle('border', !bulkMode);
                creditBulkToggle.classList.toggle('border-blue-200', !bulkMode);
            }

            if (!records.length) {
                creditList.innerHTML = `<p class="text-gray-500 text-center mt-4">No credit or EMI sales yet.</p>`;
                updateCreditBulkFooter([]);
                return;
            }

            const creditCards = records.map(record => {
                const dueMeta = record.dueMeta || {};
                const pendingPrincipal = typeof dueMeta.pendingPrincipal === 'number' ? dueMeta.pendingPrincipal : record.pendingAmount;
                const graceDays = dueMeta.graceDays ?? DEFAULT_GRACE_PERIOD_DAYS;
                const statusKey = dueMeta.status || 'clear';
                const statusLabel = dueMeta.statusLabel || 'Status';
                const isSelected = bulkMode && selectedIds.has(record.bikeId);
                const cardClasses = [
                    'bg-white',
                    'rounded-xl',
                    'p-4',
                    'shadow-sm',
                    'space-y-3',
                    'transition',
                    'duration-150'
                ];
                if (bulkMode && isSelected) {
                    cardClasses.push('ring-2', 'ring-blue-400', 'ring-offset-1');
                }

                let scheduleInfo = '';
                if (record.paymentMode === 'credit') {
                    scheduleInfo = `
                        <p class="text-sm text-gray-500">
                            Initial Payment: <span class="font-medium text-gray-700">${esc(formatCurrency(record.initialPayment))}</span>
                        </p>
                    `;
                } else if (record.paymentMode === 'emi') {
                    scheduleInfo = `
                        <p class="text-sm text-gray-500">
                            EMI Progress: <span class="font-medium text-gray-700">${esc(record.installmentsPaid || 0)}/${esc(record.totalInstallments || 0)}</span>  
                            Monthly: <span class="font-medium text-gray-700">${esc(formatCurrency(record.monthlyAmount))}</span>
                        </p>
                    `;
                }

                const recentPayments = record.payments.slice(0, 3).map(payment => `
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>${esc(formatDate(payment.date))}</span>
                        <span class="font-medium text-gray-600">${esc(formatCurrency(payment.amount))}</span>
                        <span class="uppercase">${esc(payment.type || '')}</span>
                    </div>
                `).join('');

                const paymentHistory = recentPayments
                    ? `<div class="mt-3 border-t border-gray-100 pt-3 space-y-1">${recentPayments}</div>`
                    : '<p class="text-xs text-gray-400 mt-3">No payments logged yet.</p>';

                const callHref = record.phoneHref ? esc(`tel:${record.phoneHref}`) : '#';
                const whatsappHref = record.phoneHref ? esc(`https://wa.me/${record.phoneHref}?text=${encodeURIComponent(buildWhatsappReminderMessage(record))}`) : '#';
                const contactDisabledClass = record.phoneHref ? '' : 'opacity-60 pointer-events-none cursor-not-allowed';
                const pendingClass = pendingPrincipal > EPSILON ? 'text-amber-600' : 'text-green-600';
                const dueText = record.paymentMode === 'emi'
                    ? (pendingPrincipal > EPSILON
                        ? (dueMeta.dueDate ? `Next EMI ${esc(formatDate(dueMeta.dueDate))}` : 'EMI pending')
                        : 'All EMIs completed')
                    : (pendingPrincipal > EPSILON
                        ? (dueMeta.dueDate ? `Due ${esc(formatDate(dueMeta.dueDate))}` : 'Pending balance')
                        : 'All dues cleared');

                const chips = [
                    `<span class="px-2 py-0.5 text-xs font-medium bg-blue-50 text-blue-700 rounded-full">Grace ${esc(graceDays)}d</span>`
                ];
                if (dueMeta.interestRate) {
                    chips.push(`<span class="px-2 py-0.5 text-xs font-medium bg-purple-50 text-purple-700 rounded-full">Interest ${esc(dueMeta.interestRate)}%/mo</span>`);
                }
                if (record.overdueInterest > 0) {
                    chips.push(`<span class="px-2 py-0.5 text-xs font-medium bg-red-100 text-red-700 rounded-full">Interest due ${esc(formatCurrency(record.overdueInterest))}</span>`);
                }

                return `
                    <div class="${cardClasses.join(' ')}" data-bike-id="${safeBikeId}" data-payment-mode="${safePaymentMode}" data-pending="${esc(record.pendingAmount || 0)}" data-monthly="${esc(record.monthlyAmount || 0)}">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-lg font-semibold text-gray-900">${safeCustomerName}</p>
                                <p class="text-sm text-gray-500">${safeBikeName}</p>
                            </div>
                            <div class="flex items-center gap-2">
                                ${bulkMode ? `
                                    <label class="flex items-center gap-1 text-xs text-gray-500 select-none">
                                        <input type="checkbox" class="credit-bulk-checkbox h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" data-bulk-id="${safeBikeId}" ${isSelected ? 'checked' : ''}>
                                        Select
                                    </label>
                                ` : ''}
                                <span class="text-xs font-medium px-2 py-1 rounded-full bg-blue-100 text-blue-700">
                                    ${esc(record.paymentMode === 'emi' ? 'EMI' : 'Credit')}
                                </span>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
                            <div>
                                <p class="text-gray-500">Sale Price</p>
                                <p class="font-semibold text-gray-900">${safeSalePrice}</p>
                            </div>
                            <div>
                                <p class="text-gray-500">Pending</p>
                                <p class="font-semibold ${pendingClass}">${safePendingAmount}</p>
                            </div>
                        </div>

                        <div class="flex items-center justify-between text-sm mt-1">
                            <span class="text-blue-600 font-medium">${dueText}</span>
                            <span class="text-xs font-semibold px-2 py-0.5 rounded-full ${statusClassMap[statusKey] || 'bg-gray-100 text-gray-600'}">
                                ${safeStatusLabel}
                            </span>
                        </div>

                        <div class="flex flex-wrap gap-2 mt-2">
                            ${chips.join('')}
                        </div>

                        <div class="flex items-center justify-between text-xs text-gray-500 mt-2">
                            <span>Collected: ${safeTotalPaid}</span>
                            <span>Target: ${safeTarget}</span>
                        </div>
                        <div class="w-full h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-blue-500" style="width: ${safeProgress}%;"></div>
                        </div>

                        ${scheduleInfo}

                        <div class="flex flex-wrap gap-2 pt-2">
                            <a href="${callHref}" class="px-3 py-1.5 text-sm bg-blue-100 text-blue-700 rounded-lg font-medium ${contactDisabledClass}">Call</a>
                            <a href="${whatsappHref}" target="_blank" class="px-3 py-1.5 text-sm bg-green-100 text-green-700 rounded-lg font-medium ${contactDisabledClass}">WhatsApp</a>
                            <button data-action="log-payment" class="px-3 py-1.5 text-sm bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                                Record Payment
                            </button>
                        </div>

                        ${paymentHistory}
                    </div>
                `;
            }).join('');

            creditList.innerHTML = creditCards;
            updateCreditBulkFooter(records);
        };

        const renderAnalyticsPage = () => {
            const { cashInHand, totalProfit, totalCashInflow, totalCashOutflow } = state.metrics;
            const { bikes, expenses, cashEntries, payments } = state.data;

            setSensitiveCurrency(analyticsCash, cashInHand);
            setSensitiveCurrency(analyticsProfit, totalProfit);
            setSensitiveCurrency(analyticsRealized, state.metrics.realizedProfit);
            setSensitiveCurrency(analyticsMonth, state.metrics.thisMonthProfit);
            setSensitiveCurrency(analyticsInflow, totalCashInflow);
            setSensitiveCurrency(analyticsOutflow, totalCashOutflow);

            if (!state.security.isUnlocked) {
                analyticsLockedState.classList.remove('hidden');
                analyticsContent.classList.add('hidden');
            } else {
                analyticsLockedState.classList.add('hidden');
                analyticsContent.classList.remove('hidden');
            }

            let transactions = [];

            (cashEntries || []).forEach(entry => {
                transactions.push({
                    timestamp: entry.createdAt,
                    amount: entry.type === 'add' ? entry.amount : -entry.amount,
                    description: entry.description
                });
            });

            (bikes || []).forEach(bike => {
                const totalCost = (bike.purchasePrice || 0) + (bike.repairPrice || 0);
                if (totalCost > 0) {
                    transactions.push({
                        timestamp: bike.createdAt || bike.purchaseDate,
                        amount: -totalCost,
                        description: `Purchase: ${bike.bikeName || bike.bikeNumberPlate}`
                    });
                }
            });

            (payments || []).forEach(payment => {
                transactions.push({
                    timestamp: payment.date,
                    amount: payment.amount,
                    description: `${payment.type}: ${payment.bikeName || 'N/A'}`
                });
            });

            (state.data.brandNewDeliveries || []).forEach(delivery => {
                transactions.push({
                    timestamp: delivery.createdAt || delivery.deliveryDate,
                    amount: delivery.commissionReceived || 0,
                    description: `Brand New Commission: ${delivery.bikeModel || delivery.customerName || 'Delivery'}`
                });

                (delivery.commissionToGive || []).forEach(ref => {
                    if (ref.paymentStatus === 'paid' && ref.commissionAmount) {
                        transactions.push({
                            timestamp: delivery.createdAt || delivery.deliveryDate,
                            amount: -(ref.commissionAmount || 0),
                            description: `Referrer Payout: ${ref.referrerName || 'Agent'}`
                        });
                    }
                });
            });

            (expenses || []).filter(e => e.amount > 0).forEach(expense => {
                transactions.push({
                    timestamp: expense.createdAt || expense.date,
                    amount: -expense.amount,
                    description: `Expense: ${expense.description}`
                });
            });

            transactions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            if (analyticsTransactionList) {
                if (!transactions.length) {
                    analyticsTransactionList.innerHTML = '<p class="text-sm text-gray-500 text-center py-4">No transactions yet.</p>';
                } else {
                    analyticsTransactionList.innerHTML = transactions.map(t => `
                        <div class="flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0">
                            <div>
                                <p class="font-medium text-sm">${esc(t.description || '')}</p>
                                <p class="text-xs text-gray-500">${esc(formatDateTime(t.timestamp))}</p>
                            </div>
                            <span class="font-semibold ${t.amount > 0 ? 'text-green-600' : 'text-red-600'}">
                                ${t.amount > 0 ? '+' : ''}${esc(formatCurrency(t.amount))}
                            </span>
                        </div>
                    `).join('');
                }
            }

            const expenseRecords = (expenses || [])
                .slice()
                .sort((a, b) => new Date(b.date || b.createdAt) - new Date(a.date || a.createdAt));

            if (!expenseRecords.length) {
                analyticsExpenseTotal.textContent = formatCurrency(0);
                analyticsExpenseList.innerHTML = '<p class="text-sm text-gray-500 text-center py-2">No expenses recorded.</p>';
            } else {
                const totalExpenses = expenseRecords.reduce((sum, expense) => sum + (expense.amount || 0), 0);
                analyticsExpenseTotal.textContent = formatCurrency(totalExpenses);

                analyticsExpenseList.innerHTML = expenseRecords.slice(0, 5).map(expense => `
                    <div class="flex justify-between text-sm">
                        <div>
                            <p class="font-medium text-gray-800">${esc(expense.description || '')}</p>
                            <p class="text-xs text-gray-500">${esc(formatDate(expense.date || expense.createdAt))}</p>
                        </div>
                        <span class="font-semibold text-red-600">- ${esc(formatCurrency(expense.amount || 0))}</span>
                    </div>
                `).join('');
            }
        };

        // --- PIN Handling ---

        const openPinModal = (message = 'Enter your PIN to continue.', options = {}) => {
            const { mode = 'unlock', showCancel = true } = options;
            state.security.pinMode = mode;
            pinModalMessage.textContent = message;
            pinError.textContent = '';
            pinInput.value = '';
            if (showCancel) {
                pinCancel.classList.remove('hidden');
            } else {
                pinCancel.classList.add('hidden');
            }
            pinModal.classList.remove('hidden');
            setTimeout(() => pinInput.focus(), 50);
        };

        const closePinModal = () => {
            pinModal.classList.add('hidden');
            pinInput.value = '';
            pinCancel.classList.remove('hidden');
            state.security.pinMode = 'unlock';
        };

        const resolvePinRequest = (value) => {
            if (state.security.pendingResolve) {
                state.security.pendingResolve.resolve(value);
                state.security.pendingResolve = null;
            }
        };

        const rejectPinRequest = (reason) => {
            if (state.security.pendingResolve) {
                state.security.pendingResolve.reject(reason);
                state.security.pendingResolve = null;
            }
        };

        const requestPinUnlock = (message = 'Enter your PIN to unlock sensitive data.') => {
            if (state.security.isUnlocked) {
                return Promise.resolve(true);
            }
            if (state.security.pendingResolve) {
                rejectPinRequest('replaced');
            }
            return new Promise((resolve, reject) => {
                state.security.pendingResolve = { resolve, reject };
                openPinModal(message, { mode: 'unlock', showCancel: true });
            });
        };

        const requirePinSetup = (message = 'Set a new 46 digit PIN to secure your account.') => {
            if (state.security.pendingResolve) {
                rejectPinRequest('replaced');
            }
            return new Promise((resolve, reject) => {
                state.security.pendingResolve = { resolve, reject };
                openPinModal(message, { mode: 'setup', showCancel: false });
            });
        };

        const handlePinSubmission = () => {
            const enteredPin = pinInput.value.trim();
            if (!enteredPin) {
                pinError.textContent = 'Please enter your PIN.';
                return;
            }
            if (state.security.pinMode === 'setup') {
                if (!/^\d{4,6}$/.test(enteredPin)) {
                    pinError.textContent = 'PIN must be 4-6 digits.';
                    pinInput.select();
                    return;
                }
                state.data.settings.pin = enteredPin;
                saveData();
                closePinModal();
                state.security.isUnlocked = true;
                updateSensitiveToggle();
                render();
                resolvePinRequest(true);
                showToast('PIN set successfully.');
                return;
            }
            const currentPin = state.data?.settings?.pin || '1111';
            if (enteredPin !== currentPin) {
                pinError.textContent = 'Incorrect PIN. Try again.';
                pinInput.select();
                return;
            }
            closePinModal();
            state.security.isUnlocked = true;
            updateSensitiveToggle();
            render();
            resolvePinRequest(true);
            showToast('Sensitive data unlocked.');
        };

        const handleModalSave = async () => {
            const { type, data } = state.ui.modal;
            
            try {
                switch (type) {
                    case 'addBike': {
                        const plate = $('#bike-plate').value.toUpperCase();
                        const bikeName = $('#bike-name').value;
                        const ownerName = $('#bike-owner').value;
                        const purchaseDate = $('#bike-purchase-date').value;
                        const purchasePrice = parseFloat($('#bike-purchase-price').value);
                        
                        if (!bikeName) throw new Error('Bike Name is required.');
                        if (!/^[A-Z]{2}[0-9]{1,2}[A-Z]{1,2}[0-9]{1,4}$/.test(plate)) throw new Error('Invalid bike number plate format.');
                        if (!ownerName || !purchaseDate || !purchasePrice) throw new Error('Owner, Purchase Date, and Purchase Price are required.');
                        if (state.data.bikes.some(b => b.bikeNumberPlate === plate)) throw new Error('A bike with this number plate already exists.');

                        const referralName = ($('#bike-ref-name')?.value || '').trim();
                        const referralContact = ($('#bike-ref-contact')?.value || '').trim();
                        const referralComm = parseFloat($('#bike-ref-commission')?.value || '0') || 0;

                        const newBike = {
                            id: crypto.randomUUID(),
                            bikeName: bikeName,
                            bikeNumberPlate: plate,
                            ownerName: ownerName,
                            ownerContact: $('#bike-owner-contact').value,
                            supplierName: $('#bike-supplier').value,
                            supplierContact: $('#bike-supplier-contact').value,
                            purchaseDate: purchaseDate,
                            purchasePrice: purchasePrice,
                            repairPrice: parseFloat($('#bike-repair-price').value) || 0,
                            createdAt: new Date().toISOString(),
                            sold: false,
                            targetSalePrice: parseFloat($('#bike-target-price').value) || null,
                            clearanceSale: false,
                            referral: referralName ? {
                                name: referralName,
                                contact: referralContact,
                                commission: referralComm
                            } : null
                        };
                        state.data.bikes.push(newBike);
                        
                        autoCreatePRContact({
                            name: newBike.ownerName,
                            contact: newBike.ownerContact,
                            relationType: 'Owner',
                            relatedBikeName: newBike.bikeName || newBike.bikeNumberPlate
                        });
                        autoCreatePRContact({
                            name: newBike.supplierName,
                            contact: newBike.supplierContact,
                            relationType: 'Supplier',
                            relatedBikeName: newBike.bikeName || newBike.bikeNumberPlate
                        });
                        if (newBike.referral) {
                            autoCreatePRContact({
                                name: newBike.referral.name,
                                contact: newBike.referral.contact,
                                relationType: 'Referrer',
                                relatedBikeName: newBike.bikeName || newBike.bikeNumberPlate
                            });
                        }
                        
                        showToast('Bike added successfully!');
                        break;
                    }

                    case 'editBike': {
                        const index = state.data.bikes.findIndex(b => b.id === data.id);
                        if (index === -1) throw new Error('Bike not found.');
                        
                        const bikeName = $('#bike-name').value;
                        const ownerName = $('#bike-owner').value;
                        if (!bikeName) throw new Error('Bike Name is required.');
                        if (!ownerName) throw new Error('Owner Name is required.');

                        const referralName = ($('#bike-ref-name')?.value || '').trim();
                        const referralContact = ($('#bike-ref-contact')?.value || '').trim();
                        const referralComm = parseFloat($('#bike-ref-commission')?.value || '0') || 0;

                        const purchaseData = {
                            bikeName: bikeName,
                            ownerName: ownerName,
                            ownerContact: $('#bike-owner-contact').value,
                            supplierName: $('#bike-supplier').value,
                            supplierContact: $('#bike-supplier-contact').value,
                            purchaseDate: $('#bike-purchase-date').value,
                            purchasePrice: parseFloat($('#bike-purchase-price').value) || 0,
                            repairPrice: parseFloat($('#bike-repair-price').value) || 0,
                            targetSalePrice: parseFloat($('#bike-target-price').value) || null,
                            referral: referralName ? {
                                name: referralName,
                                contact: referralContact,
                                commission: referralComm
                            } : null
                        };
                        
                        const totalSellingPrice = parseFloat($('#sale-total-price').value) || 0;
                        let salesData = {};
                        
                        if (totalSellingPrice > 0) {
                            const wasSold = state.data.bikes[index].sold;
                            const paymentDate = wasSold ? state.data.bikes[index].soldDate : formatDate(new Date());
                            
                            salesData = {
                                ...purchaseData,
                                sold: true,
                                soldAt: wasSold ? state.data.bikes[index].soldAt : new Date().toISOString(),
                                soldDate: paymentDate,
                                customerName: $('#sale-customer-name').value,
                                customerContact: $('#sale-customer-contact').value,
                                sellingPrice: totalSellingPrice,
                                paymentMode: $('#sale-payment-mode').value,
                                creditInfo: null,
                                emiInfo: null,
                            };
                            
                            const paymentMode = salesData.paymentMode;
                            let initialPaymentAmount = 0;
                            
                            if (paymentMode === 'cash') {
                                initialPaymentAmount = totalSellingPrice;
                                salesData.soldDate = $('#sale-cash-date').value;
                            } else if (paymentMode === 'credit') {
                                const initial = parseFloat($('#sale-credit-initial').value) || 0;
                        const creditGraceInput = parseInt($('#sale-credit-grace').value, 10);
                        const creditInterestInput = parseFloat($('#sale-credit-interest').value);
                        const creditGrace = Number.isFinite(creditGraceInput) && creditGraceInput >= 0
                            ? creditGraceInput
                            : DEFAULT_GRACE_PERIOD_DAYS;
                        const creditInterest = Number.isFinite(creditInterestInput) && creditInterestInput >= 0
                            ? creditInterestInput
                            : 0;
                                initialPaymentAmount = initial;
                                salesData.creditInfo = {
                                    initialPayment: initial,
                                    remaining: totalSellingPrice - initial,
                            dueDate: $('#sale-credit-due-date').value,
                            gracePeriodDays: creditGrace,
                            interestRate: creditInterest
                                };
                            } else if (paymentMode === 'emi') {
                                const downPayment = parseFloat($('#sale-emi-downpayment').value) || 0;
                        const emiGraceInput = parseInt($('#sale-emi-grace').value, 10);
                        const emiInterestInput = parseFloat($('#sale-emi-interest').value);
                        const emiGrace = Number.isFinite(emiGraceInput) && emiGraceInput >= 0
                            ? emiGraceInput
                            : DEFAULT_GRACE_PERIOD_DAYS;
                        const emiInterest = Number.isFinite(emiInterestInput) && emiInterestInput >= 0
                            ? emiInterestInput
                            : 0;
                                initialPaymentAmount = downPayment;
                                salesData.emiInfo = {
                                    downPayment: downPayment,
                                    monthlyAmount: parseFloat($('#sale-emi-monthly').value) || 0,
                                    totalInstallments: parseInt($('#sale-emi-installments').value) || 0,
                                    installmentsPaid: wasSold ? state.data.bikes[index].emiInfo.installmentsPaid : 0,
                                    startDate: $('#sale-emi-start-date').value,
                            nextDueDate: wasSold ? state.data.bikes[index].emiInfo.nextDueDate : $('#sale-emi-start-date').value,
                            gracePeriodDays: emiGrace,
                            interestRate: emiInterest
                                };
                            }

                            const paymentIndex = state.data.payments.findIndex(p => p.bikeId === data.id && p.type === 'Initial Payment');
                            
                            if (paymentIndex > -1) {
                                state.data.payments[paymentIndex].amount = initialPaymentAmount;
                                state.data.payments[paymentIndex].date = (paymentMode === 'cash' ? salesData.soldDate : salesData.soldAt);
                            } else if (!wasSold) {
                                state.data.payments.push({
                                    id: crypto.randomUUID(),
                                    bikeId: data.id,
                                    bikeName: bikeName || data.bikeNumberPlate,
                                    amount: initialPaymentAmount,
                                    date: (paymentMode === 'cash' ? salesData.soldDate : salesData.soldAt),
                                    type: 'Initial Payment'
                                });
                                
                                autoCreatePRContact({
                                    name: salesData.customerName,
                                    contact: salesData.customerContact,
                                    relationType: 'Buyer',
                                    relatedBikeName: bikeName
                                });
                            }
                            
                        } else {
                            salesData = { ...purchaseData, sold: false, sellingPrice: 0 };
                        }
                        
                        state.data.bikes[index] = { ...state.data.bikes[index], ...salesData };
                        if (state.data.bikes[index].sold) {
                            state.data.bikes[index].clearanceSale = false;
                        }
                        
                        autoCreatePRContact({
                            name: purchaseData.ownerName,
                            contact: purchaseData.ownerContact,
                            relationType: 'Owner',
                            relatedBikeName: bikeName || data.bikeNumberPlate
                        });
                        autoCreatePRContact({
                            name: purchaseData.supplierName,
                            contact: purchaseData.supplierContact,
                            relationType: 'Supplier',
                            relatedBikeName: bikeName
                        });
                        if (purchaseData.referral) {
                            autoCreatePRContact({
                                name: purchaseData.referral.name,
                                contact: purchaseData.referral.contact,
                                relationType: 'Referrer',
                                relatedBikeName: bikeName
                            });
                        }
                        if (salesData.sold && salesData.customerName && salesData.customerContact) {
                            autoCreatePRContact({
                                name: salesData.customerName,
                                contact: salesData.customerContact,
                                relationType: 'Buyer',
                                relatedBikeName: bikeName
                            });
                        }
                        
                        showToast('Bike updated successfully!');
                        break;
                    }
                    
                    case 'markSold': {
                        const index = state.data.bikes.findIndex(b => b.id === data.id);
                        if (index === -1) throw new Error('Bike not found.');
                        if (state.data.bikes[index].sold) throw new Error('Bike is already sold.');

                        const totalSellingPrice = parseFloat($('#sale-total-price').value) || 0;
                        if (totalSellingPrice <= 0) throw new Error('Total Selling Price is required.');
                        
                        const paymentMode = $('#sale-payment-mode').value;
                        let initialPaymentAmount = 0;
                        let paymentDate = new Date().toISOString();
                        let bikeUpdate = {
                            sold: true,
                            soldAt: paymentDate,
                            customerName: $('#sale-customer-name').value,
                            customerContact: $('#sale-customer-contact').value,
                            sellingPrice: totalSellingPrice,
                            paymentMode: paymentMode,
                            creditInfo: null,
                            emiInfo: null,
                        };
                        
                        if (paymentMode === 'cash') {
                            initialPaymentAmount = totalSellingPrice;
                            paymentDate = new Date($('#sale-cash-date').value).toISOString();
                            bikeUpdate.soldDate = paymentDate;
                        } else if (paymentMode === 'credit') {
                            const initial = parseFloat($('#sale-credit-initial').value) || 0;
                        const creditGraceInput = parseInt($('#sale-credit-grace').value, 10);
                        const creditInterestInput = parseFloat($('#sale-credit-interest').value);
                        const creditGrace = Number.isFinite(creditGraceInput) && creditGraceInput >= 0
                            ? creditGraceInput
                            : DEFAULT_GRACE_PERIOD_DAYS;
                        const creditInterest = Number.isFinite(creditInterestInput) && creditInterestInput >= 0
                            ? creditInterestInput
                            : 0;
                            initialPaymentAmount = initial;
                            bikeUpdate.soldDate = formatDate(new Date());
                            bikeUpdate.creditInfo = {
                                initialPayment: initial,
                                remaining: totalSellingPrice - initial,
                            dueDate: $('#sale-credit-due-date').value,
                            gracePeriodDays: creditGrace,
                            interestRate: creditInterest
                            };
                            if (!bikeUpdate.creditInfo.dueDate) throw new Error('Remaining Due Date is required for Credit.');
                        } else if (paymentMode === 'emi') {
                            const downPayment = parseFloat($('#sale-emi-downpayment').value) || 0;
                        const emiGraceInput = parseInt($('#sale-emi-grace').value, 10);
                        const emiInterestInput = parseFloat($('#sale-emi-interest').value);
                        const emiGrace = Number.isFinite(emiGraceInput) && emiGraceInput >= 0
                            ? emiGraceInput
                            : DEFAULT_GRACE_PERIOD_DAYS;
                        const emiInterest = Number.isFinite(emiInterestInput) && emiInterestInput >= 0
                            ? emiInterestInput
                            : 0;
                            initialPaymentAmount = downPayment;
                            bikeUpdate.soldDate = formatDate(new Date());
                            bikeUpdate.emiInfo = {
                                downPayment: downPayment,
                                monthlyAmount: parseFloat($('#sale-emi-monthly').value) || 0,
                                totalInstallments: parseInt($('#sale-emi-installments').value) || 0,
                                installmentsPaid: 0,
                                startDate: $('#sale-emi-start-date').value,
                            nextDueDate: $('#sale-emi-start-date').value,
                            gracePeriodDays: emiGrace,
                            interestRate: emiInterest
                            };
                            if (!bikeUpdate.emiInfo.monthlyAmount || !bikeUpdate.emiInfo.startDate) throw new Error('Monthly Amount and Start Date are required for EMI.');
                            if (!bikeUpdate.emiInfo.totalInstallments) throw new Error('Number of Installments is required for EMI.');
                        }
                        
                        state.data.bikes[index] = { ...state.data.bikes[index], ...bikeUpdate };
                        
                        state.data.payments.push({
                            id: crypto.randomUUID(),
                            bikeId: data.id,
                            bikeName: data.bikeName || data.bikeNumberPlate,
                            amount: initialPaymentAmount,
                            date: paymentDate,
                            type: 'Initial Payment'
                        });
                        
                        autoCreatePRContact({
                            name: bikeUpdate.customerName,
                            contact: bikeUpdate.customerContact,
                            relationType: 'Buyer',
                            relatedBikeName: data.bikeName || data.bikeNumberPlate
                        });
                        
                        showToast('Bike marked as sold!');
                        break;
                    }
                    
                    case 'logPayment': {
                        const index = state.data.bikes.findIndex(b => b.id === $('#payment-bike-id').value);
                        if (index === -1) throw new Error('Bike not found.');
                        
                        const bike = state.data.bikes[index];
                        const principalInput = parseFloat($('#payment-amount').value);
                        const interestInput = parseFloat($('#payment-interest')?.value);
                        const principalAmount = Number.isFinite(principalInput) ? principalInput : 0;
                        const interestAmount = Number.isFinite(interestInput) ? interestInput : 0;
                        const date = $('#payment-date').value;
                        const paymentTypeHint = $('#payment-type').value || 'Payment';
                        const isEMIFinal = $('#payment-emi-final') && $('#payment-emi-final').checked;

                        if (!date) throw new Error('Payment date is required.');
                        const isoDate = new Date(date).toISOString();

                        const paymentEntries = applyPaymentForBike({
                            bike,
                            principalAmount,
                            interestAmount,
                            isoDate,
                            isEMIFinal,
                            paymentTypeHint
                        });

                        paymentEntries.forEach(entry => state.data.payments.push(entry));
                        
                        state.data.bikes[index] = bike;
                        showToast('Payment logged successfully!');
                        break;
                    }
                    
                    case 'bulkPayments': {
                        const records = Array.isArray(data) ? data : [];
                        if (!records.length) throw new Error('No customers selected.');

                        const dateValue = $('#bulk-payment-date')?.value;
                        if (!dateValue) throw new Error('Payment date is required.');
                        const isoDate = new Date(dateValue).toISOString();

                        const errors = [];
                        let processed = 0;

                        records.forEach(record => {
                            const row = modalBody.querySelector(`[data-bulk-id="${record.bikeId}"]`);
                            if (!row) return;

                            const principalInput = parseFloat(row.querySelector('.bulk-principal')?.value);
                            const interestInput = parseFloat(row.querySelector('.bulk-interest')?.value);
                            const principalAmount = Number.isFinite(principalInput) ? principalInput : 0;
                            const interestAmount = Number.isFinite(interestInput) ? interestInput : 0;
                            const isEMIFinal = row.querySelector('.bulk-final')?.checked || false;

                            if (principalAmount <= 0 && interestAmount <= 0) {
                                return; // skip entries with no amounts
                            }

                            if (isEMIFinal && principalAmount <= 0) {
                                errors.push(`${record.customerName}: Principal amount is required for final settlement.`);
                                return;
                            }

                            const bikeIndex = state.data.bikes.findIndex(bike => bike.id === record.bikeId);
                            if (bikeIndex === -1) {
                                errors.push(`${record.customerName}: Bike not found.`);
                                return;
                            }

                            try {
                                const bikeRef = state.data.bikes[bikeIndex];
                                const paymentEntries = applyPaymentForBike({
                                    bike: bikeRef,
                                    principalAmount,
                                    interestAmount,
                                    isoDate,
                                    isEMIFinal,
                                    paymentTypeHint: record.paymentMode === 'emi' ? 'EMI Payment' : 'Credit Payment'
                                });
                                paymentEntries.forEach(entry => state.data.payments.push(entry));
                                state.data.bikes[bikeIndex] = bikeRef;
                                processed += 1;
                            } catch (error) {
                                errors.push(`${record.customerName}: ${error.message}`);
                            }
                        });

                        if (errors.length) {
                            throw new Error(errors.join('\n'));
                        }

                        state.ui.creditBulkSelection = [];
                        state.ui.creditBulkDrafts = {};
                        state.ui.creditBulkMode = false;
                        showToast(`Payments recorded for ${processed} customer${processed === 1 ? '' : 's'}.`);
                        break;
                    }
                    
                    case 'addExpense':
                    case 'editExpense':
                        const description = $('#expense-desc').value;
                        const amount = parseFloat($('#expense-amount').value);
                        const date = $('#expense-date').value;
                        
                        if (!description || !amount || !date) throw new Error('All fields are required.');
                        
                        if (type === 'addExpense') {
                            state.data.expenses.push({ 
                                id: crypto.randomUUID(), 
                                description, 
                                amount, 
                                date,
                                createdAt: new Date().toISOString()
                            });
                            showToast('Expense added!');
                        } else {
                            const index = state.data.expenses.findIndex(e => e.id === data.id);
                            if (index === -1) throw new Error('Expense not found.');
                            state.data.expenses[index] = { ...data, description, amount, date };
                            showToast('Expense updated!');
                        }
                        break;
                    
                    case 'addPR':
                    case 'editPR':
                        const name = $('#pr-name').value;
                        const contact = $('#pr-contact').value;
                        
                        if (!name || !contact) throw new Error('Name and Contact are required.');
                        
                        const prData = {
                            name,
                            contact,
                            relationType: $('#pr-type').value,
                            relatedBikeName: $('#pr-bike-name').value,
                        };
                        
                        if (type === 'addPR') {
                            state.data.pr.push({ id: crypto.randomUUID(), ...prData });
                            showToast('Contact added!');
                        } else {
                            const index = state.data.pr.findIndex(p => p.id === data.id);
                            if (index === -1) throw new Error('Contact not found.');
                            state.data.pr[index] = { ...data, ...prData };
                            showToast('Contact updated!');
                        }
                        break;
                    
                    case 'addBrandNew':
                    case 'editBrandNew': {
                        const deliveryId = type === 'editBrandNew' && data ? data.id : crypto.randomUUID();
                        const bikeModel = ($('#brand-bike-model')?.value || '').trim();
                        const deliveryDate = $('#brand-delivery-date')?.value;
                        const commissionReceived = parseFloat($('#brand-commission-received')?.value || '0');
                        const customerName = ($('#brand-customer-name')?.value || '').trim();
                        const customerContact = ($('#brand-customer-contact')?.value || '').trim();
                        const showroomName = ($('#brand-showroom-name')?.value || '').trim();
                        const invoiceNumber = ($('#brand-invoice-number')?.value || '').trim();
                        const notes = ($('#brand-notes')?.value || '').trim();

                        if (!bikeModel || !deliveryDate || !customerName || !showroomName) {
                            throw new Error('Bike Model, Delivery Date, Customer Name, and Showroom Name are required.');
                        }
                        if (isNaN(commissionReceived) || commissionReceived < 0) {
                            throw new Error('Commission received must be a non-negative number.');
                        }

                        const referrerElements = modalBody.querySelectorAll('.brand-referrer-item');
                        const commissionToGive = Array.from(referrerElements).map(element => {
                            const amount = parseFloat(element.dataset.refAmount || '0');
                            if (isNaN(amount) || amount < 0) {
                                throw new Error('Referrer commission amounts must be valid numbers.');
                            }
                            return {
                                id: element.dataset.refId || crypto.randomUUID(),
                                referrerName: element.dataset.refName || 'Referrer',
                                referrerContact: element.dataset.refContact || '',
                                commissionAmount: amount,
                                paymentStatus: element.dataset.status === 'paid' ? 'paid' : 'pending'
                            };
                        });

                        const payload = {
                            id: deliveryId,
                            bikeModel,
                            deliveryDate,
                            commissionReceived,
                            customerName,
                            customerContact,
                            showroomName,
                            invoiceNumber: invoiceNumber || undefined,
                            notes: notes || undefined,
                            commissionToGive,
                            createdAt: type === 'editBrandNew' && data?.createdAt ? data.createdAt : new Date().toISOString()
                        };

                        if (type === 'addBrandNew') {
                            state.data.brandNewDeliveries.push(payload);
                            showToast('Brand new delivery added!');
                        } else {
                            const index = state.data.brandNewDeliveries.findIndex(delivery => delivery.id === deliveryId);
                            if (index === -1) throw new Error('Delivery not found.');
                            state.data.brandNewDeliveries[index] = payload;
                            showToast('Brand new delivery updated!');
                        }

                        autoCreatePRContact({
                            name: customerName,
                            contact: customerContact,
                            relationType: 'Buyer',
                            relatedBikeName: bikeModel
                        });

                        autoCreatePRContact({
                            name: showroomName,
                            contact: '',
                            relationType: 'Showroom',
                            relatedBikeName: bikeModel
                        });

                        commissionToGive.forEach(ref => {
                            autoCreatePRContact({
                                name: ref.referrerName,
                                contact: ref.referrerContact,
                                relationType: 'Referrer',
                                relatedBikeName: bikeModel
                            });
                        });
                        break;
                    }
                }
                
                closeModal();
                render();
                saveData();
                
            } catch (error) {
                showToast(error.message, true);
            }
        };
        
        const handleCashAdjustment = (type) => {
            try {
                const amount = parseFloat(cashAdjAmount.value);
                const description = cashAdjDesc.value.trim();
                
                if (!amount || amount <= 0) throw new Error('Please enter a valid amount.');
                if (!description) throw new Error('Please enter a description.');
                
                state.data.cashEntries.push({
                    id: crypto.randomUUID(),
                    type: type,
                    amount: amount,
                    description: description,
                    createdAt: new Date().toISOString()
                });
                
                cashAdjAmount.value = '';
                cashAdjDesc.value = '';
                
                showToast(`Cash ${type === 'add' ? 'added' : 'removed'} successfully.`);
                render();
                saveData();

            } catch (error) {
                showToast(error.message, true);
            }
        };
        
        // --- NEW: Backup & Restore Functions ---

        const backupToLocalFile = () => {
            try {
                const dataStr = JSON.stringify(state.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `bike-manager-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('Data backup downloaded.');
            } catch (error) {
                console.error('Local backup failed:', error);
                showToast('Local backup failed.', true);
            }
        };
        
        const backupToGist = async () => {
            if (state.ui.isGistSaving) {
                showToast('Sync already in progress.');
                return;
            }
            state.ui.isGistSaving = true;
            showLoader();
            try {
                const res = await fetch(`${GIST_API_URL}/${state.gistId}`, {
                    method: 'PATCH',
                    headers: getHeaders(),
                    body: JSON.stringify({
                        files: { [GIST_FILENAME]: { content: JSON.stringify(state.data) } }
                    })
                });
                if (!res.ok) {
                    if (res.status === 401) {
                        showToast('Token expired. Please log out.', true);
                        logout();
                    } else {
                        throw new Error(`Failed to save data (Status ${res.status})`);
                    }
                } else {
                    showToast('Data backed up to Gist!');
                }
            } catch (error) {
                console.error('Gist backup error:', error);
                showToast(`Gist backup failed: ${error.message}`, true);
            } finally {
                state.ui.isGistSaving = false;
                hideLoader();
            }
        };

        const restoreFromGist = async () => {
            const confirmed = await showConfirm(
                'Restore from Gist?',
                'This will overwrite local changes with the data currently saved on GitHub. Are you sure?'
            );
            if (!confirmed) return;
            
            showLoader();
            try {
                const res = await fetch(`${GIST_API_URL}/${state.gistId}`, { headers: getHeaders() });
                if (!res.ok) {
                    if (res.status === 401 || res.status === 404) {
                        throw new Error('Invalid token or Gist not found.');
                    }
                    throw new Error(`Failed to load data (Status ${res.status})`);
                }
                const gist = await res.json();
                const restoredData = JSON.parse(gist.files[GIST_FILENAME].content);

                state.data = restoredData; 
                runDataMigration(); // Ensure data structure is up-to-date
                saveData(); // Re-save this restored data
                render();
                showToast('Data restored from Gist.');

            } catch (err) {
                console.error(err);
                showToast(`Gist restore failed: ${err.message}`, true);
            } finally {
                hideLoader();
            }
        };
        
        const handleLocalFileRestore = (file) => {
            showLoader();
            const reader = new FileReader();
            
            reader.onload = (event) => {
                try {
                    const parsedData = JSON.parse(event.target.result);
                    
                    if (typeof parsedData.bikes === 'undefined' || typeof parsedData.expenses === 'undefined') {
                        throw new Error('Invalid backup file.');
                    }
                    
                    state.data = parsedData;
                    runDataMigration(); // Ensure data structure
                    saveData(); // Save this new data to local storage
                    render();   
                    
                    showToast('Data restored successfully.');
                } catch (error) {
                    console.error('Restore failed:', error);
                    showToast(`Restore failed: ${error.message}`, true);
                } finally {
                    hideLoader();
                    restoreFileInput.value = null; // Reset file input
                }
            };
            
            reader.onerror = () => {
                showToast('Failed to read file.', true);
                hideLoader();
                restoreFileInput.value = null;
            };
            
            reader.readAsText(file);
        };

        const csvEscape = (value) => {
            if (value === null || value === undefined) return '';
            const str = String(value).replace(/"/g, '""');
            return /[",\n]/.test(str) ? `"${str}"` : str;
        };

        const exportCreditAsCSV = (records, totals) => {
            const lines = [];
            lines.push(`Generated At,${csvEscape(new Date().toISOString())}`);
            lines.push(`Total Credit Given,${csvEscape((totals.totalCredit || 0).toFixed(2))}`);
            lines.push(`Collected,${csvEscape((totals.collected || 0).toFixed(2))}`);
            lines.push(`Pending,${csvEscape((totals.pending || 0).toFixed(2))}`);
            lines.push(`Active Customers,${csvEscape(totals.activeCustomers || 0)}`);
            lines.push('');

            const headers = [
                'Customer Name',
                'Contact',
                'Bike Name',
                'Number Plate',
                'Sale Price',
                'Pending Amount',
                'Payment Mode',
                'Next Due',
                'Initial Payment',
                'Monthly EMI',
                'Installments Paid',
                'Installments Total'
            ];
            lines.push(headers.map(csvEscape).join(','));

            records.forEach(record => {
                const row = [
                    csvEscape(record.customerName),
                    csvEscape(record.contact),
                    csvEscape(record.bikeName),
                    csvEscape(record.bikeNumberPlate),
                    csvEscape((record.salePrice || 0).toFixed(2)),
                    csvEscape((record.pendingAmount || 0).toFixed(2)),
                    csvEscape(record.paymentMode?.toUpperCase() || ''),
                    csvEscape(record.nextDueText),
                    csvEscape((record.initialPayment || 0).toFixed(2)),
                    csvEscape((record.monthlyAmount || 0).toFixed(2)),
                    csvEscape(record.installmentsPaid || 0),
                    csvEscape(record.totalInstallments || 0)
                ];
                lines.push(row.join(','));
            });

            const blob = new Blob([lines.join('\n')], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `bike-credit-export-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            showToast('Credit data exported as CSV.');
        };

        const exportCreditAsPDF = (records, totals) => {
            const { jsPDF } = window.jspdf || {};
            if (!jsPDF) {
                showToast('PDF export unavailable. Please try CSV instead.', true);
                return;
            }

            const doc = new jsPDF({ unit: 'pt', format: 'a4' });
            const margin = 48;
            const pageHeight = doc.internal.pageSize.getHeight();

            const addHeader = () => {
                doc.setFontSize(16);
                doc.text('Credit Portfolio Export', margin, margin);
                doc.setFontSize(10);
                doc.text(`Generated: ${new Date().toLocaleString()}`, margin, margin + 18);
                doc.text(`Total Credit: ${formatCurrency(totals.totalCredit || 0)}`, margin, margin + 32);
                doc.text(`Collected: ${formatCurrency(totals.collected || 0)}  Pending: ${formatCurrency(totals.pending || 0)}`, margin, margin + 46);
                doc.text(`Active Customers: ${totals.activeCustomers || 0}`, margin, margin + 60);
            };

            const ensureSpace = (y, extra = 0) => {
                if (y + extra > pageHeight - margin) {
                    doc.addPage();
                    addHeader();
                    return margin + 80;
                }
                return y;
            };

            addHeader();
            let y = margin + 90;

            records.forEach((record, index) => {
                y = ensureSpace(y, 80);
                doc.setFontSize(12);
                doc.text(`${index + 1}. ${record.customerName}`, margin, y);
                doc.setFontSize(10);
                y += 16;

                const details = [
                    `Bike: ${record.bikeName} (${record.bikeNumberPlate})`,
                    `Contact: ${record.contact}`,
                    `Sale Price: ${formatCurrency(record.salePrice)}  Pending: ${formatCurrency(record.pendingAmount)}`,
                    `Mode: ${record.paymentMode?.toUpperCase() || ''}  Next Due: ${record.nextDueText}`
                ];

                if (record.paymentMode === 'credit') {
                    details.push(`Initial Payment: ${formatCurrency(record.initialPayment)}`);
                } else if (record.paymentMode === 'emi') {
                    details.push(`EMI: ${formatCurrency(record.monthlyAmount)}  Installments: ${record.installmentsPaid}/${record.totalInstallments}`);
                }

                details.forEach(textLine => {
                    const lines = doc.splitTextToSize(textLine, doc.internal.pageSize.getWidth() - margin * 2);
                    lines.forEach(line => {
                        y = ensureSpace(y, 14);
                        doc.text(line, margin + 12, y);
                        y += 14;
                    });
                });

                const paymentHeader = 'Recent Payments:';
                y = ensureSpace(y, 14);
                doc.text(paymentHeader, margin + 12, y);
                y += 14;

                const payments = record.payments.slice(0, 3);
                if (!payments.length) {
                    y = ensureSpace(y, 14);
                    doc.text('None recorded.', margin + 24, y);
                    y += 14;
                } else {
                    payments.forEach(payment => {
                        const paymentLine = `${formatDate(payment.date)}  ${formatCurrency(payment.amount)}  ${payment.type}`;
                        y = ensureSpace(y, 14);
                        doc.text(paymentLine, margin + 24, y);
                        y += 14;
                    });
                }

                y += 10;
            });

            doc.save(`bike-credit-export-${new Date().toISOString().split('T')[0]}.pdf`);
            showToast('Credit data exported as PDF.');
        };

        const exportCreditData = async () => {
            const { records, totals } = summarizeCreditRecords();
            if (!records.length) {
                showToast('No credit or EMI records to export.', true);
                return;
            }

            const choice = await showExportChoice('Export Credit Data', 'Select your preferred export format.');
            if (!choice) {
                return;
            }

            if (choice === 'csv') {
                exportCreditAsCSV(records, totals);
            } else if (choice === 'pdf') {
                exportCreditAsPDF(records, totals);
            }
        };

        // --- Event Listeners ---
        
        const addEventListeners = () => {
            sensitiveToggle.addEventListener('click', () => {
                if (state.security.isUnlocked) {
                    lockSensitiveData();
                    showToast('Sensitive data locked.');
                } else {
                    requestPinUnlock('Enter your PIN to unlock sensitive data.').catch(() => {});
                }
            });

            pinSubmit.addEventListener('click', handlePinSubmission);
            pinCancel.addEventListener('click', () => {
                if (state.security.pinMode === 'setup') {
                    return;
                }
                closePinModal();
                rejectPinRequest('cancelled');
            });
            pinInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    handlePinSubmission();
                } else if (event.key === 'Escape') {
                    if (state.security.pinMode === 'setup') {
                        return;
                    }
                    closePinModal();
                    rejectPinRequest('cancelled');
                }
            });
            pinModal.addEventListener('click', (event) => {
                if ((event.target).classList?.contains('modal-overlay')) {
                    if (state.security.pinMode === 'setup') {
                        return;
                    }
                    closePinModal();
                    rejectPinRequest('cancelled');
                }
            });

            if (analyticsUnlockBtn) {
                analyticsUnlockBtn.addEventListener('click', () => {
                    requestPinUnlock('Unlock analytics with your PIN.').catch(() => {});
                });
            }

            // PAT Modal Save
            patSave.addEventListener('click', async () => {
                const token = patInput.value;
                if (!token) {
                    patError.textContent = 'Please enter a token.';
                    return;
                }
                
                showLoader();
                state.githubPAT = token;
                state.storageMode = 'gist';
                
                const gist = await findGist();
                
                if (gist) {
                    state.gistId = gist.id;
                    state.data = gist.content;
                    showToast('Data loaded successfully!');
                } else if (!patError.textContent) {
                    const newGist = await createGist();
                    if (newGist) {
                        state.gistId = newGist.id;
                        state.data = newGist.content;
                        showToast('New data store created!');
                    } else {
                        hideLoader();
                        return;
                    }
                } else {
                    hideLoader();
                    return;
                }
                
                sessionStorage.setItem('githubPAT', state.githubPAT);
                sessionStorage.setItem('gistId', state.gistId);
                
                runDataMigration();
                state.security.isUnlocked = false;
                lockSensitiveData();
                updateSensitiveToggle();

                const needsPinSetup = (state.data?.settings?.pin || '1111') === '1111';
                
                hideLoader();
                patModal.classList.add('hidden');
                appWrapper.classList.remove('hidden');
                
                renderPage('dashboard');

                if (needsPinSetup) {
                    await requirePinSetup('Set a new 46 digit PIN to secure your data.');
                }
            });
            
            // PAT Modal Skip
            patSkip.addEventListener('click', async () => {
                const needsPin = loadLocalData();
                if (needsPin) {
                    await requirePinSetup('Set a new 46 digit PIN to get started.');
                }
            });

            // Bottom Navigation
            navBar.addEventListener('click', (e) => {
                const navItem = e.target.closest('.nav-item');
                if (navItem) {
                    renderPage(navItem.dataset.page);
                }
            });
            
            // Global "Add" Button
            addButton.addEventListener('click', () => {
                const page = state.ui.currentPage;
                if (page === 'bikes') {
                    if (state.ui.currentBikeType === 'brand_new') {
                        openModal('addBrandNew');
                    } else {
                        openModal('addBike');
                    }
                }
                if (page === 'expenses') openModal('addExpense');
                if (page === 'pr') openModal('addPR');
            });
            
            // Modal Close/Save
            modalClose.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', closeModal);
            modalSave.addEventListener('click', handleModalSave);

            // Settings: Cash Adjustments
            cashAdjAdd.addEventListener('click', () => handleCashAdjustment('add'));
            cashAdjRemove.addEventListener('click', () => handleCashAdjustment('remove'));

            if (pinUpdateBtn) {
                pinUpdateBtn.addEventListener('click', () => {
                    const current = (pinCurrentInput?.value || '').trim();
                    const next = (pinNewInput?.value || '').trim();
                    const existing = state.data?.settings?.pin || '1111';

                    if (!current || !next) {
                        showToast('Please fill in both PIN fields.', true);
                        return;
                    }
                    if (current !== existing) {
                        showToast('Current PIN is incorrect.', true);
                        pinCurrentInput?.focus();
                        return;
                    }
                    if (next.length < 4 || next.length > 6 || /\D/.test(next)) {
                        showToast('PIN must be 4-6 digits.', true);
                        pinNewInput?.focus();
                        pinNewInput?.select();
                        return;
                    }
                    state.data.settings.pin = next;
                    pinCurrentInput.value = '';
                    pinNewInput.value = '';
                    lockSensitiveData();
                    showToast('PIN updated. Sensitive data locked.');
                    saveData();
                });
            }
            
            // Settings: Logout
            settingLogout.addEventListener('click', () => {
                logout();
            });
            
            // Settings: Reset Data
            settingReset.addEventListener('click', async () => {
                const confirmed = await showConfirm(
                    'Reset All Data?',
                    'This will erase ALL bikes, expenses, contacts, payments, and cash transactions.'
                );
                if (confirmed) {
                    state.data = {
                        bikes: [], expenses: [], pr: [], cashEntries: [], payments: [],
                        settings: { baseInvestment: 0, pin: '1111' }
                    };
                    lockSensitiveData();
                    saveData();
                    showToast('All data has been reset.');
                }
            });

            // --- NEW: Backup & Restore Listeners ---
            
            settingBackup.addEventListener('click', () => {
                if (state.storageMode === 'gist') {
                    backupToGist();
                } else {
                    backupToLocalFile();
                }
            });
            
            settingRestore.addEventListener('click', () => {
                if (state.storageMode === 'gist') {
                    restoreFromGist();
                } else {
                    // Trigger local file input
                    restoreFileInput.click();
                }
            });

            if (creditExport) {
                creditExport.addEventListener('click', exportCreditData);
            }
            
            restoreFileInput.addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const confirmed = await showConfirm(
                    'Restore from File?',
                    'This will overwrite ALL current data in the app with the data from this file. This action cannot be undone.'
                );
                
                if (confirmed) {
                    handleLocalFileRestore(file);
                } else {
                    e.target.value = null; // Reset file input if cancelled
                }
            });
            
            // --- Page-specific Listeners ---
            
            // Dashboard: Sort
            dashboardSort.addEventListener('change', (e) => {
                state.ui.currentDashboardSort = e.target.value;
                renderDashboard();
            });

            // Dashboard: Reminder Clicks
            dashboardReminders.addEventListener('click', (e) => {
                if (e.target.closest('[data-reminder-action]')) {
                    return;
                }

                const card = e.target.closest('[data-reminder-card]');
                if (!card) return;

                const bikeId = card.dataset.bikeId;
                const bike = state.data.bikes.find(b => b.id === bikeId);
                if (bike) {
                    openModal('logPayment', bike);
                }
            });

            // Bike Page: Filters
            bikeFilter.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    bikeFilter.querySelector('button.active').classList.remove('active');
                    e.target.classList.add('active');
                    state.ui.currentBikeFilter = e.target.dataset.filter;
                    renderBikesPage();
                }
            });
            bikeSearch.addEventListener('input', (e) => {
                state.ui.currentBikeSearch = e.target.value;
                renderBikesPage();
            });
            if (bikeTypeToggle) {
                bikeTypeToggle.addEventListener('click', (e) => {
                    if (e.target.tagName === 'BUTTON') {
                        bikeTypeToggle.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                        e.target.classList.add('active');
                        state.ui.currentBikeType = e.target.dataset.type;
                        renderBikesPage();
                    }
                });
            }
            
            // Bike Page: Sort Dropdown
            bikeSortTrigger.addEventListener('click', () => {
                bikeSortMenu.classList.toggle('hidden');
            });

            bikeSortMenu.addEventListener('click', (e) => {
                const item = e.target.closest('.bike-sort-item');
                if (item) {
                    state.ui.currentBikeSort = item.dataset.sort;
                    bikeSortLabel.textContent = `Sort: ${item.textContent}`;
                    bikeSortMenu.classList.add('hidden');
                    renderBikesPage();
                }
            });
            bikeAdvancedToggle?.addEventListener('click', () => {
                state.ui.showBikeAdvanced = !state.ui.showBikeAdvanced;
                renderBikesPage();
            });
            bikeAdvancedReset?.addEventListener('click', () => {
                state.ui.bikeAdvancedFilters = {
                    profitMin: '',
                    profitMax: '',
                    dateFrom: '',
                    dateTo: '',
                    repairMin: '',
                    repairMax: ''
                };
                renderBikesPage();
            });

            const advancedInputConfigs = [
                { element: bikeFilterProfitMin, key: 'profitMin', event: 'input' },
                { element: bikeFilterProfitMax, key: 'profitMax', event: 'input' },
                { element: bikeFilterRepairMin, key: 'repairMin', event: 'input' },
                { element: bikeFilterRepairMax, key: 'repairMax', event: 'input' },
                { element: bikeFilterDateFrom, key: 'dateFrom', event: 'change' },
                { element: bikeFilterDateTo, key: 'dateTo', event: 'change' }
            ];

            advancedInputConfigs.forEach(({ element, key, event }) => {
                element?.addEventListener(event, (inputEvent) => {
                    const nextValue = inputEvent.target.value;
                    state.ui.bikeAdvancedFilters = {
                        ...state.ui.bikeAdvancedFilters,
                        [key]: nextValue
                    };
                    renderBikesPage();
                });
            });

            bikeBulkToggle?.addEventListener('click', () => {
                state.ui.bikeBulkMode = !state.ui.bikeBulkMode;
                if (!state.ui.bikeBulkMode) {
                    state.ui.bikeBulkSelection = [];
                }
                renderBikesPage();
            });
            
            // Bike Page: List Clicks
            bikeList.addEventListener('click', (e) => {
                const button = e.target.closest('[data-action]');
                if (!button) return;

                const bikeWrapper = button.closest('[data-bike-id]');
                const brandWrapper = button.closest('[data-brand-id]');
                const action = button.dataset.action;

                if (brandWrapper) {
                    const deliveryId = brandWrapper.dataset.brandId;
                    if (action === 'edit-brand-new') {
                        const delivery = state.data.brandNewDeliveries.find(entry => entry.id === deliveryId);
                        if (delivery) {
                            openModal('editBrandNew', delivery);
                        }
                    } else if (action === 'delete-brand-new') {
                        handleDeleteBrandNew(deliveryId);
                    } else if (action === 'toggle-commission') {
                        const refWrapper = button.closest('[data-ref-id]');
                        if (refWrapper) {
                            toggleBrandNewCommissionStatus(deliveryId, refWrapper.dataset.refId);
                        }
                    }
                    return;
                }

                if (!bikeWrapper) return;

                const bikeId = bikeWrapper.dataset.bikeId;
                const bike = state.data.bikes.find(b => b.id === bikeId);
                if (!bike) return;

                if (action === 'edit-bike') {
                    openModal('editBike', bike);
                } else if (action === 'mark-sold') {
                    openModal('markSold', bike);
                } else if (action === 'log-payment') {
                    openModal('logPayment', bike);
                }
            });

            bikeList.addEventListener('change', (e) => {
                const checkbox = e.target.closest('.bike-clearance-checkbox');
                if (!checkbox) return;
                const bikeId = checkbox.dataset.bikeId;
                if (!bikeId) return;
                const selection = new Set(state.ui.bikeBulkSelection || []);
                if (checkbox.checked) {
                    selection.add(bikeId);
                } else {
                    selection.delete(bikeId);
                }
                state.ui.bikeBulkSelection = Array.from(selection);
                updateBikeBulkFooter();
            });

            bikeClearanceCancel?.addEventListener('click', () => {
                state.ui.bikeBulkMode = false;
                state.ui.bikeBulkSelection = [];
                renderBikesPage();
            });

            const applyClearanceSelection = (enable) => {
                const selection = new Set(state.ui.bikeBulkSelection || []);
                if (!selection.size) {
                    showToast('Select at least one bike first.', true);
                    return;
                }

                let updated = 0;
                state.data.bikes.forEach((bike) => {
                    if (!selection.has(bike.id) || bike.sold) {
                        return;
                    }
                    if (!!bike.clearanceSale !== enable) {
                        bike.clearanceSale = enable;
                        updated += 1;
                    }
                });

                if (updated > 0) {
                    showToast(enable ? 'Marked selected bikes for clearance.' : 'Removed clearance flag.');
                    saveData();
                } else {
                    showToast('No changes applied.', true);
                }

                state.ui.bikeBulkSelection = [];
                if (!enable) {
                    updateBikeBulkFooter();
                }
                renderBikesPage();
            };

            bikeClearanceMark?.addEventListener('click', () => applyClearanceSelection(true));
            bikeClearanceRemove?.addEventListener('click', () => applyClearanceSelection(false));

            if (creditList) {
                creditList.addEventListener('click', (e) => {
                    const button = e.target.closest('[data-action="log-payment"]');
                    if (!button) return;
                    const wrapper = button.closest('[data-bike-id]');
                    if (!wrapper) return;
                    const bike = state.data.bikes.find(b => b.id === wrapper.dataset.bikeId);
                    if (bike) {
                        openModal('logPayment', bike);
                    }
                });

                creditList.addEventListener('change', (e) => {
                    const checkbox = e.target.closest('.credit-bulk-checkbox');
                    if (!checkbox) return;
                    const bikeId = checkbox.dataset.bulkId;
                    if (!bikeId) return;
                    const selection = new Set(state.ui.creditBulkSelection || []);
                    if (checkbox.checked) {
                        selection.add(bikeId);
                    } else {
                        selection.delete(bikeId);
                    }
                    state.ui.creditBulkSelection = Array.from(selection);
                    render();
                });
            }

            creditBulkToggle?.addEventListener('click', () => {
                state.ui.creditBulkMode = !state.ui.creditBulkMode;
                if (!state.ui.creditBulkMode) {
                    state.ui.creditBulkSelection = [];
                    state.ui.creditBulkDrafts = {};
                }
                render();
            });

            creditBulkCancel?.addEventListener('click', () => {
                state.ui.creditBulkMode = false;
                state.ui.creditBulkSelection = [];
                state.ui.creditBulkDrafts = {};
                render();
            });

            creditBulkConfirm?.addEventListener('click', () => {
                const selectedIds = state.ui.creditBulkSelection || [];
                if (!selectedIds.length) {
                    showToast('Select at least one customer to proceed.', true);
                    return;
                }
                const { records } = summarizeCreditRecords();
                const selectedRecords = records.filter(record => selectedIds.includes(record.bikeId));
                if (!selectedRecords.length) {
                    showToast('Selected customers are no longer pending.', true);
                    state.ui.creditBulkSelection = [];
                    render();
                    return;
                }
                openModal('bulkPayments', selectedRecords);
            });
            
            // Expense Page: List Clicks
            expenseList.addEventListener('click', (e) => {
                const item = e.target.closest('[data-expense-id]');
                if (!item) return;
                
                const expense = state.data.expenses.find(ex => ex.id === item.dataset.expenseId);
                if (expense) {
                    openModal('editExpense', expense);
                }
            });
            
            // PR Page: Filters
            prFilter.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    prFilter.querySelector('button.active').classList.remove('active');
                    e.target.classList.add('active');
                    state.ui.currentPRFilter = e.target.dataset.filter;
                    renderPRPage();
                }
            });
            prSearch.addEventListener('input', (e) => {
                state.ui.currentPRSearch = e.target.value;
                renderPRPage();
            });
            
            // PR Page: List Clicks
            prList.addEventListener('click', (e) => {
                const actionButton = e.target.closest('[data-action]');
                if (actionButton) {
                    e.preventDefault();
                    const action = actionButton.dataset.action;
                    switch (action) {
                        case 'pr-call': {
                            const contact = actionButton.dataset.contact;
                            if (contact) {
                                window.open(`tel:${contact}`, '_self');
                            } else {
                                showToast('No contact number available.', true);
                            }
                            break;
                        }
                        case 'pr-whatsapp': {
                            const contact = actionButton.dataset.contact;
                            if (contact) {
                                window.open(`https://wa.me/${contact}`, '_blank');
                            } else {
                                showToast('No contact number available.', true);
                            }
                            break;
                        }
                        case 'pr-copy': {
                            const contact = actionButton.dataset.contact;
                            if (contact) {
                                copyTextToClipboard(contact);
                            }
                            break;
                        }
                        case 'pr-go-bike': {
                            const bikeName = actionButton.dataset.bikeName;
                            navigateToBikeRecord(bikeName);
                            break;
                        }
                        case 'pr-filter-supplier': {
                            const supplierName = actionButton.dataset.prName;
                            filterBikesBySupplier(supplierName);
                            break;
                        }
                        case 'pr-filter-owner': {
                            const ownerName = actionButton.dataset.prName;
                            filterBikesByOwner(ownerName);
                            break;
                        }
                        case 'pr-log-payment': {
                            const buyerName = actionButton.dataset.prName;
                            logPaymentForBuyer(buyerName);
                            break;
                        }
                        default:
                            break;
                    }
                    return;
                }

                const item = e.target.closest('[data-pr-id]');
                if (!item) return;
                
                const pr = state.data.pr.find(p => p.id === item.dataset.prId);
                if (pr) {
                    openModal('editPR', pr);
                }
            });

            // Global: Close sort dropdown on click outside
            document.addEventListener('click', (e) => {
                if (!bikeSortTrigger.contains(e.target) && !bikeSortMenu.contains(e.target)) {
                    bikeSortMenu.classList.add('hidden');
                }
            });
        };
        
        const logout = () => {
            sessionStorage.clear();
            localStorage.removeItem(LOCAL_STORAGE_KEY);
            location.reload();
        };

        // --- App Initialization ---
        
        const loadLocalData = () => {
            state.storageMode = 'local';
            let localData = null;
            try {
                const raw = localStorage.getItem(LOCAL_STORAGE_KEY);
                if (raw) {
                    localData = JSON.parse(raw);
                }
            } catch (error) {
                console.error('Failed to read local data. Resetting to defaults.', error);
            }

            if (!localData) {
                localData = JSON.parse(JSON.stringify(DEFAULT_DATA));
            }

            state.data = localData;
            runDataMigration();
            state.security.isUnlocked = false;
            updateSensitiveToggle();
            patModal?.classList.add('hidden');
            hideLoader();
            appWrapper.classList.remove('hidden');
            renderPage('dashboard');
            return (state.data?.settings?.pin || '1111') === '1111';
        };

        const init = async () => {
            setupPWAInstall();
            addEventListeners();
            const pat = sessionStorage.getItem('githubPAT');
            const gistId = sessionStorage.getItem('gistId');
            
            if (pat && gistId) {
                state.githubPAT = pat;
                state.gistId = gistId;
                state.storageMode = 'gist';
                
                showLoader();
                try {
                    const res = await fetch(`${GIST_API_URL}/${gistId}`, { headers: getHeaders() });
                    if (!res.ok) {
                        if (res.status === 401 || res.status === 404) {
                            throw new Error('Invalid token or Gist not found. Please log in again.');
                        }
                        throw new Error(`Failed to load data (Status ${res.status})`);
                    }
                    const gist = await res.json();
                    state.data = JSON.parse(gist.files[GIST_FILENAME].content);
                    runDataMigration();
                    state.security.isUnlocked = false;
                    updateSensitiveToggle();
                    appWrapper.classList.remove('hidden');
                    renderPage('dashboard');
                    const needsPinSetup = (state.data?.settings?.pin || '1111') === '1111';
                    if (needsPinSetup) {
                        await requirePinSetup('Set a new 46 digit PIN to secure your data.');
                    }
                } catch (err) {
                    console.error(err);
                    sessionStorage.clear();
                    patModal?.classList.remove('hidden');
                    patError.textContent = err.message;
                } finally {
                    hideLoader();
                }
                return;
            }
            
            const needsPinSetup = loadLocalData();
            if (needsPinSetup) {
                await requirePinSetup('Set a new 46 digit PIN to get started.');
            }
        };

        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>
